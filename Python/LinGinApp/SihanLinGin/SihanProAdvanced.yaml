# Dimensions that are used across many fact tables are not required to be added 
# as this will complicate the dependency graph ie: DimPerson, DimDate, DimProvider

pipelines:
  - name: TPP SystmOne
    edges:
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRPrimaryCareMedication.csv
        via: systmone
        to: staging.tpp.SRPrimaryCareMedication
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SREvent.csv
        via: systmone
        to: staging.tpp.SREvent
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRStaffMember.csv
        via: systmone
        to: staging.tpp.SRStaffMember
      - from: staging.tpp.SRPrimaryCareMedication
        to: staging.tpp.usp_LoadSRPrimaryCareMedicationToOds
      - from: staging.tpp.usp_LoadSRPrimaryCareMedicationToOds
        to: ods.clinical.PrimaryCareMedication
      - from: staging.tpp.SREvent
        to: staging.tpp.usp_LoadSREventToOds
      - from: staging.tpp.usp_LoadSREventToOds
        to: ods.clinical.Event
      - from: staging.tpp.SRStaffMember
        to: staging.tpp.usp_LoadSRStaffMemberToOds
      - from: staging.tpp.usp_LoadSRStaffMemberToOds
        to: ods.clinical.StaffMember
      - from: ods.clinical.Event
        to: staging.tpp.usp_LoadPrimaryCareMedicationToOds
      - from: ods.clinical.StaffMember
        to: staging.tpp.usp_LoadPrimaryCareMedicationToOds
      - from: staging.tpp.usp_LoadPrimaryCareMedicationToOds
        to: ods.clinical.PrimaryCareMedication
      - from: staging.tpp.SRPrimaryCareMedication
        to: staging.tpp.usp_LoadMedicationMultiLexProductToOds
      - from: staging.tpp.usp_LoadMedicationMultiLexProductToOds
        to: ods.clinical.MedicationMultiLexProduct
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRCtv3.csv
        via: systmone
        to: staging.tpp.SRCtv3
      - from: staging.tpp.SRCtv3
        to: staging.tpp.usp_LoadReadCodeToOds
      - from: staging.tpp.usp_LoadReadCodeToOds
        to: ods.clinical.ReadCode
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRCode.csv
        via: systmone
        to: staging.tpp.SRCode
      - from: staging.tpp.SRCode
        to: staging.tpp.usp_LoadPersonReadCodeToOds
      - from: staging.tpp.usp_LoadPersonReadCodeToOds
        to: ods.clinical.PersonReadCode
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRImmunisation.csv
        via: systmone
        to: staging.tpp.SRImmunisation
      - from: staging.tpp.SRImmunisation
        to: staging.tpp.usp_LoadImmunisationToOds
      - from: staging.tpp.usp_LoadImmunisationToOds
        to: ods.clinical.Immunisation
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRPatientRegistration.csv
        via: systmone
        to: staging.tpp.SRPatientRegistration
      - from: staging.tpp.SRPatientRegistration
        to: staging.tpp.usp_LoadPersonOrganisationRegistrationToOds
      - from: staging.tpp.usp_LoadPersonOrganisationRegistrationToOds
        to: ods.clinical.PersonOrganisationRegistration
      - from: Default Data
        via: ods
        to: ods.ref.MetricClusterIdMapping
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRCtv3Hierarchy.csv
        via: systmone
        to: staging.tpp.SRCtv3Hierarchy
      - from: staging.tpp.SRCtv3Hierarchy
        to: staging.tpp.usp_LoadReadCodeHierarchyToOds
      - from: staging.tpp.usp_LoadReadCodeHierarchyToOds
        to: ods.clinical.ReadCodeHierarchy
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRMedicationReadCodeDetails.csv
        via: systmone
        to: staging.tpp.SRMedicationReadCodeDetails
      - from: staging.tpp.SRMedicationReadCodeDetails
        to: staging.tpp.usp_LoadMedicationReadCodeToOds
      - from: staging.tpp.usp_LoadMedicationReadCodeToOds
        to: ods.clinical.MedicationReadCode
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRAppointment.csv
        via: systmone
        to: staging.tpp.SRAppointment
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SROrganisation.csv
        via: systmone
        to: staging.tpp.SROrganisation
      - from: staging.tpp.SROrganisation
        to: staging.tpp.usp_LoadPartnerToOds
      - from: ods.clinical.PersonOrganisationRegistration
        to: staging.tpp.usp_LoadPartnerToOds
      - from: staging.tpp.usp_LoadPartnerToOds
        to: ods.Partner
      - from: staging.tpp.SRAppointment
        to: staging.tpp.usp_LoadAppointmentToOds
      - from: staging.tpp.SRMapping
        to: staging.tpp.usp_LoadAppointmentToOds
      - from: ods.clinical.StaffMemberProfile
        to: staging.tpp.usp_LoadAppointmentToOds
      - from: ods.clinical.Rota
        to: staging.tpp.usp_LoadAppointmentToOds
      - from: staging.tpp.usp_LoadAppointmentToOds
        to: ods.clinical.Appointment
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRMapping.csv
        via: systmone
        to: staging.tpp.SRMapping
      - from: staging.tpp.SRMapping
        to: staging.tpp.usp_LoadMappingToOds
      - from: staging.tpp.usp_LoadMappingToOds
        to: ods.ref.TppMapping
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRRota.csv
        via: systmone
        to: staging.tpp.SRRota
      - from: staging.tpp.SRRota
        to: staging.tpp.usp_LoadRotaToOds
      - from: staging.tpp.usp_LoadRotaToOds
        to: ods.clinical.Rota
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRDrugSensitivity.csv
        via: systmone
        to: staging.tpp.SRDrugSensitivity
      - from: staging.tpp.SRDrugSensitivity
        to: staging.tpp.usp_LoadDrugSensitivityToOds
      - from: staging.tpp.usp_LoadDrugSensitivityToOds
        to: ods.clinical.DrugSensitivity
      - from: blob.dhc/Lookup/SystmOne/CTV3_QOF Cluster_v38.csv
        via: mov.ReferencePreSystmOne
        to: staging.ref.ClusterReadCode
      - from: staging.ref.ClusterReadCode
        to: staging.ref.usp_LoadClusterReadCodeToOds
      - from: ods.clinical.ReadCode
        to: ods.dw.usp_LoadClusterReadCodeToOds
      - from: staging.ref.usp_LoadClusterReadCodeToOds
        to: ods.clinical.ClusterReadCode
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRStaffMemberProfile.csv
        via: systmone
        to: staging.tpp.SRStaffMemberProfile
      - from: staging.tpp.SRStaffMemberProfile
        to: staging.tpp.usp_LoadStaffMemberProfileToOds
      - from: ods.clinical.StaffMember
        to: staging.tpp.usp_LoadStaffMemberProfileToOds
      - from: staging.tpp.usp_LoadStaffMemberProfileToOds
        to: ods.clinical.StaffMemberProfile
      - from: Default Data
        via: ods
        to: ods.ref.ClusterReadCode
      - from: Default Data
        via: ods
        to: ods.ref.MetricImmunisationMapping
      - from: Default Data
        via: ods
        to: ods.clinical.Condition
      - from: blob.dhc/Primary Care/SystmOne/Timestamp/SRImmunisationContent.csv
        via: systmone
        to: staging.tpp.SRImmunisationContent
      - from: staging.tpp.SRImmunisationContent
        to: staging.tpp.usp_LoadImmunisationContentToOds
      - from: staging.tpp.usp_LoadImmunisationContentToOds
        to: ods.clinical.ImmunisationContent
      - from: ods.clinical.StaffMember
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonPerformanceHistoryData
      - from: ods.dw.usp_GetFactPersonPerformanceHistoryData
        to: ods.dw.DimStaffMember
      - from: ods.dw.DimStaffMember
        to: ods.dw.usp_GetDimDimStaffMemberData
      - from: ods.dw.usp_GetDimDimStaffMemberData
        to: dw.staging.DimStaffMember
      - from: dw.staging.DimStaffMember
        to: dw.staging.usp_LoadDimStaffMember
      - from: dw.staging.usp_LoadDimStaffMember
        to: dw.dbo.DimStaffMember
      - from: ods.ref.MetricMeasurementCodeMapping
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPerformanceMeasurementData
      - from: ods.clinical.ReadCode
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPerformanceMeasurementData
      - from: ods.clinical.ReadCodeHierarchy
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPerformanceMeasurementData
      - from: ods.ref.MetricClusterIdMapping
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPerformanceMeasurementData
      - from: ods.clinical.ClusterReadCode
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPerformanceMeasurementData
      - from: ods.ref.ReadCodeSnomedMapping
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPerformanceMeasurementData
      - from: ods.dw.usp_GetDimPerformanceMeasurementData
        to: dw.staging.DimPerformanceMeasurement
      - from: dw.staging.DimPerformanceMeasurement
        to: dw.staging.usp_LoadDimPerformanceMeasurement
      - from: dw.staging.usp_LoadDimPerformanceMeasurement
        to: dw.dbo.DimPerformanceMeasurement
      - from: ods.ref.MetricMeasurementCodeMapping
        via: mov.MeasurementCodeMapping
        to: ods.ref.usp_LoadReadCodeSnomedMapping
      - from: ods.clinical.ReadCode
        via: mov.MeasurementCodeMapping
        to: ods.ref.usp_LoadReadCodeSnomedMapping
      - from: ods.clinical.ReadCodeHierarchy
        via: mov.MeasurementCodeMapping
        to: ods.ref.usp_LoadReadCodeSnomedMapping
      - from: ods.clinical.ClusterReadCode
        via: mov.MeasurementCodeMapping
        to: ods.ref.usp_LoadReadCodeSnomedMapping
      - from: ods.clinical.PersonReadCode
        via: mov.MeasurementCodeMapping
        to: ods.ref.usp_LoadReadCodeSnomedMapping
      - from: ods.ref.usp_LoadReadCodeSnomedMapping
        to: ods.ref.ReadCodeSnomedMapping

  - name: MymHealth Load
    edges:
  # Load MymHealth data from API to Staging and ods
      - from: api.https://api.mymhealth.com/analytics/mycopd/find/sensitive/symptomscores?
        via: mym
        to: staging.mym.MyCopdSymptomScore
      - from: api.https://api.mymhealth.com/analytics/myasthma/find/sensitive/symptomscores?
        via: mym
        to: staging.mym.MyAsthmaSymptomScore
      - from: api.https://api.mymhealth.com/analytics/myasthma/find/sensitive/videos/type?type=INHALER&
        via: mym
        to: staging.mym.MyAsthmaInhalerVideo
      - from: api.https://api.mymhealth.com/analytics/myasthma/find/sensitive/videos/type?type=SMOKING_CESSATION&
        via: mym
        to: staging.mym.MyAsthmaSmokingCessationVideo
      - from: api.https://api.mymhealth.com/analytics/myasthma/find/sensitive/videos/type?type=MINDFULNESS&
        via: mym
        to: staging.mym.MyAsthmaMindfulnessVideo
      - from: api.https://api.mymhealth.com/analytics/myasthma/find/sensitive/videos/type?type=PULMONARY_REHAB&
        via: mym
        to: staging.mym.MyAsthmaPulmonaryRehabVideo
      - from: api.https://api.mymhealth.com/analytics/mycopd/find/sensitive/videos/type?type=INHALER&
        via: mym
        to: staging.mym.MyCopdInhalerVideo
      - from: api.https://api.mymhealth.com/analytics/mycopd/find/sensitive/videos/type?type=SMOKING_CESSATION&
        via: mym
        to: staging.mym.MyCopdSmokingCessationVideo
      - from: api.https://api.mymhealth.com/analytics/mycopd/myasthma/find/sensitive/videos/type?type=MINDFULNESS&
        via: mym
        to: staging.mym.MyCopdMindfulnessVideo
      - from: api.https://api.mymhealth.com/analytics/mycopd/myasthma/find/sensitive/videos/type?type=PULMONARY_REHAB&
        via: mym
        to: staging.mym.MyCopdPulmonaryRehabVideo
      - from: api.https://api.mymhealth.com/analytics/mydiabetes/find/sensitive/videos/type?type=INHALER&
        via: mym
        to: staging.mym.MyDiabetesInhalerVideo
      - from: api.https://api.mymhealth.com/analytics/mydiabetes/find/sensitive/videos/type?type=SMOKING_CESSATION&
        via: mym
        to: staging.mym.MyDiabetesSmokingCessationVideo
      - from: api.https://api.mymhealth.com/analytics/mycopd/mydiabetes/find/sensitive/videos/type?type=MINDFULNESS&
        via: mym
        to: staging.mym.MyDiabetesMindfulnessVideo
      - from: api.https://api.mymhealth.com/analytics/mycopd/mydiabetes/find/sensitive/videos/type?type=PULMONARY_REHAB&
        via: mym
        to: staging.mym.MyDiabetesPulmonaryRehabVideo
      - from: api.https://api.mymhealth.com/analytics/myheart/find/sensitive/videos/type?type=INHALER&
        via: mym
        to: staging.mym.MyHeartInhalerVideo
      - from: api.https://api.mymhealth.com/analytics/myheart/find/sensitive/videos/type?type=SMOKING_CESSATION&
        via: mym
        to: staging.mym.MyHeartSmokingCessationVideo
      - from: api.https://api.mymhealth.com/analytics/mycopd/myheart/find/sensitive/videos/type?type=MINDFULNESS&
        via: mym
        to: staging.mym.MyHeartMindfulnessVideo
      - from: api.https://api.mymhealth.com/analytics/mycopd/myheart/find/sensitive/videos/type?type=PULMONARY_REHAB&
        via: mym
        to: staging.mym.MyHeartPulmonaryRehabVideo
      - from: api.https://api.mymhealth.com/analytics/mycopd/find/sensitive/catscores?
        via: mym
        to: staging.mym.MyCopdCatScore
      - from: api.https://api.mymhealth.com/analytics/mycopd/find/sensitive/tileclicks?
        via: mym
        to: staging.mym.MyCopdTileClick
      - from: api.https://api.mymhealth.com/analytics/myasthma/find/sensitive/tileclicks?
        via: mym
        to: staging.mym.MyAsthmaTileClick
      - from: api.https://api.mymhealth.com/analytics/myheart/find/sensitive/tileclicks?
        via: mym
        to: staging.mym.MyHeartTileClick
      - from: api.https://api.mymhealth.com/analytics/mydiabetes/find/sensitive/tileclicks?
        via: mym
        to: staging.mym.MyDiabetesTileClick
      - from: api.https://api.mymhealth.com/analytics/mycopd/find/sensitive/smoking/data?
        via: mym
        to: staging.mym.MyCopdSmoking
      - from: api.https://api.mymhealth.com/analytics/myasthma/find/sensitive/smoking/data?
        via: mym
        to: staging.mym.MyAsthmaSmoking
      - from: api.https://api.mymhealth.com/analytics/myheart/find/sensitive/smoking/data?
        via: mym
        to: staging.mym.MyHeartSmoking
      - from: api.https://api.mymhealth.com/analytics/mydiabetes/find/sensitive/smoking/data?
        via: mym
        to: staging.mym.MyDiabetesSmoking
      - from: api.https://api.mymhealth.com/analytics/mycopd/find/sensitive/activated?
        via: mym
        to: staging.mym.MyCopdActivated
      - from: api.https://api.mymhealth.com/analytics/myasthma/find/sensitive/activated?
        via: mym
        to: staging.mym.MyAsthmaActivated
      - from: api.https://api.mymhealth.com/analytics/myheart/find/sensitive/activated?
        via: mym
        to: staging.mym.MyHeartActivated
      - from: api.https://api.mymhealth.com/analytics/mydiabetes/find/sensitive/activated?
        via: mym
        to: staging.mym.MyDiabetesActivated
      - from: api.https://api.mymhealth.com/analytics/mycopd/find/sensitive/registered?
        via: mym
        to: staging.mym.MyCopdRegistered
      - from: api.https://api.mymhealth.com/analytics/myasthma/find/sensitive/registered?
        via: mym
        to: staging.mym.MyAsthmaRegistered
      - from: api.https://api.mymhealth.com/analytics/myheart/find/sensitive/registered?
        via: mym
        to: staging.mym.MyHeartRegistered
      - from: api.https://api.mymhealth.com/analytics/mydiabetes/find/sensitive/registered?
        via: mym
        to: staging.mym.MyDiabetesRegistered
      - from: api.https://api.mymhealth.com/analytics/mycopd/find/sensitive/vaccinations/flu?
        via: mym
        to: staging.mym.MyCopdFluVaccination
      - from: api.https://api.mymhealth.com/analytics/myasthma/find/sensitive/vaccinations/flu?
        via: mym
        to: staging.mym.MyAsthmaFluVaccination
      - from: api.https://api.mymhealth.com/analytics/myheart/find/sensitive/vaccinations/flu?
        via: mym
        to: staging.mym.MyHeartFluVaccination
      - from: api.https://api.mymhealth.com/analytics/mydiabetes/find/sensitive/vaccinations/flu?
        via: mym
        to: staging.mym.MyDiabetesFluVaccination
      - from: api.https://api.mymhealth.com/analytics/mycopd/find/exacerbations?
        via: mym
        to: staging.mym.MyCopdExacerbation
      - from: api.https://api.mymhealth.com/analytics/myasthma/find/asthmacontroltests?
        via: mym
        to: staging.mym.MyAsthmaControlTest
      - from: Default Data
        via: ods
        to: ods.mym.App
      - from: staging.mym.MyCopdSymptomScore
        via: mov.MymHealth
        to: staging.mym.usp_LoadMyCopdSymptomScoreToOds
      - from: staging.mym.MyAsthmaSymptomScore
        via: mov.MymHealth
        to: staging.mym.usp_LoadMyAsthmaSymptomScoreToOds
      - from: staging.mym.usp_LoadMyCopdSymptomScoreToOds
        to: ods.mym.SymptomScore
      - from: staging.mym.usp_LoadMyAsthmaSymptomScoreToOds
        to: ods.mym.SymptomScore
      - from: staging.mym.MyAsthmaInhalerVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadAsthmaVideoToOds
      - from: staging.mym.MyAsthmaSmokingCessationVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadAsthmaVideoToOds
      - from: staging.mym.MyAsthmaMindfulnessVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadAsthmaVideoToOds
      - from: staging.mym.MyAsthmaPulmonaryRehabVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadAsthmaVideoToOds
      - from: staging.mym.usp_LoadAsthmaVideoToOds
        to: ods.mym.WatchedVideo
      - from: staging.mym.MyCopdInhalerVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdVideoToOds
      - from: staging.mym.MyCopdSmokingCessationVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdVideoToOds
      - from: staging.mym.MyCopdMindfulnessVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdVideoToOds
      - from: staging.mym.MyCopdPulmonaryRehabVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdVideoToOds
      - from: staging.mym.usp_LoadCopdVideoToOds
        to: ods.mym.WatchedVideo
      - from: staging.mym.MyDiabetesInhalerVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadDiabetesVideoToOds
      - from: staging.mym.MyDiabetesSmokingCessationVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadDiabetesVideoToOds
      - from: staging.mym.MyDiabetesMindfulnessVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadDiabetesVideoToOds
      - from: staging.mym.MyDiabetesPulmonaryRehabVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadDiabetesVideoToOds
      - from: staging.mym.usp_LoadDiabetesVideoToOds
        to: ods.mym.WatchedVideo
      - from: staging.mym.MyHeartInhalerVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadHeartVideoToOds
      - from: staging.mym.MyHeartSmokingCessationVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadHeartVideoToOds
      - from: staging.mym.MyHeartMindfulnessVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadHeartVideoToOds
      - from: staging.mym.MyHeartPulmonaryRehabVideo
        via: mov.MymHealth
        to: staging.mym.usp_LoadHeartVideoToOds
      - from: staging.mym.usp_LoadHeartVideoToOds
        to: ods.mym.WatchedVideo
      - from: staging.mym.MyCopdCatScore
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdCatScoreToOds
      - from: staging.mym.usp_LoadCopdCatScoreToOds
        to: ods.mym.CopdAssessmentTestScore
      - from: staging.mym.MyCopdTileClick
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdTileClickToOds
      - from: staging.mym.MyAsthmaTileClick
        via: mov.MymHealth
        to: staging.mym.usp_LoadAsthmaTileClickToOds
      - from: staging.mym.MyHeartTileClick
        via: mov.MymHealth
        to: staging.mym.usp_LoadHeartTileClickToOds
      - from: staging.mym.MyDiabetesTileClick
        via: mov.MymHealth
        to: staging.mym.usp_LoadDiabetesTileClickToOds
      - from: staging.mym.usp_LoadCopdTileClickToOds
        to: ods.mym.TileClick
      - from: staging.mym.usp_LoadAsthmaTileClickToOds
        to: ods.mym.TileClick
      - from: staging.mym.usp_LoadHeartTileClickToOds
        to: ods.mym.TileClick
      - from: staging.mym.usp_LoadDiabetesTileClickToOds
        to: ods.mym.TileClick
      - from: staging.mym.MyCopdSmoking
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdSmokingToOds
      - from: staging.mym.MyAsthmaSmoking
        via: mov.MymHealth
        to: staging.mym.usp_LoadAsthmaSmokingToOds
      - from: staging.mym.MyHeartSmoking
        via: mov.MymHealth
        to: staging.mym.usp_LoadHeartSmokingToOds
      - from: staging.mym.MyDiabetesSmoking
        via: mov.MymHealth
        to: staging.mym.usp_LoadDiabetesSmokingToOds
      - from: staging.mym.usp_LoadCopdSmokingToOds
        to: ods.mym.SmokingStatus
      - from: staging.mym.usp_LoadAsthmaSmokingToOds
        to: ods.mym.SmokingStatus
      - from: staging.mym.usp_LoadHeartSmokingToOds
        to: ods.mym.SmokingStatus
      - from: staging.mym.usp_LoadDiabetesSmokingToOds
        to: ods.mym.SmokingStatus
      - from: staging.mym.MyCopdActivated
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdActivatedToOds
      - from: staging.mym.MyAsthmaActivated
        via: mov.MymHealth
        to: staging.mym.usp_LoadAsthmaActivatedToOds
      - from: staging.mym.MyHeartActivated
        via: mov.MymHealth
        to: staging.mym.usp_LoadHeartActivatedToOds
      - from: staging.mym.MyDiabetesActivated
        via: mov.MymHealth
        to: staging.mym.usp_LoadDiabetesActivatedToOds
      - from: staging.mym.usp_LoadCopdActivatedToOds
        to: ods.mym.AppActivation
      - from: staging.mym.usp_LoadAsthmaActivatedToOds
        to: ods.mym.AppActivation 
      - from: staging.mym.usp_LoadHeartActivatedToOds
        to: ods.mym.AppActivation
      - from: staging.mym.usp_LoadDiabetesActivatedToOds
        to: ods.mym.AppActivation
      - from: staging.mym.MyCopdRegistered
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdRegisteredToOds
      - from: staging.mym.MyAsthmaRegistered
        via: mov.MymHealth
        to: staging.mym.usp_LoadAsthmaRegisteredToOds
      - from: staging.mym.MyHeartRegistered
        via: mov.MymHealth
        to: staging.mym.usp_LoadHeartRegisteredToOds
      - from: staging.mym.MyDiabetesRegistered
        via: mov.MymHealth
        to: staging.mym.usp_LoadDiabetesRegisteredToOds
      - from: ods.mym.App
        via: mov.MymHealth
        to: staging.mym.usp_LoadDiabetesRegisteredToOds
      - from: ods.mym.App
        via: mov.MymHealth
        to: staging.mym.usp_LoadHeartRegisteredToOds
      - from: ods.mym.App
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdRegisteredToOds
      - from: ods.mym.App
        via: mov.MymHealth
        to: staging.mym.usp_LoadAsthmaRegisteredToOds
      - from: staging.mym.usp_LoadCopdRegisteredToOds
        to: ods.mym.AppRegistration
      - from: staging.mym.usp_LoadAsthmaRegisteredToOds
        to: ods.mym.AppRegistration
      - from: staging.mym.usp_LoadHeartRegisteredToOds
        to: ods.mym.AppRegistration
      - from: staging.mym.usp_LoadDiabetesRegisteredToOds
        to: ods.mym.AppRegistration
      - from: staging.mym.MyCopdFluVaccination
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdFluVaccinationToOds
      - from: staging.mym.MyAsthmaFluVaccination
        via: mov.MymHealth
        to: staging.mym.usp_LoadAsthmaFluVaccinationToOds
      - from: staging.mym.MyHeartFluVaccination
        via: mov.MymHealth
        to: staging.mym.usp_LoadHeartFluVaccinationToOds
      - from: staging.mym.MyDiabetesFluVaccination
        via: mov.MymHealth
        to: staging.mym.usp_LoadDiabetesFluVaccinationToOds
      - from: ods.mym.App
        via: mov.MymHealth
        to: staging.mym.usp_LoadDiabetesFluVaccinationToOds
      - from: ods.mym.App
        via: mov.MymHealth
        to: staging.mym.usp_LoadHeartFluVaccinationToOds
      - from: ods.mym.App
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdFluVaccinationToOds
      - from: ods.mym.App
        via: mov.MymHealth
        to: staging.mym.usp_LoadAsthmaFluVaccinationToOds
      - from: staging.mym.usp_LoadCopdFluVaccinationToOds
        to: ods.mym.FluVaccination
      - from: staging.mym.usp_LoadAsthmaFluVaccinationToOds
        to: ods.mym.FluVaccination
      - from: staging.mym.usp_LoadHeartFluVaccinationToOds
        to: ods.mym.FluVaccination
      - from: staging.mym.usp_LoadDiabetesFluVaccinationToOds
        to: ods.mym.FluVaccination
      - from: staging.mym.MyCopdExacerbation
        via: mov.MymHealth
        to: staging.mym.usp_LoadCopdExacerbationToOds
      - from: staging.mym.usp_LoadCopdExacerbationToOds
        to: ods.mym.CopdExacerbation
      - from: staging.mym.MyAsthmaControlTest
        via: mov.MymHealth
        to: staging.mym.usp_LoadAsthmaControlTestToOds
      - from: staging.mym.usp_LoadAsthmaControlTestToOds
        to: ods.mym.AsthmaControlTestScore

  - name: ReferenceSus2 Load
    edges:
    # Source: ReferenceSus2 files from Blob to Staging and ods
      - from: blob.ccg/ref/overseasvisitorscodes.csv
        via: mov.ReferenceSus2
        to: staging.ref.OverseasVisitors
      - from: staging.ref.OverseasVisitors
        to: ods.ref.usp_LoadOverseasVisitorsToOds
      - from: ods.ref.usp_LoadOverseasVisitorsToOds
        to: ods.OverseasVisitors
      - from: blob.ccg/ref/general_medical_practitioner.csv
        via: mov.ReferenceSus2
        to: staging.ref.GeneralMedicalPractitioner
      - from: staging.ref.GeneralMedicalPractitioner
        to: ods.ref.usp_LoadGeneralMedicalPractitionerToOds
      - from: ods.ref.usp_LoadGeneralMedicalPractitionerToOds
        to: ods.GeneralMedicalPractitioner
      - from: blob.ccg/ref/hourlytimebands.csv
        via: mov.ReferenceSus2
        to: staging.ref.HourlyTimeBand
      - from: staging.ref.HourlyTimeBand
        to: ods.ref.usp_LoadHourlyTimeBandToOds
      - from: ods.ref.usp_LoadHourlyTimeBandToOds
        to: ods.HourlyTimeBand
      - from: blob.ccg/ref/age.csv
        via: mov.ReferenceSus2
        to: staging.ref.Age
      - from: staging.ref.Age
        to: ods.ref.usp_LoadAgeToOds
      - from: ods.ref.usp_LoadAgeToOds
        to: ods.Age
      - from: blob.ccg/ref/sex.csv
        via: mov.ReferenceSus2
        to: staging.ref.Sex
      - from: staging.ref.Sex
        to: ods.ref.usp_LoadSexToOds
      - from: ods.ref.usp_LoadSexToOds
        to: ods.Sex
      - from: blob.ccg/ref/day.csv
        via: mov.ReferenceSus2
        to: staging.ref.Day
      - from: staging.ref.Day
        to: ods.ref.usp_LoadDayToOds
      - from: ods.ref.usp_LoadDayToOds
        to: ods.Day
      - from: blob.ccg/ref/localprovidersitecodes.csv
        via: mov.ReferenceSus2
        to: staging.ref.LocalProviderSiteCodes
      - from: staging.ref.LocalProviderSiteCodes
        to: ods.ref.usp_LoadLocalProviderSiteToOds
      - from: ods.ref.usp_LoadLocalProviderSiteToOds
        to: ods.LocalProviderSite
      - from: blob.ccg/ref/aae_deptcodes.csv
        via: mov.ReferenceSus2
        to: staging.ref.AeDeptCode
      - from: staging.ref.AeDeptCode
        to: ods.ref.usp_LoadAeDepartmentToOds
      - from: ods.ref.usp_LoadAeDepartmentToOds
        to: ods.AeDepartment
      - from: blob.ccg/ref/aae_locationtype.csv
        via: mov.ReferenceSus2
        to: staging.ref.AeLocationType
      - from: staging.ref.AeLocationType
        to: ods.ref.usp_LoadAeLocationTypeToOds
      - from: ods.ref.usp_LoadAeLocationTypeToOds
        to: ods.AeLocationType
      - from: blob.ccg/ref/aae_patientgroup.csv
        via: mov.ReferenceSus2
        to: staging.ref.AePatientGroup
      - from: staging.ref.AePatientGroup
        to: ods.ref.usp_LoadAePatientGroupToOds
      - from: ods.ref.usp_LoadAePatientGroupToOds
        to: ods.AePatientGroup
      - from: blob.ccg/ref/aae_referralsource.csv
        via: mov.ReferenceSus2
        to: staging.ref.AeReferralSource
      - from: staging.ref.AeReferralSource
        to: ods.ref.usp_LoadAeReferralSourceToOds
      - from: ods.ref.usp_LoadAeReferralSourceToOds
        to: ods.AeReferralSource
      - from: blob.ccg/ref/aae_attendancedisposal.csv
        via: mov.ReferenceSus2
        to: staging.ref.AeAttendanceDisposal
      - from: staging.ref.AeAttendanceDisposal
        to: ods.ref.usp_LoadAeAttendanceDisposalToOds
      - from: ods.ref.usp_LoadAeAttendanceDisposalToOds
        to: ods.AeAttendanceDisposal
      - from: blob.ccg/ref/aae_attendancecategory.csv
        via: mov.ReferenceSus2
        to: staging.ref.AeAttendanceCategory
      - from: staging.ref.AeAttendanceCategory
        to: ods.ref.usp_LoadAeAttendanceCategoryToOds
      - from: ods.ref.usp_LoadAeAttendanceCategoryToOds
        to: ods.AeAttendanceCategory
      - from: blob.ccg/ref/aae_arrivalmethod.csv
        via: mov.ReferenceSus2
        to: staging.ref.AeArrivalMethod
      - from: staging.ref.AeArrivalMethod
        to: ods.ref.usp_LoadAeArrivalMethodToOds
      - from: ods.ref.usp_LoadAeArrivalMethodToOds
        to: ods.AeArrivalMethod
      - from: blob.ccg/ref/aae_treatmentcodes.csv
        via: mov.ReferenceSus2
        to: staging.ref.AeTreatment
      - from: staging.ref.AeTreatment
        to: ods.ref.usp_LoadAeTreatmentToOds
      - from: ods.ref.usp_LoadAeTreatmentToOds
        to: ods.AeTreatment
      - from: blob.ccg/ref/aae_investigations.csv
        via: mov.ReferenceSus2
        to: staging.ref.AeInvestigation
      - from: staging.ref.AeInvestigation
        to: ods.ref.usp_LoadAeInvestigationToOds
      - from: ods.ref.usp_LoadAeInvestigationToOds
        to: ods.AeInvestigation
      - from: blob.ccg/ref/icd104_5digit.csv
        via: mov.ReferenceSus2
        to: staging.ref.Icd1045Digit
      - from: staging.ref.Icd1045Digit
        to: ods.ref.usp_LoadIcd10DiagnosesToOds
      - from: ods.ref.usp_LoadIcd10DiagnosesToOds
        to: ods.Icd10Diagnoses
      - from: blob.ccg/ref/aae_hrgcodes.csv
        via: mov.ReferenceSus2
        to: staging.ref.AeHealthcareResourceGroup
      - from: staging.ref.AeHealthcareResourceGroup
        to: ods.ref.usp_LoadAeHealthcareResourceGroupToOds
      - from: ods.ref.usp_LoadAeHealthcareResourceGroupToOds
        to: ods.AeHealthcareResourceGroup
      - from: blob.ccg/ref/practice_cluster.csv
        via: mov.ReferenceSus2
        to: staging.ref.PracticeCluster
      - from: staging.ref.PracticeCluster
        to: ods.ref.usp_LoadPracticeClusterToOds
      - from: ods.ref.usp_LoadPracticeClusterToOds
        to: ods.PracticeCluster
      - from: blob.ccg/ref/ONS lookup- LA and wards.csv
        via: mov.ReferenceSus2
        to: staging.ref.OnsLaWardMapping
      - from: staging.ref.OnsLaWardMapping
        to: ods.ref.usp_LoadOnsLaWardMappingToOds
      - from: ods.ref.usp_LoadOnsLaWardMappingToOds
        to: ods.ref.OnsLaWardMapping
      - from: blob.ccg/ref/primary_care_organisation.csv
        via: mov.ReferenceSus2
        to: staging.ref.PrimaryCareOrganisation
      - from: staging.ref.PrimaryCareOrganisation
        to: ods.ref.usp_LoadPrimaryCareOrganisationToOds
      - from: ods.ref.usp_LoadPrimaryCareOrganisationToOds
        to: ods.PrimaryCareOrganisation
      - from: blob.ccg/ref/organisations.csv
        via: mov.ReferenceSus2
        to: staging.ref.organisations
      - from: staging.ref.organisations
        to: ods.ref.usp_LoadProviderOrganisationToOds
      - from: ods.ref.usp_LoadProviderOrganisationToOds
        to: ods.ProviderOrganisation
      - from: blob.ccg/ref/ethniccategory.csv
        via: mov.ReferenceSus2
        to: staging.ref.EthnicCategory
      - from: staging.ref.EthnicCategory
        to: ods.ref.usp_LoadEthnicCategoryToOds
      - from: ods.ref.usp_LoadEthnicCategoryToOds
        to: ods.EthnicCategory
      - from: blob.ccg/ref/opastatus.csv
        via: mov.ReferenceSus2
        to: staging.ref.OutpatientStatus
      - from: staging.ref.OutpatientStatus
        to: ods.ref.usp_LoadOutpatientStatusToOds
      - from: ods.ref.usp_LoadOutpatientStatusToOds
        to: ods.OutpatientStatus
      - from: Default Data
        via: ods
        to: ods.AgeBanding
      - from: Default Data
        via: ods.ref.PrescriptionMapping.DefaultData
        to: ods.ref.PrescriptionMappingAcbScore
    # Load to DW
      - from: ods.AgeBanding
        via: mov.DwLoad
        to: ods.dw.usp_GetDimAgeData
      - from: ods.dw.usp_GetDimAgeData
        to: dw.staging.DimAge
      - from: dw.staging.DimAge
        to: dw.staging.usp_LoadDimAge
      - from: dw.staging.usp_LoadDimAge
        to: dw.dbo.DimAge
      - from: ods.clinical.PatientWaitingListOpenPathway
        via: mov.DwLoad
        to: ods.dw.usp_GetDimProviderSiteData
      - from: ods.Organisation
        via: mov.DwLoad
        to: ods.dw.usp_GetDimProviderSiteData
      - from: ods.clinical.PatientWaitingListDiagnostic
        via: mov.DwLoad
        to: ods.dw.usp_GetDimProviderSiteData
      - from: ods.phmsus.EmergencyCare
        via: mov.DwLoad
        to: ods.dw.usp_GetDimProviderSiteData
      - from: ods.dw.usp_GetDimProviderSiteData
        to: dw.staging.DimProviderSite
      - from: dw.staging.DimProviderSite
        to: dw.staging.usp_LoadDimProviderSite
      - from: dw.staging.usp_LoadDimProviderSite
        to: dw.dbo.DimProviderSite
      - from: ods.phmsus.EmergencyCare
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPostcodeDistrictData
      - from: ods.dw.usp_GetDimPostcodeDistrictData
        to: dw.staging.DimPostcodeDistrict
      - from: dw.staging.DimPostcodeDistrict
        to: dw.staging.usp_LoadDimPostcodeDistrict
      - from: dw.staging.usp_LoadDimPostcodeDistrict
        to: dw.dbo.DimPostcodeDistrict
      - from: ods.snomed.EcdsArrivalMode
        via: mov.DwLoad
        to: ods.dw.usp_GetDimSecondaryCareArrivalModeData
      - from: ods.dw.usp_GetDimSecondaryCareArrivalModeData
        to: dw.staging.DimSecondaryCareArrivalMode
      - from: dw.staging.DimSecondaryCareArrivalMode
        to: dw.staging.usp_LoadDimSecondaryCareArrivalMode
      - from: dw.staging.usp_LoadDimSecondaryCareArrivalMode
        to: dw.dbo.DimSecondaryCareArrivalMode
      - from: ods.phmsus.EmergencyCare
        via: mov.DwLoad
        to: ods.dw.usp_GetDimAttendanceSourceData
      - from: ods.dw.usp_GetDimAttendanceSourceData
        to: dw.staging.DimAttendanceSource
      - from: dw.staging.DimAttendanceSource
        to: dw.staging.usp_LoadDimAttendanceSource
      - from: dw.staging.usp_LoadDimAttendanceSource
        to: dw.dbo.DimAttendanceSource
      - from: ods.snomed.EcdsDischargeStatus
        via: mov.DwLoad
        to: ods.dw.usp_GetDimSecondaryCareDischargeStatusData
      - from: ods.dw.usp_GetDimSecondaryCareDischargeStatusData
        to: dw.staging.DimSecondaryCareDischargeStatus
      - from: dw.staging.DimSecondaryCareDischargeStatus
        to: dw.staging.usp_LoadDimSecondaryCareDischargeStatus
      - from: dw.staging.usp_LoadDimSecondaryCareDischargeStatus
        to: dw.dbo.DimSecondaryCareDischargeStatus
      - from: ods.snomed.EcdsDischargeDestination
        via: mov.DwLoad
        to: ods.dw.usp_GetDimSecondaryCareDischargeDestinationData
      - from: ods.dw.usp_GetDimSecondaryCareDischargeDestinationData
        to: dw.staging.DimSecondaryCareDischargeDestination
      - from: dw.staging.DimSecondaryCareDischargeDestination
        to: dw.staging.usp_LoadDimSecondaryCareDischargeDestination
      - from: dw.staging.usp_LoadDimSecondaryCareDischargeDestination
        to: dw.dbo.DimSecondaryCareDischargeDestination
      - from: ods.snomed.EcdsChiefComplaint
        via: mov.DwLoad
        to: ods.dw.usp_GetDimSecondaryCareChiefComplaintData
      - from: ods.dw.usp_GetDimSecondaryCareChiefComplaintData
        to: dw.staging.DimSecondaryCareChiefComplaint
      - from: dw.staging.DimSecondaryCareChiefComplaint
        to: dw.staging.usp_LoadDimSecondaryCareChiefComplaint
      - from: dw.staging.usp_LoadDimSecondaryCareChiefComplaint
        to: dw.dbo.DimSecondaryCareChiefComplaint
      - from: ods.snomed.EcdsAcuity
        via: mov.DwLoad
        to: ods.dw.usp_GetDimSecondaryCareAcuityData
      - from: ods.dw.usp_GetDimSecondaryCareAcuityData
        to: dw.staging.DimSecondaryCareAcuity
      - from: dw.staging.DimSecondaryCareAcuity
        to: dw.staging.usp_LoadDimSecondaryCareAcuity
      - from: dw.staging.usp_LoadDimSecondaryCareAcuity
        to: dw.dbo.DimSecondaryCareAcuity
      - from: ods.snomed.EcdsAccommodationStatus
        via: mov.DwLoad
        to: ods.dw.usp_GetDimAccommodationStatusData
      - from: ods.dw.usp_GetDimAccommodationStatusData
        to: dw.staging.DimAccommodationStatus
      - from: dw.staging.DimAccommodationStatus
        to: dw.staging.usp_LoadDimAccommodationStatus
      - from: dw.staging.usp_LoadDimAccommodationStatus
        to: dw.dbo.DimAccommodationStatus

  - name: Commissioning.dbo.InpatientDischargePathway
    edges:
    # Load UEC Inpatient Discharge Pathway data from UHD and DCH sources
      - from: blob.dch/uec-newton/uec-newton-discharges.csv
        via: mov.LocalSusDchWardStay
        to: staging.localsus.DchInpatientDischargePathway
      - from: blob.dch/uec-newton/uec-newton-ahah-referral.csv
        via: mov.LocalSusDchWardStay
        to: staging.localsus.DchAcuteHospitalAtHomeReferrals
      - from: blob.uhd/uec/UEC_Pathway.csv
        via: mov.LocalSusUhdWardStay
        to: staging.localsus.UhdInpatientDischargePathway
    # Load to ods
      - from: staging.localsus.UhdInpatientDischargePathway
        to: staging.localsus.usp_LoadUhdInpatientDischargePathwayToOds
      - from: bond.Person
        to: staging.localsus.usp_LoadUhdInpatientDischargePathwayToOds
      - from: staging.localsus.usp_LoadUhdInpatientDischargePathwayToOds
        to: ods.localsus.InpatientDischargePathway
      - from: staging.localsus.DchInpatientDischargePathway
        to: staging.localsus.usp_LoadDchInpatientDischargePathwayToOds
      - from: staging.localsus.usp_LoadDchInpatientDischargePathwayToOds
        to: ods.localsus.InpatientDischargePathway
      - from: staging.localsus.DchAcuteHospitalAtHomeReferrals
        to: staging.localsus.usp_LoadAcuteHospitalAtHomeReferralsToOds
      - from: staging.localsus.usp_LoadAcuteHospitalAtHomeReferralsToOds
        to: ods.localsus.AcuteHospitalAtHomeReferrals
    # Load to Commissioning
      - from: ods.localsus.InpatientDischargePathway
        via: mov.CxDischargePathwayLoad
        to: ods.localsus.usp_GetInpatientDischargePathwayData
      - from: ods.localsus.AcuteHospitalAtHomeReferrals
        via: mov.CxDischargePathwayLoad
        to: ods.localsus.usp_GetInpatientDischargePathwayData
      - from: ods.localsus.usp_GetInpatientDischargePathwayData
        to: commissioning.staging.InpatientDischargePathway
      - from: commissioning.staging.InpatientDischargePathway
        to: commissioning.staging.usp_LoadInpatientDischargePathway
      - from: commissioning.staging.usp_LoadInpatientDischargePathway
        to: commissioning.dbo.InpatientDischargePathway

  - name: dw.dbo.FactRiskStratificationWaitingList
    edges:
    # Load Risk Stratification data from sources
      - from: blob.datascience/risk strat/WaitingListRiskStrat/hiu_risk_score.csv
        via: mov.DataScienceRiskStrat
        to: staging.datascience.HighIntensityUserRiskStrat
    # Load to ods
      - from: staging.datascience.HighIntensityUserRiskStrat
        to: ods.datascience.usp_LoadHighIntensityUserRiskStratToOds
      - from: ods.datascience.usp_LoadHighIntensityUserRiskStratToOds
        to: ods.datascience.HighIntensityUserRiskStrat
    # Load to DW
      - from: ods.datascience.HighIntensityUserRiskStrat
        to: ods.dw.usp_GetFactRiskStratificationWaitingListData
      - from: ods.datascience.HighIntensityUserRiskStrat
        to: ods.dw.usp_GetDimDsRiskData
      - from: ods.datascience.HighIntensityUserRiskStrat
        to: ods.dw.usp_GetDimDsRiskStratificationTypeData
      - from: ods.dw.usp_GetFactRiskStratificationWaitingListData
        to: dw.staging.FactRiskStratificationWaitingList
      - from: ods.dw.usp_GetDimDsRiskData
        to: dw.staging.DimDsRisk
      - from: ods.dw.usp_GetDimDsRiskStratificationTypeData
        to: dw.staging.DimDsRiskStratificationType
      - from: dw.staging.FactRiskStratificationWaitingList
        to: dw.staging.usp_LoadFactRiskStratificationWaitingList
      - from: dw.staging.DimDsRisk
        to: dw.staging.usp_LoadDimDsRisk
      - from: dw.staging.DimDsRiskStratificationType
        to: dw.staging.usp_LoadDimDsRiskStratificationType
      - from: dw.staging.usp_LoadFactRiskStratificationWaitingList
        to: dw.dbo.FactRiskStratificationWaitingList
      - from: dw.staging.usp_LoadDimDsRisk
        to: dw.dbo.DimDsRisk
      - from: dw.staging.usp_LoadDimDsRiskStratificationType
        to: dw.dbo.DimDsRiskStratificationType
    # Foreign key relationships
      - from: dw.dbo.DimDsRisk
        to: dw.dbo.FactRiskStratificationWaitingList
      - from: dw.dbo.DimDsRiskStratificationType
        to: dw.dbo.FactRiskStratificationWaitingList

  - name: dw.dbo.AdultSocialCare
    edges:
    # Load Adult Social Care data from DC and BCP sources
      - from: blob.dorsetcouncil/AdultSocialCare/DC_AdultData.csv
        via: mov.DcAdultSocialCare
        to: staging.adultsc.DcAdultSocialCare
      - from: blob.bcp/Adults/BCP_ASC_DIIS.csv
        via: mov.BcpAdultSocialCare
        to: staging.adultsc.BcpAdultSocialCare
    # Load to ods
      - from: staging.adultsc.DcAdultSocialCare
        to: ods.adultsc.usp_LoadDcAdultSocialCareToOds
      - from: staging.adultsc.BcpAdultSocialCare
        to: ods.adultsc.usp_LoadBcpAdultSocialCareToOds
      - from: ods.adultsc.usp_LoadDcAdultSocialCareToOds
        to: ods.social.AdultSocialCare
      - from: ods.adultsc.usp_LoadBcpAdultSocialCareToOds
        to: ods.social.AdultSocialCare
    # Load to DW
      - from: ods.social.AdultSocialCare
        via: mov.DwLoad
        to: ods.dw.usp_GetFactAdultSocialCareData  
      - from: ods.social.AdultSocialCare
        via: mov.DwLoad
        to: ods.dw.usp_GetDimGenderData
      - from: ods.social.AdultSocialCare
        via: mov.DwLoad
        to: ods.dw.usp_GetDimEthnicityData
      - from: ods.social.AdultSocialCare
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPrimarySupportReasonData
      - from: ods.dw.usp_GetFactAdultSocialCareData
        to: dw.staging.FactAdultSocialCare
      - from: ods.dw.usp_GetDimAgeData
        to: dw.staging.DimAge
      - from: ods.dw.usp_GetDimGenderData
        to: dw.staging.DimGender
      - from: ods.dw.usp_GetDimEthnicityData
        to: dw.staging.DimEthnicity
      - from: ods.dw.usp_GetDimPrimarySupportReasonData
        to: dw.staging.DimPrimarySupportReason
      - from: dw.staging.FactAdultSocialCare
        to: dw.staging.usp_LoadFactAdultSocialCare
      - from: dw.staging.DimAge
        to: dw.staging.usp_LoadDimAge
      - from: dw.staging.DimGender
        to: dw.staging.usp_LoadDimGender
      - from: dw.staging.DimEthnicity
        to: dw.staging.usp_LoadDimEthnicity
      - from: dw.staging.DimPrimarySupportReason
        to: dw.staging.usp_LoadDimPrimarySupportReason
      - from: dw.staging.usp_LoadDimAge
        to: dw.dbo.DimAge
      - from: dw.staging.usp_LoadDimGender
        to: dw.dbo.DimGender
      - from: dw.staging.usp_LoadDimEthnicity
        to: dw.dbo.DimEthnicity
      - from: dw.staging.usp_LoadDimPrimarySupportReason
        to: dw.dbo.DimPrimarySupportReason
      - from: dw.staging.usp_LoadFactAdultSocialCare
        to: dw.dbo.FactAdultSocialCare
    # Foreign key relationships
      - from: dw.dbo.DimAge
        to: dw.dbo.FactAdultSocialCare
      - from: dw.dbo.DimGender
        to: dw.dbo.FactAdultSocialCare
      - from: dw.dbo.DimEthnicity
        to: dw.dbo.FactAdultSocialCare
      - from: dw.dbo.DimPrimarySupportReason
        to: dw.dbo.FactAdultSocialCare

  - name: dw.dbo.PatientWaitingListOpenPathway
    edges:
    # Load Patient Waiting List Open Pathway data from UHD and DCH sources
      - from: blob.dch/nwld/nwld_openpathways.csv
        via: mov.PatientWaitingListDch
        to: staging.acute.DchPtlOpenPathway
      - from: blob.uhd/nwl/openpathways.csv
        via: mov.PatientWaitingListUhd
        to: staging.acute.UhdPtlOpenPathway
    # Load to ods
      - from: staging.acute.DchPtlOpenPathway
        to: ods.acute.usp_LoadDchPtlOpenPathwayToOds
      - from: staging.acute.UhdPtlOpenPathway
        to: ods.acute.usp_LoadUhdPtlOpenPathwayToOds
      - from: ods.acute.usp_LoadDchPtlOpenPathwayToOds
        to: ods.clinical.PatientWaitingListOpenPathway
      - from: ods.acute.usp_LoadUhdPtlOpenPathwayToOds
        to: ods.clinical.PatientWaitingListOpenPathway
    # Load to DW
      - from: ods.clinical.PatientWaitingListOpenPathway
        to: ods.dw.usp_GetFactPatientWaitingListOpenPathwayData
      - from: ods.clinical.PatientWaitingListOpenPathway
        to: ods.dw.usp_GetDimSourceOfReferralData
      - from: ods.clinical.PatientWaitingListOpenPathway
        to: ods.dw.usp_GetDimProviderSiteData
      - from: ods.clinical.PatientWaitingListOpenPathway
        to: ods.dw.usp_GetDimSpecialtyData
      - from: ods.clinical.PatientWaitingListOpenPathway
        to: ods.dw.usp_GetDimReferralToTreatmentPeriodStatusData
      - from: ods.clinical.PatientWaitingListOpenPathway
        to: ods.dw.usp_GetDimAppointmentTypeData
      - from: ods.clinical.PatientWaitingListOpenPathway
        to: ods.dw.usp_GetDimOpcsProcedureData
      - from: ods.clinical.PatientWaitingListOpenPathway
        to: ods.dw.usp_GetDimCommissionerData
      - from: ods.clinical.PatientWaitingListOpenPathway
        to: ods.dw.usp_GetDimPriorityTypeData
      - from: ods.clinical.PatientWaitingListOpenPathway
        to: ods.dw.usp_GetDimIntendedManagementCodeData
      - from: ods.clinical.PatientWaitingListOpenPathway
        to: ods.dw.usp_GetDimWeekGroupData
      - from: ods.dw.usp_GetFactPatientWaitingListOpenPathwayData
        to: dw.staging.FactPatientWaitingListOpenPathway
      - from: ods.dw.usp_GetDimSourceOfReferralData
        to: dw.staging.DimSourceOfReferral
      - from: ods.dw.usp_GetDimProviderSiteData
        to: dw.staging.DimProviderSite
      - from: ods.dw.usp_GetDimSpecialtyData
        to: dw.staging.DimSpecialty
      - from: ods.dw.usp_GetDimAppointmentTypeData
        to: dw.staging.DimAppointmentType
      - from: ods.dw.usp_GetDimOpcsProcedureData
        to: dw.staging.DimOpcsProcedure
      - from: ods.dw.usp_GetDimCommissionerData
        to: dw.staging.DimCommissioner
      - from: ods.dw.usp_GetDimPriorityTypeData
        to: dw.staging.DimPriorityType
      - from: ods.dw.usp_GetDimWeekGroupData
        to: dw.staging.DimWeekGroup
      - from: dw.staging.FactPatientWaitingListOpenPathway
        to: dw.staging.usp_LoadFactPatientWaitingListOpenPathway
      - from: dw.staging.DimSourceOfReferral
        to: dw.staging.usp_LoadDimSourceOfReferral
      - from: dw.staging.DimProviderSite
        to: dw.staging.usp_LoadDimProviderSite
      - from: dw.staging.DimSpecialty
        to: dw.staging.usp_LoadDimSpecialty
      - from: dw.staging.DimAppointmentType
        to: dw.staging.usp_LoadDimAppointmentType
      - from: dw.staging.DimOpcsProcedure
        to: dw.staging.usp_LoadDimOpcsProcedure
      - from: dw.staging.DimCommissioner
        to: dw.staging.usp_LoadDimCommissioner
      - from: dw.staging.DimPriorityType
        to: dw.staging.usp_LoadDimPriorityType
      - from: dw.staging.DimWeekGroup
        to: dw.staging.usp_LoadDimWeekGroup
      - from: dw.staging.usp_LoadFactPatientWaitingListOpenPathway
        to: dw.dbo.FactPatientWaitingListOpenPathway
      - from: dw.staging.usp_LoadDimSourceOfReferral
        to: dw.dbo.DimSourceOfReferral
      - from: dw.staging.usp_LoadDimProviderSite
        to: dw.dbo.DimProviderSite
      - from: dw.staging.usp_LoadDimSpecialty
        to: dw.dbo.DimSpecialty
      - from: dw.staging.usp_LoadDimAppointmentType
        to: dw.dbo.DimAppointmentType
      - from: dw.staging.usp_LoadDimOpcsProcedure
        to: dw.dbo.DimOpcsProcedure
      - from: dw.staging.usp_LoadDimCommissioner
        to: dw.dbo.DimCommissioner
      - from: dw.staging.usp_LoadDimPriorityType
        to: dw.dbo.DimPriorityType
      - from: dw.staging.usp_LoadDimWeekGroup
        to: dw.dbo.DimWeekGroup
    # Foreign key relationships
      - from: dw.dbo.DimSourceOfReferral
        to: dw.dbo.FactPatientWaitingListOpenPathway
      - from: dw.dbo.DimProviderSite
        to: dw.dbo.FactPatientWaitingListOpenPathway
      - from: dw.dbo.DimSpecialty
        to: dw.dbo.FactPatientWaitingListOpenPathway
      - from: dw.dbo.DimReferralToTreatmentPeriodStatus
        to: dw.dbo.FactPatientWaitingListOpenPathway
      - from: dw.dbo.DimAppointmentType
        to: dw.dbo.FactPatientWaitingListOpenPathway
      - from: dw.dbo.DimOpcsProcedure
        to: dw.dbo.FactPatientWaitingListOpenPathway
      - from: dw.dbo.DimCommissioner
        to: dw.dbo.FactPatientWaitingListOpenPathway
      - from: dw.dbo.DimPriorityType
        to: dw.dbo.FactPatientWaitingListOpenPathway
      - from: dw.dbo.DimIntendedManagementCode
        to: dw.dbo.FactPatientWaitingListOpenPathway
      - from: dw.dbo.DimWeekGroup 
        to: dw.dbo.FactPatientWaitingListOpenPathway

  - name: dw.dbo.FactPersonConditionHistory
    edges:
    # Load to DW
      - from: ods.ref.MetricMeasurementCodeMapping
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonConditionHistoryData
      - from: ods.clinical.ReadCodeHierarchy
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonConditionHistoryData
      - from: ods.clinical.ReadCode
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonConditionHistoryData
      - from: ods.clinical.Condition
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonConditionHistoryData
      - from: ods.clinical.DrugSensitivity
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonConditionHistoryData
      - from: ods.clinical.MedicationReadCode
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonConditionHistoryData
      - from: ods.clinical.PersonReadCode
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonConditionHistoryData
      - from: ods.clinical.StaffMemberProfile
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonConditionHistoryData
      - from: ods.clinical.MedicationMultiLexProduct
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonConditionHistoryData
      - from: ods.clinical.MedicationReadCode
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonConditionHistoryData
      - from: ods.clinical.StaffMember
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonConditionHistoryData
      - from: ods.dw.usp_GetFactPersonConditionHistoryData
        to: dw.staging.FactPersonConditionHistory
      - from: ods.dw.usp_GetFactPersonConditionHistoryData
        via: mov.DwLoad
        to: ref.MetricMeasurementCodeMapping
      - from: ods.dw.usp_GetFactPersonConditionHistoryData
        via: mov.DwLoad
        to: dw.staging.DimCondition
      - from: ods.dw.usp_GetFactPersonConditionHistoryData
        via: mov.DwLoad
        to: dw.staging.DimStaffMember
      - from: dw.staging.FactPersonConditionHistory
        to: dw.staging.usp_LoadFactPersonConditionHistory
      - from: dw.staging.DimCondition
        to: dw.staging.usp_LoadFactPersonConditionHistory
      - from: dw.staging.DimStaffMember
        to: dw.staging.usp_LoadFactPersonConditionHistory
      - from: dw.staging.usp_LoadFactPersonConditionHistory
        to: dw.dbo.FactPersonConditionHistory
      - from: dw.staging.usp_LoadFactPersonConditionHistory
        to: dw.dbo.DimCondition
      - from: dw.staging.usp_LoadFactPersonConditionHistory
        to: dw.dbo.DimStaffMember
    # Foreign key relationships
      - from: dw.dbo.DimCondition 
        to: dw.dbo.FactPersonConditionHistory
      - from: dw.dbo.DimStaffMember 
        to: dw.dbo.FactPersonConditionHistory

  - name: dw.dbo.FactPrimaryCareAppointment
    edges:
    # Load to ods
      - from: ods.clinical.Appointment
        to: ods.sollis.usp_LoadPrimaryCareAppointment
      - from: ods.clinical.StaffMemberProfile
        to: ods.sollis.usp_LoadPrimaryCareAppointment
      - from: ods.sollis.usp_LoadPrimaryCareAppointment
        to: ods.sollis.PrimaryCareAppointment
    # Load to DW
      - from: ods.sollis.PrimaryCareAppointment
        to: ods.dw.usp_GetFactPrimaryCareAppointmentData
      - from: ods.dw.usp_GetFactPrimaryCareAppointmentData
        to: dw.staging.FactPrimaryCareAppointment
      - from: ods.dw.usp_GetDimAppointmentTypeData
        to: dw.staging.DimAppointmentType
      - from: ods.dw.usp_GetDimAppointmentStatusData
        to: dw.staging.DimAppointmentStatus
      - from: ods.dw.usp_GetDimDimStaffMemberTypeData
        to: dw.staging.DimStaffMemberType
      - from: ods.dw.usp_GetDimDimPrimaryCareRotaData
        to: dw.staging.DimPrimaryCareRota
      - from: dw.staging.FactPrimaryCareAppointment
        to: dw.staging.usp_LoadFactPrimaryCareAppointment
      - from: dw.staging.DimAppointmentType
        to: dw.staging.usp_LoadDimAppointmentType
      - from: dw.staging.DimAppointmentStatus
        to: dw.staging.usp_LoadDimAppointmentStatus 
      - from: dw.staging.DimStaffMemberType
        to: dw.staging.usp_LoadDimStaffMemberType
      - from: dw.staging.DimPrimaryCareRota
        to: dw.staging.usp_LoadDimPrimaryCareRota
      - from: dw.staging.usp_LoadFactPrimaryCareAppointment
        to: dw.dbo.FactPrimaryCareAppointment
      - from: dw.staging.usp_LoadDimAppointmentType
        to: dw.dbo.DimAppointmentType
      - from: dw.staging.usp_LoadDimAppointmentStatus
        to: dw.dbo.DimAppointmentStatus
      - from: dw.staging.usp_LoadDimStaffMemberType
        to: dw.dbo.DimStaffMemberType
      - from: dw.staging.usp_LoadDimPrimaryCareRota
        to: dw.dbo.DimPrimaryCareRota
    # Foreign key relationships
      - from: dw.dbo.DimAppointmentType
        to: dw.dbo.FactPrimaryCareAppointment
      - from: dw.dbo.DimAppointmentStatus
        to: dw.dbo.FactPrimaryCareAppointment
      - from: dw.dbo.DimStaffMemberType
        to: dw.dbo.FactPrimaryCareAppointment
      - from: dw.dbo.DimPrimaryCareRota
        to: dw.dbo.FactPrimaryCareAppointment

  - name: dw.dbo.FactSecondaryCareActivity
    edges:
    # Load Secondary Care Activity data from S251 source
      - from: source.S251.dbo.APC_Episodes
        via: PhmSusInpatient
        to: staging.phmsus.ApcEpisodes
      - from: source.S251.dbo.APC_Episodes_Supplementary62
        via: PhmSusInpatient
        to: staging.phmsus.ApcEpisodesSupplementary62
      - from: source.S251.dbo.APC_Spells
        via: PhmSusInpatient
        to: staging.phmsus.ApcSpells
      - from: source.S251.dbo.Outpatient
        via: PhmSusOutpatient
        to: staging.phmsus.Outpatient
      - from: source.S251.dbo.Outpatient_Supplementary62
        via: PhmSusOutpatient
        to: staging.phmsus.OutpatientSupplementary62
      - from: source.S251.dbo.Em
        via: PhmSusAe
        to: staging.phmsus.Em
      - from: source.S251.dbo.Em_Supplementary62
        via: PhmSusAe
        to: staging.phmsus.EmSupplementary62
    # Load to ods
      - from: staging.phmsus.ApcEpisodes
        to: phmsus.usp_LoadInpatientToOds
      - from: staging.phmsus.ApcEpisodesSupplementary62
        to: staging.phmsus.usp_LoadInpatientToOds
      - from: staging.phmsus.ApcSpells
        to: staging.phmsus.usp_LoadInpatientToOds
      - from: staging.phmsus.usp_LoadInpatientToOds
        to: ods.phmsus.Inpatient
      - from: source.S251.dbo.APC_Episodes
        via: PhmSusInpatient
        to: staging.phmsus.ApcEpisodes
      - from: source.S251.dbo.APC_Episodes_Supplementary62
        via: PhmSusInpatient
        to: staging.phmsus.ApcEpisodesSupplementary62
      - from: staging.phmsus.Outpatient
        to: staging.phmsus.usp_LoadOutpatientToOds
      - from: staging.phmsus.OutpatientSupplementary62
        to: staging.phmsus.usp_LoadOutpatientToOds
      - from: staging.phmsus.usp_LoadOutpatientToOds
        to: ods.phmsus.Outpatient
      - from: staging.phmsus.Em
        to: staging.phmsus.usp_LoadAccidentAndEmergencyToOds
      - from: staging.phmsus.EmSupplementary62
        to: staging.phmsus.usp_LoadAccidentAndEmergencyToOds
      - from: staging.phmsus.usp_LoadAccidentAndEmergencyToOds
        to: ods.phmsus.AccidentAndEmergency
    # Load to DW
      - from: ods.phmsus.Inpatient
        via: mov.DwLoad
        to: ods.dw.usp_GetFactSecondaryCareActivityData
      - from: ods.phmsus.Outpatient
        via: mov.DwLoad
        to: ods.dw.usp_GetFactSecondaryCareActivityData 
      - from: ods.phmsus.AccidentAndEmergency
        via: mov.DwLoad
        to: ods.dw.usp_GetFactSecondaryCareActivityData
      - from: ods.dw.usp_GetFactSecondaryCareActivityData
        to: dw.staging.FactSecondaryCareActivity
      - from: ods.clinical.Appointment
        via: mov.DwLoad
        to: ods.dw.usp_GetDimAppointmentStatusData      
      - from: ods.OutpatientStatus
        via: mov.DwLoad
        to: ods.dw.usp_GetDimAppointmentStatusData      
      - from: ods.clinical.IaptSession
        via: mov.DwLoad
        to: ods.dw.usp_GetDimAppointmentStatusData      
      - from: ods.dw.usp_GetDimAppointmentStatusData
        to: dw.staging.DimAppointmentStatus
      - from: dw.staging.FactSecondaryCareActivity
        to: dw.staging.usp_LoadFactSecondaryCareActivity
      - from: dw.staging.DimAppointmentStatus
        to: dw.staging.usp_LoadDimAppointmentStatus
      - from: dw.staging.usp_LoadFactSecondaryCareActivity
        to: dw.dbo.FactSecondaryCareActivity
      - from: dw.staging.usp_LoadDimAppointmentStatus
        to: dw.dbo.DimAppointmentStatus
    # Foreign key relationships
      - from: dw.dbo.DimAppointmentStatus
        to: dw.dbo.FactSecondaryCareActivity

  - name: dw.dbo.FactIntegratedUrgentCare111Calls
    edges:
    # Load Integrated Urgent Care 111 Calls data from DHC source
      - from: blob.dhc/iucs/FactUrgentCareCaseMetric.csv
        via: mov.IntegratedUrgentCare111Calls
        to: staging.iuc.FactUrgentCareCaseMetric
      - from: blob.dhc/iucs/DimPersonHistory.csv
        via: mov.IntegratedUrgentCare111Calls
        to: staging.iuc.DimPersonHistory
      - from: blob.dhc/iucs/DimUrgentCareMeasure.csv
        via: mov.IntegratedUrgentCare111Calls
        to: staging.iuc.DimUrgentCareMeasure
      - from: blob.dhc/iucs/DimUrgentCareCase.csv
        via: mov.IntegratedUrgentCare111Calls
        to: staging.iuc.DimUrgentCareCase
      - from: blob.dhc/iucs/DimUrgentCareDisposition.csv
        via: mov.IntegratedUrgentCare111Calls
        to: staging.iuc.DimUrgentCareDisposition
    # Load to ods
      - from: staging.iuc.FactUrgentCareCaseMetric
        to: iuc.usp_LoadUrgentCareCaseMetricToOds
      - from: staging.iuc.DimPersonHistory
        to: iuc.usp_LoadPersonHistoryToOds
      - from: staging.iuc.DimUrgentCareMeasure
        to: iuc.usp_LoadUrgentCareMeasureToOds
      - from: staging.iuc.DimUrgentCareCase
        to: iuc.usp_LoadUrgentCareCaseToOds
      - from: staging.iuc.DimUrgentCareDisposition
        to: iuc.usp_LoadUrgentCareDispositionToOds
      - from: iuc.usp_LoadUrgentCareCaseMetricToOds
        to: ods.iuc.UrgentCareCaseMetric
      - from: iuc.usp_LoadUrgentCarePersonHistoryToOds
        to: ods.iuc.UrgentCarePersonHistory
      - from: iuc.usp_LoadUrgentCareMeasureToOds
        to: ods.iuc.UrgentCareMeasure
      - from: iuc.usp_LoadUrgentCareCaseToOds
        to: ods.iuc.UrgentCareCase
      - from: iuc.usp_LoadUrgentCareDispositionToOds
        to: ods.iuc.UrgentCareDisposition
    # Load to DW
      - from: ods.iuc.UrgentCareCaseMetric
        to: ods.dw.usp_GetFactIntegratedUrgentCare111CallsData
      - from: ods.iuc.UrgentCareMeasure
        to: ods.dw.usp_GetDimCareMeasureData
      - from: ods.iuc.UrgentCareCase
        to: ods.dw.usp_GetDimCaseTypeData
      - from: ods.iuc.UrgentCareCase
        to: ods.dw.usp_GetDimCallOriginData
      - from: ods.iuc.UrgentCareDisposition
        to: ods.dw.usp_GetDimCareDispositionData
      - from: ods.dw.usp_GetDimCallOriginData
        to: dw.staging.DimCallOrigin
      - from: ods.iuc.UrgentCareCase
        to: ods.dw.usp_GetDimCaseOutcomeData
      - from: ods.dw.usp_GetFactIntegratedUrgentCare111CallsData
        to: dw.staging.FactIntegratedUrgentCare111Calls
      - from: ods.dw.usp_GetDimCareMeasureData
        to: dw.staging.DimCareMeasure
      - from: ods.dw.usp_GetDimCaseTypeData
        to: dw.staging.DimCaseType
      - from: ods.dw.usp_GetDimCallOriginData
        to: dw.staging.DimCallOrigin
      - from: ods.dw.usp_GetDimCaseOutcomeData
        to: dw.staging.DimCaseOutcome
      - from: ods.dw.usp_GetDimCareDispositionData
        to: dw.staging.DimCareDisposition
      - from: dw.staging.FactIntegratedUrgentCare111Calls
        to: dw.staging.usp_LoadFactIntegratedUrgentCare111Calls
      - from: dw.staging.DimCallOrigin
        to: dw.staging.usp_LoadDimCallOrigin
      - from: dw.staging.DimCaseType
        to: dw.staging.usp_LoadDimCaseType
      - from: dw.staging.DimCareMeasure
        to: dw.staging.usp_LoadDimCareMeasure
      - from: dw.staging.DimCaseOutcome
        to: dw.staging.usp_LoadDimCaseOutcome
      - from: dw.staging.DimCareDisposition
        to: dw.staging.usp_LoadDimCareDisposition
      - from: dw.staging.usp_LoadFactIntegratedUrgentCare111Calls
        to: dw.dbo.FactIntegratedUrgentCare111Calls
      - from: dw.staging.usp_LoadDimCallOrigin
        to: dw.dbo.DimCallOrigin
      - from: dw.staging.usp_LoadDimCaseType
        to: dw.dbo.DimCaseType
      - from: dw.staging.usp_LoadDimCareMeasure
        to: dw.dbo.DimCareMeasure
      - from: dw.staging.usp_LoadDimCaseOutcome
        to: dw.dbo.DimCaseOutcome
      - from: dw.staging.usp_LoadDimCareDisposition
        to: dw.dbo.DimCareDisposition
    # Foreign key relationships
      - from: dw.dbo.DimCallOrigin
        to: dw.dbo.FactIntegratedUrgentCare111Calls
      - from: dw.dbo.DimCaseType
        to: dw.dbo.FactIntegratedUrgentCare111Calls
      - from: dw.dbo.DimCareMeasure
        to: dw.dbo.FactIntegratedUrgentCare111Calls
      - from: dw.dbo.DimCaseOutcome
        to: dw.dbo.FactIntegratedUrgentCare111Calls
      - from: dw.dbo.DimCareDisposition
        to: dw.dbo.FactIntegratedUrgentCare111Calls

  - name: dw.dbo.DimClinicalMeasurement
    edges:
    # Load Clinical Measurement data from TPP SystmOne source
      - from: Default Data
        via: ods
        to: ods.ref.MetricMeasurementCodeMapping
    # Load to DW
      - from: ods.clinical.ReadCode
        to: ods.dw.usp_GetDimClinicalMeasurementData
      - from: ods.ref.MetricMeasurementCodeMapping
        to: ods.dw.usp_GetDimClinicalMeasurementData
      - from: ods.dw.usp_GetDimClinicalMeasurementData
        to: dw.staging.DimClinicalMeasurement
      - from: dw.staging.DimClinicalMeasurement
        to: dw.staging.usp_LoadDimClinicalMeasurement
      - from: dw.staging.usp_LoadDimClinicalMeasurement
        to: dw.dbo.DimClinicalMeasurement

  - name: dw.dbo.FactPersonClinicalHistory and dw.dbo.FactScreeningEligibilityHistory
    edges:
    # Load Person Clinical History data from TPP SystmOne source
      - from: Default Data
        via: ods
        to: ods.ref.MetricMeasurementCodeMapping
    # Load to DW
      - from: ods.clinical.ReadCode
        to: ods.dw.usp_GetFactPersonClinicalHistoryData
      - from: ods.clinical.Immunisation
        to: ods.dw.usp_GetFactPersonClinicalHistoryData 
      - from: ods.ref.MetricMeasurementCodeMapping
        to: ods.dw.usp_GetFactPersonClinicalHistoryData
      - from: ods.dw.usp_GetFactPersonClinicalHistoryData
        to: dw.staging.FactPersonClinicalHistory
      - from: ods.dw.usp_GetFactPersonClinicalHistoryData
        to: dw.staging.DimFactPersonClinicalHistory
      - from: dw.staging.FactPersonClinicalHistory
        to: dw.staging.usp_LoadFactPersonClinicalHistory
      - from: dw.staging.DimClinicalMeasurement
        to: dw.staging.usp_LoadDimClinicalMeasurement
    # Remove dbo here to enable the views below to be created from dbo.DimGpSurgery
      - from: dw.staging.usp_LoadFactPersonClinicalHistory
        to: dw.dbo.FactPersonClinicalHistory
      - from: dw.staging.usp_LoadDimClinicalMeasurement
        to: dw.dbo.DimClinicalMeasurement
      - from: dw.dbo.FactPersonClinicalHistory
        to: dw.usp_LoadFactScreeningEligibilityHistory
      - from: dw.dbo.DimClinicalMeasurement
        to: dw.usp_LoadFactScreeningEligibilityHistory
      - from: dw.usp_LoadFactScreeningEligibilityHistory
        to: dw.dbo.FactScreeningEligibilityHistory
    # Foreign key relationships
      - from: dw.dbo.DimClinicalMeasurement
        to: dw.dbo.FactPersonClinicalHistory
      - from: dw.dbo.DimClinicalMeasurement
        to: dw.dbo.FactScreeningEligibilityHistory

  - name: dw.dbo.DimPerson
    edges:
    # Load Person data from TPP SystmOne source 
      - from: ods.clinical.PersonReadCode
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: ods.clinical.ReadCodeHierarchy
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: ods.ref.MetricMeasurementCodeMapping
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: ods.MoasicKeyFeatures
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: ods.clinical.PersonOrganisationRegistration
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: ods.Partner
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: bond.Person
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: ods.MsoaName
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: blob.diis/lookup/BDP Indices of Deprivation.csv
        via: mov.LsoaDeprivationDecile
        to: staging.ref.LsoaDeprivationDecile
      - from: staging.ref.LsoaDeprivationDecile
        to: staging.ref.usp_LoadLsoaDeprivationDecileToOds
      - from: staging.ref.usp_LoadLsoaDeprivationDecileToOds
        to: ods.LsoaDeprivationDecile
      - from: ods.LsoaDeprivationDecile
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: ods.ref.OnsLaWardMapping
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: blob.diis/lookup/Lower_Layer_Super_Output_Areas_.csv
        via: mov.LsoaWeightedCentroid
        to: staging.ref.LsoaWeightedCentroid
      - from: staging.ref.LsoaWeightedCentroid
        to: staging.ref.usp_LoadLsoaWeightedCentroidToOds
      - from: staging.ref.usp_LoadLsoaWeightedCentroidToOds
        to: ods.LsoaWeightedCentroid
      - from: ods.LsoaWeightedCentroid
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: ods.Mosaic
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: ods.LsoaCoastal
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPersonData
      - from: ods.dw.usp_GetDimPersonData
        to: ods.dw.DimPerson
    # Load to DW
      - from: ods.dw.DimPerson
        to: ods.dw.usp_GetDimPersonData
      - from: ods.dw.usp_GetDimPersonData
        to: dw.staging.DimPerson
      - from: dw.staging.DimPerson
        to: dw.staging.usp_LoadDimPerson
      - from: dw.staging.usp_LoadDimPerson
        to: dw.dbo.DimPerson

  - name: performance.dbo.FactSwasftCcg
    edges:
    # Load Swasft SwasftCcg from source 
      - from: Blob_swasft/aggregate/ARR110CCG_*.csv
        via: Swasft
        to: staging.swa.Ccg
    # Load to ODS
      - from: staging.swa.Ccg
        to: staging.swa.usp_LoadSwasftCcgToOds
      - from: staging.swa.usp_LoadSwasftCcgToOds
        to: ods.swa.Ccg
    # Load to performance DW 
      - from: ods.swa.Ccg
        to: ods.performance.usp_GetFactSwasftCcgData 
      - from: ods.performance.usp_GetFactSwasftCcgData
        to: performance.staging.FactSwasftCcg
      - from: performance.staging.FactSwasftCcg
        to: performance.staging.usp_LoadFactSwasftCcg
      - from: performance.staging.usp_LoadFactSwasftCcg
        to: performance.dbo.FactSwasftCcg
    # Foreign Key Relationship
      - from: performance.dbo.DimSwasftOrganisation
        to: performance.dbo.FactSwasftCcg
      - from: performance.dbo.DimSwasftLevel
        to: performance.dbo.FactSwasftCcg
  
  - name: performance.dbo.FactSwasftHospital
    edges:
    # Load Swasft SwasftHospital from source 
      - from: Blob_swasft/aggregate/ARR110Hospital_*.csv
        via: Swasft
        to: staging.swa.Hospital
    # Load to ODS
      - from: staging.swa.Hospital
        to: staging.swa.usp_LoadSwasftHospitalToOds
      - from: staging.swa.usp_LoadSwasftHospitalToOds
        to: ods.swa.Hospital
    # Load to performance DW 
      - from: ods.swa.Hospital
        to: ods.performance.usp_GetFactSwasftHospitalData
      - from: ods.performance.usp_GetFactSwasftHospitalData
        to: performance.staging.FactSwasftHospital
      - from: performance.staging.FactSwasftHospital
        to: performance.staging.usp_LoadFactSwasftHospital
      - from: performance.staging.usp_LoadFactSwasftHospital
        to: performance.dbo.FactSwasftHospital
    # Foreign Key Relationship
      - from: performance.dbo.DimSwasftOrganisation
        to: performance.dbo.FactSwasftHospital

  - name: performance.dbo.FactSwasftDailyHandoverAggregated
    edges:
    # Load Swasft SwasftDailyHandoverAggregated from source 
      - from: Blob_swasft/aggregate/AR118HandoversAggregated_*.csv
        via: mov.ArchiveSwasftDailyHandover
        to: staging.swa.SwasftDailyHandoverAggregated
    # Load to ODS
      - from: staging.swa.SwasftDailyHandoverAggregated
        to: staging.swa.usp_LoadSwasftDailyHandoverAggregatedToOds
      - from: staging.swa.usp_LoadSwasftDailyHandoverAggregatedToOds
        to: ods.swa.SwasftDailyHandoverAggregated
    # Load to performance DW 
      - from: openpathwaysds.swa.SwasftDailyHandoverAggregated
        via: mov.PerformanceDwLoad
        to: ods.performance.usp_GetFactSwasftDailyHandoverAggregatedData
      - from: ods.performance.usp_GetFactSwasftDailyHandoverAggregatedData
        to: performance.staging.FactSwasftDailyHandoverAggregated
      - from: performance.staging.FactSwasftDailyHandoverAggregated
        to: performance.staging.usp_LoadFactSwasftDailyHandoverAggregated
      - from: performance.staging.usp_LoadFactSwasftDailyHandoverAggregated
        to: performance.dbo.FactSwasftDailyHandoverAggregated
      # Foreign Key Relationships
      - from: performance.dbo.DimSwasftOrganisation
        to: performance.dbo.FactSwasftDailyHandoverAggregated

  - name: performance.dbo.FactSwasftDailyHandoverDetailed
    edges:
    # Load Swasft SwasftDailyHandoverDetailed from source 
      - from: Blob_swasft/aggregate/AR119HandoverDetails_*.csv
        via: mov.ArchiveSwasftDailyHandover
        to: staging.swa.SwasftDailyHandoverDetailed
    # Load to ODS
      - from: staging.swa.SwasftDailyHandoverDetailed
        to: staging.swa.usp_LoadSwasftDailyHandoverDetailedToOds
      - from: staging.swa.usp_LoadSwasftDailyHandoverDetailedToOds
        to: ods.swa.SwasftDailyHandoverDetailed
    # Load to performance DW 
      - from: ods.swa.SwasftDailyHandoverDetailed
        via: mov.PerformanceDwLoad
        to: ods.performance.usp_GetFactSwasftDailyHandoverDetailedData
      - from: ods.performance.usp_GetFactSwasftDailyHandoverDetailedData
        to: performance.staging.FactSwasftDailyHandoverDetailed
      - from: performance.staging.FactSwasftDailyHandoverDetailed
        to: performance.staging.usp_LoadFactSwasftDailyHandoverDetailed
      - from: performance.staging.usp_LoadFactSwasftDailyHandoverDetailed
        to: performance.dbo.FactSwasftDailyHandoverDetailed
       # Foreign Key Relationships
      - from: performance.dbo.DimSwasftOrganisation
        to: performance.dbo.FactSwasftDailyHandoverDetailed
      - from: performance.dbo.DimSwasftOrganisationWard
        to: performance.dbo.FactSwasftDailyHandoverDetailed
      - from: performance.dbo.DimLateHandoverReason
        to: performance.dbo.FactSwasftDailyHandoverDetailed
      - from: performance.dbo.DimIncidentColour
        to: performance.dbo.FactSwasftDailyHandoverDetailed
      - from: performance.dbo.DimGender
        to: performance.dbo.FactSwasftDailyHandoverDetailed
      - from: performance.dbo.DimAgeBand
        to: performance.dbo.FactSwasftDailyHandoverDetailed
  
  - name: performance.dbo.FactSwasftDailyHandover
    edges:
    # Load Swasft Daily Handover from source 
      - from: Blob_swasft/aggregate/AR119HandoverDetails_*.csv
        via: mov.SwasftDailyHandover
        to: staging.swa.SwasftDailyHandover
    # Load to ODS
      - from: staging.swa.SwasftDailyHandover
        to: staging.swa.usp_LoadSwasftDailyHandoverToOds
      - from: staging.swa.usp_LoadSwasftDailyHandoverToOds
        to: ods.swa.SwasftDailyHandover
    # Load to performance DW 
      - from: ods.swa.SwasftDailyHandover
        via: mov.PerformanceDwLoad
        to: ods.performance.usp_GetFactSwasftDailyHandoverData
      - from: ods.performance.usp_GetFactSwasftDailyHandoverData
        to: performance.staging.FactSwasftDailyHandover
      - from: performance.staging.FactSwasftDailyHandover
        to: performance.staging.usp_LoadFactSwasftDailyHandover
      - from: performance.staging.usp_LoadFactSwasftDailyHandover
        to: performance.dbo.FactSwasftDailyHandover
        # Foreign Key Relationships
      - from: performance.dbo.DimSwasftOrganisation
        to: performance.dbo.FactSwasftDailyHandover
      - from: performance.dbo.DimSwasftOrganisationWard
        to: performance.dbo.FactSwasftDailyHandover
      - from: performance.dbo.DimLateHandoverReason
        to: performance.dbo.FactSwasftDailyHandover
      - from: performance.dbo.DimIncidentColour
        to: performance.dbo.FactSwasftDailyHandover
      - from: performance.dbo.DimGender
        to: performance.dbo.FactSwasftDailyHandover
      - from: performance.dbo.DimAgeBand
        to: performance.dbo.FactSwasftDailyHandover
      - from: performance.dbo.DimTimelyHandoverStatus
        to: performance.dbo.FactSwasftDailyHandover
      - from: performance.dbo.DimTimelyHandoverReason
        to: performance.dbo.FactSwasftDailyHandover

  - name: performance.dbo.FactSwasftDailySitrepCommissioner
    edges:
    # Load Swasft Daily Sitrep Commissioner from RPA SystmOne Source 
      - from: RoboticProcessAutomation
        via: mov.SwasftDailySitrep
        to: staging.swa.SwasftDailySitrepIcb
    # Load to ODS
      - from: staging.swa.SwasftDailySitrepIcb
        to: swa.usp_LoadSwasftDailySitrepIcbToOds
      - from: swa.usp_LoadSwasftDailySitrepIcbToOds
        to: ods.swa.SwasftDailySitrepCommissioner
    # Load to performance DW 
      - from: ods.swa.SwasftDailySitrepCommissioner
        via: mov.PerformanceDwLoad
        to: ods.performance.usp_GetFactSwasftDailySitrepCommissionerData
      - from: ods.performance.usp_GetFactSwasftDailySitrepCommissionerData
        to: performance.staging.FactSwasftDailySitrepCommissioner
      - from: performance.staging.FactSwasftDailySitrepCommissioner
        to: performance.staging.usp_LoadFactSwasftDailySitrepCommissioner
      - from: performance.staging.usp_LoadFactSwasftDailySitrepCommissioner
        to: performance.dbo.FactSwasftDailySitrepCommissioner
          # Foreign Key Relationships
      - from: performance.dbo.DimMeasure
        to: performance.dbo.FactSwasftDailySitrepCommissioner
      - from: performance.dbo.DimCommissioner
        to: performance.dbo.FactSwasftDailySitrepCommissioner

  - name: performance.dbo.FactSwasftDailySitrepHospital
    edges:
    # Load Swasft Daily Sitrep Hospital from RPA SystmOne Source 
      - from: RoboticProcessAutomation
        via: mov.SwasftDailySitrep
        to: staging.swa.SwasftDailySitrepIcb
    # Load to ODS
      - from: staging.swa.SwasftDailySitrepIcb
        to: swa.usp_LoadSwasftDailySitrepIcbToOds
      - from: swa.usp_LoadSwasftDailySitrepIcbToOds
        to: ods.swa.SwasftDailySitrepHospital
    # Load to performance DW 
      - from: ods.swa.SwasftDailySitrepHospital
        via: mov.PerformanceDwLoad
        to: ods.performance.usp_GetFactSwasftDailySitrepHospitalData
      - from: ods.performance.usp_GetFactSwasftDailySitrepHospitalData
        to: Performance.staging.FactSwasftDailySitrepHospital
      - from: Performance.staging.FactSwasftDailySitrepHospital
        to: performance.staging.usp_LoadFactSwasftDailySitrepHospital
      - from: performance.staging.usp_LoadFactSwasftDailySitrepHospital
        to: performance.dbo.FactSwasftDailySitrepHospital
         # Foreign Key Relationships
      - from: performance.dbo.DimMeasure
        to: performance.dbo.FactSwasftDailySitrepHospital
      - from: performance.dbo.DimSwasftOrganisation
        to: performance.dbo.FactSwasftDailySitrepHospital

  - name: performance.dbo.DimSwasftLevel
    # Load to Performance DW
    edges:
      - from: ods.swa.Ccg
        to: ods.performance.usp_GetDimSwasftLevelData
      - from: ods.performance.usp_GetDimSwasftLevelData
        to: performance.staging.DimSwasftLevel
      - from: performance.staging.DimSwasftLevel
        to: performance.staging.usp_LoadDimSwasftLevel
      - from: performance.staging.usp_LoadDimSwasftLevel
        to: performance.dbo.DimSwasftLevel

  - name: performance.dbo.DimSwasftOrganisation
    # Load to Performance DW
    edges:
      - from: ods.swa.Hospital
        to: ods.performance.usp_GetDimSwasftOrganisationData
      - from: ods.swa.Ccg
        to: ods.performance.usp_GetDimSwasftOrganisationData
      - from: ods.swa.SwasftDailyHandoverAggregated
        to: ods.performance.usp_GetDimSwasftOrganisationData
      - from: ods.swa.SwasftDailyHandoverDetailed
        to: ods.performance.usp_GetDimSwasftOrganisationData
      - from: ods.swa.SwasftDailyHandover
        to: ods.performance.usp_GetDimSwasftOrganisationData
      - from: ods.performance.usp_GetDimSwasftOrganisationData
        to: performance.staging.DimSwasftOrganisation
      - from: performance.staging.DimSwasftOrganisation
        to: performance.staging.usp_LoadDimSwasftOrganisation
      - from: performance.staging.usp_LoadDimSwasftOrganisation
        to: performance.dbo.DimSwasftOrganisation

  - name: performance.dbo.DimSwasftOrganisationWard
    # Load to Performance DW
    edges:
      - from: ods.swa.SwasftDailyHandoverDetailed
        via: mov.PerformanceDwLoad
        to: ods.performance.usp_GetDimSwasftOrganisationWardData
      - from: ods.swa.SwasftDailyHandover
        to: ods.performance.usp_GetDimSwasftOrganisationWardData
      - from: ods.performance.usp_GetDimSwasftOrganisationWardData
        to: performance.staging.DimSwasftOrganisationWard
      - from: performance.staging.DimSwasftOrganisationWard
        to: performance.staging.usp_LoadDimSwasftOrganisationWard
      - from: performance.staging.usp_LoadDimSwasftOrganisationWard
        to: performance.dbo.DimSwasftOrganisationWard

  - name: performance.dbo.DimIncidentColour
    # Load to Performance DW
    edges:
      - from: ods.swa.SwasftDailyHandoverDetailed
        to: ods.performance.usp_GetDimIncidentColourData
      - from: ods.swa.SwasftDailyHandover
        to: ods.performance.usp_GetDimIncidentColourData
      - from: ods.performance.usp_GetDimIncidentColourData
        to: performance.staging.DimIncidentColour
      - from: performance.staging.DimIncidentColour
        to: performance.staging.usp_LoadDimIncidentColour
      - from: performance.staging.usp_LoadDimIncidentColour
        to: performance.dbo.DimIncidentColour

  - name: performance.dbo.DimTimelyHandoverReason
    # Load to Performance DW
    edges:
      - from: ods.swa.SwasftDailyHandover
        via: mov.PerformanceDwLoad
        to: ods.performance.usp_GetDimTimelyHandoverReasonData
      - from: ods.performance.usp_GetDimTimelyHandoverReasonData
        to: performance.staging.DimTimelyHandoverReason
      - from: performance.staging.DimTimelyHandoverReason
        to: performance.staging.usp_LoadDimTimelyHandoverReason
      - from: performance.staging.usp_LoadDimTimelyHandoverReason
        to: performance.dbo.DimTimelyHandoverReason

  - name: performance.dbo.DimLateHandoverReason
    # Load to Performance DW
    edges:
      - from: ods.swa.SwasftDailyHandoverDetailed
        to: ods.performance.usp_GetDimLateHandoverReasonData
      - from: ods.swa.SwasftDailyHandover
        to: ods.performance.usp_GetDimLateHandoverReasonData
      - from: ods.performance.usp_GetDimLateHandoverReasonData
        to: performance.staging.DimLateHandoverReason
      - from: performance.staging.DimLateHandoverReason
        to: performance.staging.usp_LoadDimLateHandoverReason
      - from: performance.staging.usp_LoadDimLateHandoverReason
        to: performance.dbo.DimLateHandoverReason

  - name: performance.dbo.DimGender
    # Load to Performance DW
    edges:
      - from: ods.swa.SwasftDailyHandoverDetailed
        to: ods.performance.usp_GetDimGenderData
      - from: ods.performance.QuarterlyPracticePopulation
        to: ods.performance.usp_GetDimGenderData
      - from: ods.performance.usp_GetDimGenderData
        to: performance.staging.DimGender
      - from: performance.staging.DimGender
        to: performance.staging.usp_LoadDimGender
      - from: performance.staging.usp_LoadDimGender
        to: performance.dbo.DimGender

  - name: performance.dbo.DimAgeBand
    # Load to Performance DW
    edges:
      - from: ods.dbo.AgeBanding
        to: ods.performance.usp_GetDimAgeBandData
      - from: ods.performance.usp_GetDimAgeBandData
        to: performance.staging.DimAgeBand
      - from: performance.staging.DimAgeBand
        to: performance.staging.usp_LoadDimAgeBand
      - from: performance.staging.usp_LoadDimAgeBand
        to: performance.dbo.DimAgeBand

  - name: performance.dbo.DimTimelyHandoverStatus
    # Load to Performance DW
    edges:
      - from: ods.swa.SwasftDailyHandover
        to: ods.performance.usp_GetDimTimelyHandoverStatusData
      - from: ods.performance.usp_GetDimTimelyHandoverStatusData
        to: performance.staging.DimTimelyHandoverStatus
      - from: performance.staging.DimTimelyHandoverStatus
        to: performance.staging.usp_LoadDimTimelyHandoverStatus
      - from: performance.staging.usp_LoadDimTimelyHandoverStatus
        to: performance.dbo.DimTimelyHandoverStatus

  - name: ods.ref.PwlSourceOfReferralLookup
    edges:
      - from: Blob_diis/PatientWaitingListLookup/SourceOfReferral.csv
        via: mov.PatientWaitingListLookup
        to: staging.ref.PwlSourceOfReferralLookup
      - from: staging.ref.PwlSourceOfReferralLookup
        to: staging.ref.usp_LoadPwlSourceOfReferralLookupToOds
      - from: staging.ref.usp_LoadPwlSourceOfReferralLookupToOds
        to: ods.ref.PwlSourceOfReferralLookup
      - from: ods.ref.PwlSourceOfReferralLookup
        via: mov.PatientWaitingListUhd
        to: ods.dw.usp_GetDimSourceOfReferralData
      - from: ods.ref.PwlSourceOfReferralLookup
        via: mov.PatientWaitingListDch
        to: ods.dw.usp_GetDimSourceOfReferralData
      - from: ods.dw.usp_GetDimSourceOfReferralData
        to: dw.staging.DimSourceOfReferral
      - from: dw.staging.DimSourceOfReferral
        to: dw.staging.usp_LoadDimSourceOfReferral
      - from: dw.staging.usp_LoadDimSourceOfReferral
        to: dw.dbo.DimSourceOfReferral

  - name: ods.ref.PwlReferralToTreatmentPeriodStatusLookup
    edges:
      - from: Blob_diis/PatientWaitingListLookup/ReferralToTreatmentPeriodStatus.csv
        via: mov.PatientWaitingListLookup
        to: staging.ref.PwlReferralToTreatmentPeriodStatusLookup
      - from: staging.ref.PwlReferralToTreatmentPeriodStatusLookup
        to: staging.ref.usp_LoadPwlReferralToTreatmentPeriodStatusLookupToOds
      - from: staging.ref.usp_LoadPwlReferralToTreatmentPeriodStatusLookupToOds
        to: ods.ref.PwlReferralToTreatmentPeriodStatusLookup
      - from: ods.ref.PwlReferralToTreatmentPeriodStatusLookup
        via: mov.PatientWaitingListUhd
        to: ods.dw.usp_GetDimReferralToTreatmentPeriodStatusData
      - from: ods.ref.PwlReferralToTreatmentPeriodStatusLookup
        via: mov.PatientWaitingListDch
        to: ods.dw.usp_GetDimReferralToTreatmentPeriodStatusData
      - from: ods.dw.usp_GetDimReferralToTreatmentPeriodStatusData
        to: dw.staging.DimReferralToTreatmentPeriodStatus
      - from: dw.staging.DimReferralToTreatmentPeriodStatus
        to: dw.staging.usp_LoadDimReferralToTreatmentPeriodStatus
      - from: dw.staging.usp_LoadDimReferralToTreatmentPeriodStatus
        to: dw.dbo.DimReferralToTreatmentPeriodStatus

  - name: ods.ref.PwlIntendedManagementCodeLookup
    edges:
      - from: Blob_diis/PatientWaitingListLookup/IntendedManagementCode.csv
        via: mov.PatientWaitingListLookup
        to: staging.ref.PwlIntendedManagementCodeLookup
      - from: staging.ref.PwlIntendedManagementCodeLookup
        to: staging.ref.usp_LoadPwlIntendedManagementCodeLookupToOds
      - from: staging.ref.usp_LoadPwlIntendedManagementCodeLookupToOds
        to: ods.ref.PwlIntendedManagementCodeLookup
      - from: ods.ref.PwlIntendedManagementCodeLookup
        via: mov.PatientWaitingListUhd
        to: ods.dw.usp_GetDimIntendedManagementCodeData
      - from: ods.ref.PwlIntendedManagementCodeLookup
        via: mov.PatientWaitingListDch
        to: ods.dw.usp_GetDimIntendedManagementCodeData
      - from: ods.dw.usp_GetDimIntendedManagementCodeData
        to: dw.staging.DimIntendedManagementCode
      - from: dw.staging.DimIntendedManagementCode
        to: dw.staging.usp_LoadDimIntendedManagementCode
      - from: dw.staging.usp_LoadDimIntendedManagementCode
        to: dw.dbo.DimIntendedManagementCode


  - name: commissioning.dbo.EcdsSnomed

    edges:
    # From TRUD to Staging 
    - from: TRUD        
      via: api.sno
      to: staging.snomed.ConceptClinical
    - from: TRUD        
      via: api.sno
      to: staging.snomed.ConceptInternational
    - from: TRUD        
      via: api.sno
      to: staging.snomed.ConceptUk
    - from: TRUD        
      via: api.sno
      to: staging.snomed.DescriptionClinical
    - from: TRUD        
      via: api.sno
      to: staging.snomed.DescriptionInternational
    - from: TRUD        
      via: api.sno
      to: staging.snomed.DescriptionUk
    # From staging to ODS
    - from: staging.snomed.ConceptClinical
      via: mov.snomed
      to: staging.snomed.usp_LoadConceptClinicalToOds
    - from: staging.snomed.usp_LoadConceptClinicalToOds
      to: ods.snomed.ConceptHistory
    - from: staging.snomed.ConceptInternational
      via: mov.snomed
      to: staging.snomed.usp_LoadConceptInternationalToOds
    - from: staging.snomed.usp_LoadConceptInternationalToOds
      to: ods.snomed.ConceptHistory
    - from: staging.snomed.ConceptUk
      via: mov.snomed
      to: staging.snomed.usp_LoadConceptUkToOds
    - from: staging.snomed.usp_LoadConceptUkToOds
      to: ods.snomed.ConceptHistory 
    - from: staging.snomed.DescriptionClinical
      via: mov.snomed
      to: staging.snomed.usp_LoadDescriptionClinicalToOds
    - from: staging.snomed.usp_LoadDescriptionClinicalToOds
      to: ods.snomed.DescriptionHistory
    - from: staging.snomed.DescriptionInternational
      via: mov.snomed
      to: staging.snomed.usp_LoadDescriptionInternationalToOds
    - from: staging.snomed.usp_LoadDescriptionInternationalToOds
      to: ods.snomed.DescriptionHistory
    - from: staging.snomed.DescriptionUk
      via: mov.snomed
      to: staging.snomed.usp_LoadDescriptionUkToOds
    - from: staging.snomed.usp_LoadDescriptionUkToOds
      to: ods.snomed.DescriptionHistory 
      # Load to ODS from ODS 
    - from: ods.snomed.ConceptHistory 
      to: ods.snomed.usp_LoadConceptHistoryToConcept
    - from: ods.snomed.usp_LoadConceptHistoryToConcept
      to: ods.snomed.Concept
    - from: ods.snomed.Concept
      via: mov.CxSusEcdsNew
      to: ods.cx.usp_GetEcdsSnomedData
    - from: ods.snomed.Concept
      to: ods.snomed.usp_LoadConceptDescriptionMapping
    - from: ods.snomed.usp_LoadConceptDescriptionMapping
      to : ods.snomed.ConceptDescriptionMapping
    - from: ods.snomed.ConceptDescriptionMapping
      via: mov.CxSusEcdsNew
      to: ods.cx.usp_GetEcdsSnomedData
    - from: ods.snomed.DescriptionHistory 
      to: ods.snomed.usp_LoadDescriptionHistoryToDescription
    - from: ods.snomed.usp_LoadDescriptionHistoryToDescription
      to: ods.snomed.Description
    - from: ods.snomed.Description
      via: mov.CxSusEcdsNew
      to: ods.cx.usp_GetEcdsSnomedData
      # Load to Commissioning DW 
    - from: ods.cx.usp_GetEcdsSnomedData
      to: commissioning.staging.EcdsSnomed
    - from: commissioning.staging.EcdsSnomed
      to: commissioning.staging.usp_LoadEcdsSnomed
    - from: commissioning.staging.usp_LoadEcdsSnomed
      to: commissioning.dbo.EcdsSnomed
  - name: dw.dbo.FactImmunisationEligibility
    edges:
    # Load to DW
      - from: ods.clinical.PersonOrganisationRegistration
        via: mov.DwLoad
        to: ods.dw.usp_GetFactImmunisationEligibilityData
      - from: ods.dw.usp_GetFactImmunisationEligibilityData
        to: dw.staging.FactImmunisationEligibility
      - from: dw.staging.FactImmunisationEligibility
        to: dw.staging.usp_LoadFactImmunisationEligibility
      - from: dw.staging.usp_LoadFactImmunisationEligibility
        to: dw.dbo.FactImmunisationEligibility

  - name: dw.dbo.FactMedicationHistory
    edges:
    # Load to DW
      - from: ods.clinical.PrimaryCareMedication
        via: mov.DwLoad
        to: ods.dw.usp_GetFactMedicationHistoryData
      - from: blob.diis/ref/Final SystmOne DrugLookup.csv
        via: mov.BnfMedication
        to: staging.drug.BnfDrugLookup
      - from: staging.drug.BnfDrugLookup
        to: ods.drug.usp_LoadBnfDrugLookupToOds
      - from: ods.drug.usp_LoadBnfDrugLookupToOds
        to: ods.drug.BnfDrugLookup
      - from: ods.drug.BnfDrugLookup
        via: mov.DwLoad
        to: ods.dw.usp_GetFactMedicationHistoryData
      - from: ods.drug.BnfDrugLookup
        via: mov.DwLoad
        to: ods.dw.usp_GetDimBnfMedicationData
      - from: ods.dw.usp_GetFactMedicationHistoryData
        to: dw.staging.FactMedicationHistory
      - from: ods.dw.usp_GetFactMedicationHistoryData
        to: dw.staging.FactMedicationHistory
      - from: ods.dw.usp_GetDimBnfMedicationData
        to: dw.staging.DimBnfMedication
      - from: dw.staging.FactMedicationHistory
        to: dw.staging.usp_LoadFactMedicationHistory
      - from: dw.staging.DimBnfMedication
        to: dw.staging.usp_LoadDimBnfMedication
      - from: dw.staging.usp_LoadDimBnfMedication
        to: dw.dbo.DimBnfMedication
      - from: dw.dbo.DimBnfMedication
        to: dw.staging.usp_LoadFactMedicationHistory
      - from: dw.staging.usp_LoadFactMedicationHistory
        to: dw.dbo.FactMedicationHistory
    # Foreign key relationships
      - from: dw.dbo.DimBnfMedication
        to: dw.dbo.FactMedicationHistory

  - name: dw.dbo.FactPersonMedicationHistory and dw.dbo.FactPersonMedicationStatus
    edges:
    # Load to DW
      - from: ods.clinical.PrimaryCareMedication
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonMedicationHistoryData
      - from: ods.clinical.MedicationMultiLexProduct
        via: mov.DwLoad
        to: ods.dw.usp_GetMedicationMappingData
      - from: ods.dw.usp_GetMedicationMappingData
        to: staging.MedicationMapping
      - from: staging.MedicationMapping
        to: staging.usp_LoadMedicationMapping
      - from: staging.usp_LoadMedicationMapping
        to: dw.ref.MedicationMapping
      - from: dw.ref.MedicationMapping
        to: dw.usp_LoadDimMedication
      - from: dw.usp_LoadDimMedication
        to: dw.dbo.DimMedication
      - from: ods.dw.usp_GetFactPersonMedicationHistoryData
        to: dw.staging.FactPersonMedicationHistory
      - from: dw.staging.FactPersonMedicationHistory
        to: dw.staging.usp_LoadFactPersonMedicationHistory
      - from: dw.staging.usp_LoadFactPersonMedicationHistory
        to: dw.FactPersonMedicationHistory
    # Foreign key relationships
      - from: dw.dbo.DimMedication
        to: dw.FactPersonMedicationHistory
    # Load FactPersonMedicationStatus
      - from: dw.FactPersonMedicationHistory
        to: dw.usp_LoadFactPersonMedicationStatus
      - from: dw.usp_LoadFactPersonMedicationStatus
        to: dw.dbo.FactPersonMedicationStatus

  - name: dw.dbo.FactPersonClinicalScreeningStatus
    edges:
    - from: Default Data
      via: ods
      to: ods.ref.MetricMeasurementCodeMapping
  # Load to DW
    - from: ods.ref.MetricMeasurementCodeMapping
      via: mov.DwLoad
      to: dw.usp_GetDimClinicalMeasurementData
    - from: ods.clinical.ReadCode
      via: mov.DwLoad
      to: dw.usp_GetDimClinicalMeasurementData
    - from: ods.clinical.ReadCodeHierarchy
      via: mov.DwLoad
      to: dw.usp_GetDimClinicalMeasurementData 
    - from: ods.HealthResourceGroup
      via: mov.DwLoad
      to: dw.usp_GetDimClinicalMeasurementData
    - from: ods.ref.MetricImmunisationMapping
      via: mov.DwLoad
      to: dw.usp_GetDimClinicalMeasurementData
    - from: ods.clinical.ImmunisationContent
      via: mov.DwLoad
      to: dw.usp_GetDimClinicalMeasurementData
    - from: dw.usp_GetDimClinicalMeasurementData
      to: dw.staging.DimClinicalMeasurement
    - from: dw.staging.DimClinicalMeasurement
      to: dw.staging.usp_LoadDimClinicalMeasurement
    - from: dw.staging.usp_LoadDimClinicalMeasurement
      to: dw.dbo.DimClinicalMeasurement
    - from: dw.dbo.DimClinicalMeasurement
      to: dw.usp_LoadFactPersonClinicalScreeningStatus
    - from: dw.dbo.FactPersonClinicalHistory
      to: dw.usp_LoadFactPersonClinicalScreeningStatus
    - from: dw.dbo.FactScreeningEligibilityHistory
      via: mov.DwLoad
      to: dw.usp_LoadFactPersonClinicalScreeningStatus
    - from: dw.dbo.DimScreeningEligibilityType
      via: mov.DwLoad
      to: dw.usp_LoadFactPersonClinicalScreeningStatus
    - from: dw.usp_LoadFactPersonClinicalScreeningStatus
      to: dw.dbo.FactPersonClinicalScreeningStatus
  # Foreign key relationships
    - from: dw.dbo.DimClinicalMeasurement
      to: dw.dbo.FactPersonClinicalScreeningStatus
    - from: dw.dbo.DimScreeningEligibilityType
      to: dw.dbo.FactPersonClinicalScreeningStatus  

  - name: dw.dbo.FactDrugAndAlcoholUsage
    edges:
  # Load drug and alcohol usage data from blob Footwork source
    - from: blob.footwork/footwork/reports/iwp/2.csv
      via: mov.DrugAndAlcoholUsage
      to: staging.footwork.DrugAndAlcoholUsage
  # Load to ods
    - from: staging.footwork.DrugAndAlcoholUsage
      to: footwork.usp_LoadDrugAndAlcoholUsageToOds
    - from: footwork.usp_LoadDrugAndAlcoholUsageToOds
      to: ods.clinical.DrugAndAlcoholUsage
  # Load to DW
    - from: ods.clinical.DrugAndAlcoholUsage
      to: ods.dw.usp_GetFactDrugAndAlcoholUsageData
    - from: ods.clinical.DrugAndAlcoholUsage
      to: ods.dw.usp_GetDimDrugData
    - from: ods.clinical.DrugAndAlcoholUsage
      to: ods.dw.usp_GetDimProgramData
    - from: ods.clinical.DrugAndAlcoholUsage
      to: ods.dw.usp_GetDimRiskData
    - from: ods.clinical.DrugAndAlcoholUsage
      to: ods.dw.usp_GetDimTeamData
    - from: ods.dw.usp_GetFactDrugAndAlcoholUsageData
      to: dw.staging.FactDrugAndAlcoholUsage
    - from: ods.dw.usp_GetDimDrugData
      to: dw.staging.DimDrug
    - from: ods.dw.usp_GetDimProgramData
      to: dw.staging.DimProgram
    - from: ods.dw.usp_GetDimRiskData
      to: dw.staging.DimRisk
    - from: ods.dw.usp_GetDimTeamData
      to: dw.staging.DimTeam
    - from: dw.staging.FactDrugAndAlcoholUsage
      to: dw.staging.usp_LoadFactDrugAndAlcoholUsage
    - from: dw.staging.DimDrug
      to: dw.staging.usp_LoadDimDrug
    - from: dw.staging.DimProgram
      to: dw.staging.usp_LoadDimProgram
    - from: dw.staging.DimRisk
      to: dw.staging.usp_LoadDimRisk
    - from: dw.staging.DimTeam
      to: dw.staging.usp_LoadDimTeam
    - from: dw.staging.usp_LoadFactDrugAndAlcoholUsage
      to: dw.dbo.FactDrugAndAlcoholUsage
    - from: dw.staging.usp_LoadDimDrug
      to: dw.dbo.DimDrug
    - from: dw.staging.usp_LoadDimProgram
      to: dw.dbo.DimProgram
    - from: dw.staging.usp_LoadDimRisk
      to: dw.dbo.DimRisk
    - from: dw.staging.usp_LoadDimTeam
      to: dw.dbo.DimTeam
  # Foreign key relationships
    - from: dw.dbo.DimDrug
      to: dw.dbo.FactDrugAndAlcoholUsage
    - from: dw.dbo.DimProgram
      to: dw.dbo.FactDrugAndAlcoholUsage
    - from: dw.dbo.DimRisk
      to: dw.dbo.FactDrugAndAlcoholUsage
    - from: dw.dbo.DimTeam
      to: dw.dbo.FactDrugAndAlcoholUsage

  - name: dw.dbo.FactSuperStatsDiagnosticWaitingTimes
    edges:
  # Load SuperStatsProviderRegionLookup
    - from: blob.superstats/SuperStatsProviderRegionLookup.csv
      via: mov.SuperStatsProviderRegionLookup
      to: staging.superstats.ProviderRegionLookup
    - from: staging.superstats.ProviderRegionLookup
      to: ods.superstats.usp_LoadProviderRegionLookupToOds
    - from: ods.superstats.usp_LoadProviderRegionLookupToOds
      to: ods.superstats.ProviderRegionLookup
  # Load Diagnostic Waiting Times
    - from: blob.superstats/DM01.csv
      via: mov.SuperStatsDwt
      to: staging.superstats.DiagnosticWaitingTimes
    - from: staging.superstats.DiagnosticWaitingTimes
      to: ods.superstats.usp_LoadDiagnosticWaitingTimesToOds
    - from: ods.superstats.usp_LoadDiagnosticWaitingTimesToOds
      to: ods.superstats.DiagnosticWaitingTimes
  # Load Diagnostic Test Mapping Data
    - from: Default Data
      via: ods
      to: ods.dw.DiagnosticTestMapping
  # Load Dim tables
    - from: ods.superstats.DiagnosticWaitingTimes
      to: ods.dw.usp_GetDimDiagnosticTestData
    - from: ods.dw.usp_GetDimDiagnosticTestData
      to: dw.staging.DimDiagnosticTest
    - from: dw.staging.DimDiagnosticTest
      to: dw.staging.usp_LoadDimDiagnosticTest
    - from: dw.staging.usp_LoadDimDiagnosticTest
      to: dw.dbo.DimDiagnosticTest
    - from: ods.superstats.DiagnosticWaitingTimes
      to: ods.dw.usp_GetDimSustainabilityAndTransformationPartnershipData
    - from: ods.dw.usp_GetDimSustainabilityAndTransformationPartnershipData
      to: dw.staging.DimSustainabilityAndTransformationPartnership
    - from: dw.staging.DimSustainabilityAndTransformationPartnership
      to: dw.staging.usp_LoadDimSustainabilityAndTransformationPartnership
    - from: dw.staging.usp_LoadDimSustainabilityAndTransformationPartnership
      to: dw.dbo.DimSustainabilityAndTransformationPartnership
    - from: ods.superstats.DiagnosticWaitingTimes
      to: ods.dw.usp_GetDimCommissioningRegionData
    - from: ods.dw.usp_GetDimCommissioningRegionData
      to: dw.staging.DimCommissioningRegion
    - from: dw.staging.DimCommissioningRegion
      to: dw.staging.usp_LoadDimCommissioningRegion
    - from: dw.staging.usp_LoadDimCommissioningRegion
      to: dw.dbo.DimCommissioningRegion
  # Load Fact
    - from: ods.superstats.ProviderRegionLookup
      to: ods.dw.usp_GetFactSuperStatsDiagnosticWaitingTimesData
    - from: ods.dw.DiagnosticTestMapping
      to: ods.dw.usp_GetFactSuperStatsDiagnosticWaitingTimesData  
    - from: ods.superstats.DiagnosticWaitingTimes
      to: ods.dw.usp_GetFactSuperStatsDiagnosticWaitingTimesData
    - from: ods.dw.usp_GetFactSuperStatsDiagnosticWaitingTimesData
      to: dw.staging.FactSuperStatsDiagnosticWaitingTimes
    - from: dw.staging.FactSuperStatsDiagnosticWaitingTimes
      to: dw.staging.usp_LoadFactSuperStatsDiagnosticWaitingTimes
    - from: dw.staging.usp_LoadFactSuperStatsDiagnosticWaitingTimes
      to: dw.dbo.FactSuperStatsDiagnosticWaitingTimes
  # Foreign key relationships
    - from: dw.dbo.DimDiagnosticTest
      to: dw.dbo.FactSuperStatsDiagnosticWaitingTimes
    - from: dw.dbo.DimSustainabilityAndTransformationPartnership
      to: dw.dbo.FactSuperStatsDiagnosticWaitingTimes
    - from: dw.dbo.DimCommissioningRegion
      to: dw.dbo.FactSuperStatsDiagnosticWaitingTimes

  - name: dw.dbo.FactTheograph
    edges:
  # Load FactTheograph data from DW
    - from: Default Data
      via: ods
      to: ods.dw.TheographActivityLookup
    - from: ods.phmSus.Inpatient
      via: mov.DwLoad
      to: ods.dw.usp_GetFactTheographData
    - from: ods.phmsus.Outpatient
      via: mov.DwLoad
      to: ods.dw.usp_GetFactTheographData
    - from: ods.clinical.Appointment
      via: mov.DwLoad
      to: ods.dw.usp_GetFactTheographData
    - from: Default Data
      via: ods
      to: ods.dw.PointOfDeliveryLookup
    - from: ods.dw.PointOfDeliveryLookup
      via: mov.DwLoad
      to: ods.dw.usp_GetFactTheographData
    - from: ods.ref.MetricMeasurementCodeMapping
      via: mov.DwLoad
      to: ods.dw.usp_GetFactTheographData
    - from: ods.clinical.ReadCodeHierarchy
      via: mov.DwLoad
      to: ods.dw.usp_GetFactTheographData
    - from: ods.clinical.ReadCode
      via: mov.DwLoad
      to: ods.dw.usp_GetFactTheographData
    - from: ods.clinical.PersonReadCode
      via: mov.DwLoad
      to: ods.dw.usp_GetFactTheographData
    - from: ods.dw.usp_GetFactTheographData
      to: dw.staging.FactTheograph
    - from: dw.staging.FactTheograph
      to: dw.staging.usp_LoadFactTheograph
    - from: dw.staging.usp_LoadFactTheograph
      to: dw.dbo.FactTheograph
  # Load Dim Tables
    - from: ods.dw.PointOfDeliveryLookup
      via: mov.DwLoad
      to: ods.dw.usp_GetDimPointOfDeliveryData
    - from: ods.dw.usp_GetDimPointOfDeliveryData
      to: dw.staging.DimPointOfDelivery
    - from: dw.staging.DimPointOfDelivery
      to: dw.staging.usp_LoadDimPointOfDelivery
    - from: dw.staging.usp_LoadDimPointOfDelivery
      to: dw.dbo.DimPointOfDelivery
    - from: ods.ref.MetricMeasurementCodeMapping
      via: mov.DwLoad
      to: ods.dw.usp_GetDimTheographActivityData
    - from: ods.clinical.ReadCodeHierarchy
      via: mov.DwLoad
      to: ods.dw.usp_GetDimTheographActivityData
    - from: ods.clinical.ReadCode
      via: mov.DwLoad
      to: ods.dw.usp_GetDimTheographActivityData
    - from: ods.phmsus.Inpatient
      via: mov.DwLoad
      to: ods.dw.usp_GetDimTheographActivityData
    - from: ods.phmsus.Outpatient
      via: mov.DwLoad
      to: ods.dw.usp_GetDimTheographActivityData
    - from: ods.HealthResourceGroup
      via: mov.DwLoad
      to: ods.dw.usp_GetDimTheographActivityData
    - from: ods.phmsus.AccidentAndEmergency
      via: mov.DwLoad
      to: ods.dw.usp_GetDimTheographActivityData
    - from: ods.dw.TheographActivityLookup
      via: mov.DwLoad
      to: ods.dw.usp_GetDimTheographActivityData
    - from: ods.dw.usp_GetDimTheographActivityData
      to: dw.staging.DimTheographActivity
    - from: dw.staging.DimTheographActivity
      to: dw.staging.usp_LoadDimTheographActivity
    - from: dw.staging.usp_LoadDimTheographActivity
      to: dw.dbo.DimTheographActivity
  # Foreign key relationships
    - from: dw.dbo.DimPointOfDelivery
      to: dw.dbo.FactTheograph
    - from: dw.dbo.DimTheographActivity
      to: dw.dbo.FactTheograph

  - name: performance.spc.vw_StatisticalProcessChart
    edges:
   # Load StatisticalProcessChartMetricValues
    - from: Blob.diis/StatisticalProcessChart/StatisticalProcessChartMetricValues.csv
      via: mov.StatisticalProcessChart
      to: staging.spc.StatisticalProcessChartMetricValues
    - from: staging.spc.StatisticalProcessChartMetricValues
      to: ods.spc.usp_LoadStatisticalProcessChartMetricValuesToOds
    - from: ods.spc.usp_LoadStatisticalProcessChartMetricValuesToOds
      to: ods.spc.StatisticalProcessChartMetricValues
    - from: ods.spc.StatisticalProcessChartMetricValues
      to: performance.usp_GetStatisticalProcessChartMetricValuesData
    - from: performance.usp_GetStatisticalProcessChartMetricValuesData
      to: performance.staging.StatisticalProcessChartMetricValues
    - from: performance.staging.StatisticalProcessChartMetricValues
      to: performance.staging.usp_LoadStatisticalProcessChartMetricValues
  # Load StatisticalProcessChartTargetValues
    - from: Blob.diis/StatisticalProcessChart/StatisticalProcessChartTargetValues.csv
      via: mov.StatisticalProcessChart
      to: staging.spc.StatisticalProcessChartTargetValues
    - from: staging.spc.StatisticalProcessChartTargetValues
      to: ods.spc.usp_LoadStatisticalProcessChartTargetValuesToOds
    - from: ods.spc.usp_LoadStatisticalProcessChartTargetValuesToOds
      to: ods.spc.StatisticalProcessChartTargetValues
    - from: ods.spc.StatisticalProcessChartTargetValues
      to: performance.usp_GetStatisticalProcessChartTargetValuesData
    - from: performance.usp_GetStatisticalProcessChartTargetValuesData
      to: performance.staging.StatisticalProcessChartTargetValues
    - from: performance.staging.StatisticalProcessChartTargetValues
      to: performance.staging.usp_LoadStatisticalProcessChartTargetValues
  # Load StatisticalProcessChartRawData
    - from: Blob.diis/StatisticalProcessChart/StatisticalProcessChartRawData.csv
      via: mov.StatisticalProcessChart
      to: staging.spc.StatisticalProcessChartRawData
    - from: staging.spc.StatisticalProcessChartRawData
      to: ods.spc.usp_LoadStatisticalProcessChartRawDataToOds
    - from: ods.spc.usp_LoadStatisticalProcessChartRawDataToOds
      to: ods.spc.StatisticalProcessChartRawData
    - from: ods.spc.StatisticalProcessChartRawData
      to: performance.usp_GetStatisticalProcessChartRawData
    - from: performance.usp_GetStatisticalProcessChartRawData
      to: performance.staging.StatisticalProcessChartRawData
    - from: performance.staging.StatisticalProcessChartRawData
      to: performance.staging.usp_LoadStatisticalProcessChartRawData
  # Final loads
    - from: performance.staging.usp_LoadStatisticalProcessChartMetricValues
      to: performance.spc.StatisticalProcessChartMetricValues
    - from: performance.spc.StatisticalProcessChartMetricValues
      to: performance.spc.dbo.vw_StatisticalProcessChart
    - from: performance.staging.usp_LoadStatisticalProcessChartTargetValues
      to: performance.spc.StatisticalProcessChartTargetValues
    - from: performance.spc.StatisticalProcessChartTargetValues
      to: performance.spc.dbo.vw_StatisticalProcessChart
    - from: performance.staging.usp_LoadStatisticalProcessChartRawData
      to: performance.spc.StatisticalProcessChartRawData
    - from: performance.spc.StatisticalProcessChartRawData
      to: performance.spc.usp_LoadRawData
    - from: performance.spc.RawData
      to: performance.spc.usp_LoadStatisticalProcessChart
    - from: performance.spc.usp_LoadStatisticalProcessChart
  # vw_StatisticalProcessChart uses dbo to enable final lineage to be shown
      to: performance.spc.dbo.vw_StatisticalProcessChart

  - name: dw.dbo.BridgePrimaryCareAppointmentReason
    edges:
  # Load Bridge Primary Care Appointment Reason data to DW
    - from: ods.clinical.Appointment
      via: mov.DwLoad
      to: ods.dw.usp_GetBridgePrimaryCareAppointmentReasonData
    - from: ods.clinical.PersonReadCode
      via: mov.DwLoad
      to: ods.dw.usp_GetBridgePrimaryCareAppointmentReasonData
    - from: ods.clinical.ReadCode
      via: mov.DwLoad
      to: ods.dw.usp_GetBridgePrimaryCareAppointmentReasonData
    - from: ods.clinical.ReadCode
      via: mov.DwLoad
      to: ods.dw.usp_GetDimAppointmentReasonData
    - from: ods.dw.AppointmentReasonLookup
      via: mov.DwLoad
      to: ods.dw.usp_GetBridgePrimaryCareAppointmentReasonData
    - from: Default Data
      via: ods
      to: ods.dw.AppointmentReasonLookup
    - from: ods.dw.AppointmentReasonLookup
      via: mov.DwLoad
      to: ods.dw.usp_GetDimAppointmentReasonData
    - from: ods.dw.usp_GetBridgePrimaryCareAppointmentReasonData
      to: dw.staging.BridgePrimaryCareAppointmentReason
    - from: ods.dw.usp_GetDimAppointmentReasonData
      to: dw.staging.DimAppointmentReason
    - from: dw.staging.DimAppointmentReason
      to: dw.staging.usp_LoadDimAppointmentReason
    - from: dw.staging.usp_LoadDimAppointmentReason
      to: dw.dbo.DimAppointmentReason
    - from: dw.staging.BridgePrimaryCareAppointmentReason
      to: dw.staging.usp_LoadBridgePrimaryCareAppointmentReason
    - from: dw.staging.usp_LoadBridgePrimaryCareAppointmentReason
      to: dw.dbo.BridgePrimaryCareAppointmentReason
  # Foreign key relationships
    - from: dw.dbo.DimAppointmentReason
      to: dw.dbo.BridgePrimaryCareAppointmentReason

  - name: dw.dbo.FactRiskStratificationPopulation
    edges:
  # Load Mortality Risk Stratification
    - from: Blob.datascience/risk strat/MortalityRiskStrat/Mortality_risk.csv
      via: mov.RiskStratPopulationMortality
      to: staging.datascience.RiskStratificationMortality
    - from: staging.datascience.RiskStratificationMortality
      to: ods.datascience.usp_LoadRiskStratificationMortalityToOds
    - from: ods.datascience.usp_LoadRiskStratificationMortalityToOds
      to: ods.datascience.RiskStratificationMortality
  # Load Falls Risk Stratification
    - from: blob.datascience/risk strat/FallsRiskStrat/Falls_risk.csv
      via: mov.RiskStratPopulationFalls
      to: staging.datascience.RiskStratificationFalls
    - from: staging.datascience.RiskStratificationFalls
      to: ods.datascience.usp_LoadRiskStratificationFallsToOds
    - from: ods.datascience.usp_LoadRiskStratificationFallsToOds
      to: ods.datascience.RiskStratificationFalls
  # Load Frailty Risk Stratification
    - from: blob.datascience/risk strat/FrailtyRiskStrat/Frailty_risk.csv
      via: mov.RiskStratPopulationFrailty
      to: staging.datascience.RiskStratificationFrailty
    - from: staging.datascience.RiskStratificationFrailty
      to: ods.datascience.usp_LoadRiskStratificationFrailtyToOds
    - from: ods.datascience.usp_LoadRiskStratificationFrailtyToOds
      to: ods.datascience.RiskStratificationFrailty
  # Load to DW
    - from: ods.datascience.RiskStratificationMortality
      to: ods.dw.usp_GetFactRiskStratificationPopulationData
    - from: ods.datascience.RiskStratificationFalls
      to: ods.dw.usp_GetFactRiskStratificationPopulationData
    - from: ods.datascience.RiskStratificationFrailty
      to: ods.dw.usp_GetFactRiskStratificationPopulationData
    - from: ods.datascience.RiskStratificationMortality
      to: ods.dw.usp_GetDimRiskStratificationCategoryData
    - from: ods.datascience.RiskStratificationFalls
      to: ods.dw.usp_GetDimRiskStratificationCategoryData
    - from: ods.datascience.RiskStratificationFrailty
      to: ods.dw.usp_GetDimRiskStratificationCategoryData
    - from: ods.dw.usp_GetFactRiskStratificationPopulationData
      to: dw.staging.FactRiskStratificationPopulation
    - from: ods.dw.usp_GetDimRiskStratificationCategoryData
      to: dw.staging.DimRiskStratificationCategory
    - from: dw.staging.FactRiskStratificationPopulation
      to: dw.staging.usp_LoadFactRiskStratificationPopulation
    - from: dw.staging.DimRiskStratificationCategory
      to: dw.staging.usp_LoadDimRiskStratificationCategory
    - from: dw.staging.usp_LoadFactRiskStratificationPopulation
      to: dw.dbo.FactRiskStratificationPopulation
    - from: dw.staging.usp_LoadDimRiskStratificationCategory
      to: dw.dbo.DimRiskStratificationCategory
  # Foreign key relationships
    - from: dw.dbo.DimRiskStratificationCategory
      to: dw.dbo.FactRiskStratificationPopulation

  - name: dw.dbo.FactPersonClinicalStatus
    edges:
      # Load FactPersonClinicalStatus data to DW
    - from: Default Data
      via: ods
      to: ods.dw.DimFluEligibility
    - from: ods.clinical.PersonFrailty
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonClinicalStatusData
    - from: ods.dw.DimFluEligibility
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonClinicalStatusData
    - from: dw.dbo.DimClinicalMeasurement
      via: mov.DwLoad
      to: dw.usp_LoadDimFrailtyAssessment
    - from: dw.dbo.DimClinicalMeasurement
      via: mov.DwLoad
      to: dw.usp_LoadDimMrcBreathlessnessScale
    - from: Default Data
      via: dw
      to: dw.dbo.DimFevScore
    - from: Default Data
      via: dw
      to: dw.dbo.DimSmokingStatus
    - from: Default Data
      via: dw
      to: dw.dbo.DimDoseIndex
    - from: Default Data
      via: dw
      to: dw.dbo.DimPeakExpiratoryFlow
    - from: Default Data
      via: dw
      to: dw.dbo.DimIncontinenceLevel
    - from: Default Data
      via: dw
      to: dw.dbo.DimGsfPrognosticIndicatorStage
    - from: Default Data
      via: dw
      to: dw.dbo.DimWeightMeasurementCategory
    - from: ods.dw.DimFluEligibility
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonClinicalStatusData
    - from: ods.clinical.PersonFrailty
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonClinicalStatusData
    - from: ods.dw.usp_GetFactPersonClinicalStatusData
      to: dw.staging.FactPersonClinicalStatus
    - from: dw.staging.FactPersonClinicalStatus
      to: dw.usp_LoadFactPersonClinicalStatus
    - from: dw.dbo.DimClinicalMeasurement
      to: dw.usp_LoadFactPersonClinicalStatus
    - from: dw.dbo.FactPersonConditionHistory
      to: dw.usp_LoadFactPersonClinicalStatus
    - from: dw.dbo.FactPersonClinicalHistory
      to: dw.usp_LoadFactPersonClinicalStatus
    - from: dw.dbo.DimFevScore
      to: dw.usp_LoadFactPersonClinicalStatus
    - from: dw.dbo.DimSmokingStatus
      to: dw.usp_LoadFactPersonClinicalStatus
    - from: dw.dbo.DimDoseIndex
      to: dw.usp_LoadFactPersonClinicalStatus
    - from: dw.dbo.DimPeakExpiratoryFlow
      to: dw.usp_LoadFactPersonClinicalStatus
    - from: dw.dbo.DimIncontinenceLevel
      to: dw.usp_LoadFactPersonClinicalStatus
    - from: dw.dbo.DimGsfPrognosticIndicatorStage
      to: dw.usp_LoadFactPersonClinicalStatus
    - from: dw.dbo.DimWeightMeasurementCategory
      to: dw.usp_LoadFactPersonClinicalStatus
    - from: dw.usp_LoadFactPersonClinicalStatus
      to: dw.dbo.FactPersonClinicalStatus
    - from: dw.dbo.DimClinicalMeasurement
      to: dw.usp_LoadDimFallRisk
    - from: dw.usp_LoadDimFallRisk
      to: dw.dbo.DimFallRisk
    - from: dw.dbo.DimClinicalMeasurement
      to: dw.usp_LoadDimCopdSeverity
    - from: dw.usp_LoadDimCopdSeverity
      to: dw.dbo.DimCopdSeverity
    - from: dw.usp_LoadDimFrailtyAssessment
      to: dw.dbo.DimFrailtyAssessment
    - from: dw.usp_LoadDimMrcBreathlessnessScale
      to: dw.dbo.DimMrcBreathlessnessScale
  # Foreign key relationships
    - from: dw.dbo.DimFrailtyAssessment
      to: dw.dbo.FactPersonClinicalStatus
    - from: dw.dbo.DimMrcBreathlessnessScale
      to: dw.dbo.FactPersonClinicalStatus
    - from: dw.dbo.DimCopdSeverity
      to: dw.dbo.FactPersonClinicalStatus
    - from: dw.dbo.DimSmokingStatus
      to: dw.dbo.FactPersonClinicalStatus
    - from: dw.dbo.DimDoseIndex
      to: dw.dbo.FactPersonClinicalStatus
    - from: dw.dbo.DimFallRisk
      to: dw.dbo.FactPersonClinicalStatus
    - from: dw.dbo.DimPeakExpiratoryFlow
      to: dw.dbo.FactPersonClinicalStatus
    - from: dw.dbo.DimIncontinenceLevel
      to: dw.dbo.FactPersonClinicalStatus
    - from: dw.dbo.DimGsfPrognosticIndicatorStage
      to: dw.dbo.FactPersonClinicalStatus
    - from: dw.dbo.DimWeightMeasurementCategory
      to: dw.dbo.FactPersonClinicalStatus
     
  - name: dw.dbo.FactPersonPerformanceHistory
    edges:
      # Load to DW
    - from: ods.ref.MetricMeasurementCodeMapping
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonPerformanceHistoryData
    - from: ods.clinical.ReadCodeHierarchy
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonPerformanceHistoryData
    - from: ods.clinical.ReadCode
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonPerformanceHistoryData
    - from: ods.ref.MetricClusterIdMapping
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonPerformanceHistoryData
    - from: ods.clinical.ClusterReadCode
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonPerformanceHistoryData
    - from: ods.clinical.PersonReadCode
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonPerformanceHistoryData
    - from: ods.clinical.StaffMemberProfile
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonPerformanceHistoryData
    - from: ods.dw.usp_GetFactPersonPerformanceHistoryData
      to: dw.staging.FactPersonPerformanceHistory
    - from: dw.staging.FactPersonPerformanceHistory
      to: dw.staging.usp_LoadFactPersonPerformanceHistory
    - from: dw.dbo.DimPerformanceMeasurement
      to: dw.staging.usp_LoadFactPersonPerformanceHistory
    - from: dw.staging.usp_LoadFactPersonPerformanceHistory
      to: dw.dbo.FactPersonPerformanceHistory
  # Foreign key relationships
    - from: dw.dbo.DimPerformanceMeasurement
      to: dw.dbo.FactPersonPerformanceHistory

  - name: dw.dbo.FactMymHealthSymptomScore
    edges:
  # Load to DW
    - from: ods.mym.SymptomScore
      via: mov.DwLoad 
      to: ods.dw.usp_GetFactMymHealthSymptomScoreData
    - from: ods.dw.usp_GetFactMymHealthSymptomScoreData
      to: dw.staging.FactMymHealthSymptomScore
    - from: dw.staging.FactMymHealthSymptomScore
      to: dw.staging.usp_LoadFactMymHealthSymptomScore
    - from: dw.staging.usp_LoadFactMymHealthSymptomScore
      to: dw.dbo.FactMymHealthSymptomScore

    - name: dw.dbo.FactMymHealthWatchedVideo
    edges:
  # Load to DW
    - from: ods.mym.WatchedVideo
      via: mov.DwLoad
      to: ods.dw.usp_GetFactMymHealthWatchedVideoData
    - from: ods.mym.WatchedVideo
      via: mov.DwLoad
      to: ods.dw.usp_GetDimMymHealthVideoData
    - from: ods.dw.usp_GetFactMymHealthWatchedVideoData
      to: dw.staging.FactMymHealthWatchedVideo
    - from: dw.staging.FactMymHealthWatchedVideo
      to: dw.staging.usp_LoadFactMymHealthWatchedVideo
    - from: dw.staging.usp_LoadFactMymHealthWatchedVideo
      to: dw.dbo.FactMymHealthWatchedVideo
    - from: ods.dw.usp_GetDimMymHealthVideoData
      to: dw.staging.DimMymHealthVideo
    - from: dw.staging.DimMymHealthVideo
      to: dw.staging.usp_LoadDimMymHealthVideo
    - from: dw.staging.usp_LoadDimMymHealthVideo
      to: dw.dbo.DimMymHealthVideo
  # Foreign key relationships
    - from: dw.dbo.DimMymHealthVideo
      to: dw.dbo.FactMymHealthWatchedVideo

  - name: dw.dbo.FactMymHealthCopdAssessmentTestScore
    edges:
  # Load to DW
    - from: ods.mym.CopdAssessmentTestScore
      via: mov.DwLoad
      to: ods.dw.usp_GetFactMymHealthCopdAssessmentTestScoreData
    - from: ods.dw.usp_GetFactMymHealthCopdAssessmentTestScoreData
      to: dw.staging.FactMymHealthCopdAssessmentTestScore
    - from: dw.staging.FactMymHealthCopdAssessmentTestScore
      to: dw.staging.usp_LoadFactMymHealthCopdAssessmentTestScore
    - from: dw.staging.usp_LoadFactMymHealthCopdAssessmentTestScore
      to: dw.dbo.FactMymHealthCopdAssessmentTestScore

  - name: dw.dbo.FactMymHealthTileClick
    edges:
  # Load to DW
    - from: ods.mym.TileClick
      via: mov.DwLoad
      to: ods.dw.usp_GetFactMymHealthTileClickData
    - from: ods.mym.TileClick
      via: mov.DwLoad
      to: ods.dw.usp_GetDimMymHealthTileData
    - from: ods.dw.usp_GetFactMymHealthTileClickData
      to: dw.staging.FactMymHealthTileClick
    - from: dw.staging.FactMymHealthTileClick
      to: dw.staging.usp_LoadFactMymHealthTileClick
    - from: dw.staging.usp_LoadFactMymHealthTileClick
      to: dw.dbo.FactMymHealthTileClick
    - from: ods.dw.usp_GetDimMymHealthTileData
      to: dw.staging.DimMymHealthTile
    - from: dw.staging.DimMymHealthTile
      to: dw.staging.usp_LoadDimMymHealthTile
    - from: dw.staging.usp_LoadDimMymHealthTile
      to: dw.dbo.DimMymHealthTile
  # Foreign key relationships
    - from: dw.dbo.DimMymHealthTile
      to: dw.dbo.FactMymHealthTileClick

  - name: dw.dbo.FactMymHealthSmokingStatus
    edges:
  # Load to DW
    - from: ods.mym.SmokingStatus
      via: mov.DwLoad
      to: ods.dw.usp_GetFactMymHealthSmokingStatusData
    - from: ods.mym.SmokingStatus
      via: mov.DwLoad
      to: ods.dw.usp_GetDimMymHealthSmokingStatusData
    - from: ods.mym.SmokingStatus
      via: mov.DwLoad
      to: ods.dw.usp_GetDimMymHealthSmokingTypeData
    - from: ods.dw.usp_GetFactMymHealthSmokingStatusData
      to: dw.staging.FactMymHealthSmokingStatus
    - from: dw.staging.FactMymHealthSmokingStatus
      to: dw.staging.usp_LoadFactMymHealthSmokingStatus
    - from: dw.staging.usp_LoadFactMymHealthSmokingStatus
      to: dw.dbo.FactMymHealthSmokingStatus
    - from: ods.dw.usp_GetDimMymHealthSmokingStatusData
      to: dw.staging.DimMymHealthSmokingStatus
    - from: dw.staging.DimMymHealthSmokingStatus
      to: dw.staging.usp_LoadDimMymHealthSmokingStatus
    - from: dw.staging.usp_LoadDimMymHealthSmokingStatus
      to: dw.dbo.DimMymHealthSmokingStatus
    - from: ods.dw.usp_GetDimMymHealthSmokingTypeData
      to: dw.staging.DimMymHealthSmokingType
    - from: dw.staging.DimMymHealthSmokingType
      to: dw.staging.usp_LoadDimMymHealthSmokingType
    - from: dw.staging.usp_LoadDimMymHealthSmokingType
      to: dw.dbo.DimMymHealthSmokingType
  # Foreign key relationships
    - from: dw.dbo.DimMymHealthSmokingStatus
      to: dw.dbo.FactMymHealthSmokingStatus
    - from: dw.dbo.DimMymHealthSmokingType
      to: dw.dbo.FactMymHealthSmokingStatus

  - name: dw.dbo.FactMymHealthAppActivation
    edges:
  # Load to DW
    - from: ods.mym.AppActivation
      via: mov.DwLoad
      to: ods.dw.usp_GetFactMymHealthAppActivationData
    - from: ods.dw.usp_GetFactMymHealthAppActivationData
      to: dw.staging.FactMymHealthAppActivation
    - from: dw.staging.FactMymHealthAppActivation
      to: dw.staging.usp_LoadFactMymHealthAppActivation
    - from: dw.staging.usp_LoadFactMymHealthAppActivation
      to: dw.dbo.FactMymHealthAppActivation

  - name: dw.dbo.FactMymHealthAppRegistration
    edges:
  # Load to DW
    - from: ods.mym.AppRegistration
      via: mov.DwLoad
      to: ods.dw.usp_GetFactMymHealthAppRegistrationData
    - from: ods.dw.usp_GetFactMymHealthAppRegistrationData
      to: dw.staging.FactMymHealthAppRegistration
    - from: dw.staging.FactMymHealthAppRegistration
      to: dw.staging.usp_LoadFactMymHealthAppRegistration
    - from: dw.staging.usp_LoadFactMymHealthAppRegistration
      to: dw.dbo.FactMymHealthAppRegistration

  - name: dw.dbo.FactMymHealthCopdExacerbation
    edges:
  # Load to DW
    - from: ods.mym.CopdExacerbation
      via: mov.DwLoad
      to: ods.dw.usp_GetFactMymHealthCopdExacerbationData
    - from: ods.dw.usp_GetFactMymHealthCopdExacerbationData
      to: dw.staging.FactMymHealthCopdExacerbation
    - from: dw.staging.FactMymHealthCopdExacerbation
      to: dw.staging.usp_LoadFactMymHealthCopdExacerbation
    - from: dw.staging.usp_LoadFactMymHealthCopdExacerbation
      to: dw.dbo.FactMymHealthCopdExacerbation

  - name: dw.dbo.FactMymHealthFluVaccination
    edges:
  # Load to DW
    - from: ods.mym.FluVaccination
      via: mov.DwLoad
      to: ods.dw.usp_GetFactMymHealthFluVaccinationData
    - from: ods.dw.usp_GetFactMymHealthFluVaccinationData
      to: dw.staging.FactMymHealthFluVaccination
    - from: dw.staging.FactMymHealthFluVaccination
      to: dw.staging.usp_LoadFactMymHealthFluVaccination
    - from: dw.staging.usp_LoadFactMymHealthFluVaccination
      to: dw.dbo.FactMymHealthFluVaccination

  - name: dw.dbo.FactMymHealthAsthmaControlTestScore
    edges:
  # Load to DW
    - from: ods.mym.AsthmaControlTestScore
      via: mov.DwLoad
      to: ods.dw.usp_GetFactMymHealthAsthmaControlTestScoreData
    - from: ods.dw.usp_GetFactMymHealthAsthmaControlTestScoreData
      to: dw.staging.FactMymHealthAsthmaControlTestScore
    - from: dw.staging.FactMymHealthAsthmaControlTestScore
      to: dw.staging.usp_LoadFactMymHealthAsthmaControlTestScore
    - from: dw.staging.usp_LoadFactMymHealthAsthmaControlTestScore
      to: dw.dbo.FactMymHealthAsthmaControlTestScore

  - name: dw.dbo.DimGpSurgery
    edges:
  # Load to ods
    - from: blob.diis/Lookup/gp-reg-pat-prac-map.csv
      via: mov.GpSurgery
      to: staging.ref.GpSurgery
    - from: blob.diis/Lookup/GpSurgeryDetail.csv
      via: mov.GpSurgery
      to: staging.ref.GpSurgeryDetail
    - from: blob.diis/Lookup/DimWessexGPLDS.csv
      via: mov.GpSurgeryLocalDeliverySystem
      to: staging.ref.LookupGpLocalDeliverySystem
    - from: Default Data
      via: ods
      to: ods.ref.WarehouseCommissioner
    - from: staging.ref.GpSurgery
      to: staging.ref.usp_LoadGpSurgeryToOds
    - from: staging.ref.GpSurgeryDetail
      to: staging.ref.usp_LoadGpSurgeryDetailToOds
    - from: staging.ref.usp_LoadGpSurgeryDetailToOds
      to: ods.ref.GpSurgeryDetail
    - from: ods.ref.GpSurgeryDetail
      to: staging.ref.usp_LoadGpSurgeryToOds
    - from: staging.ref.usp_LoadGpSurgeryToOds
      to: ods.GpSurgery
    - from: staging.ref.LookupGpLocalDeliverySystem
      to: staging.ref.usp_LoadLookupGpLocalDeliverySystemToOds
    - from: staging.ref.usp_LoadLookupGpLocalDeliverySystemToOds
      to: ods.ref.LookupGpLocalDeliverySystem
  # Load to DW
    - from: ods.Partner
      via: mov.DwLoad
      to: ods.dw.usp_GetDimGpSurgeryData
    - from: ods.Organisation
      via: mov.DwLoad
      to: ods.dw.usp_GetDimGpSurgeryData
    - from: ods.GpSurgery
      via: mov.DwLoad
      to: ods.dw.usp_GetDimGpSurgeryData
    - from: ods.clinical.PersonOrganisationRegistration
      via: mov.DwLoad
      to: ods.dw.usp_GetDimGpSurgeryData
    - from: ods.ref.LookupGpLocalDeliverySystem
      via: mov.DwLoad
      to: ods.dw.usp_GetDimGpSurgeryData
    - from: ods.ref.WarehouseCommissioner
      via: mov.DwLoad
      to: ods.dw.usp_GetDimGpSurgeryData
    - from: ods.dw.usp_GetDimGpSurgeryData
      to: dw.staging.DimGpSurgery
    - from: dw.staging.DimGpSurgery
      to: dw.staging.usp_LoadDimGpSurgery
  # Remove dbo here to enable the views below to be created from dbo.DimGpSurgery
      to: dw.DimGpSurgery
  # View for splitting GpSurgery and WessexGpSurgery
    - from: dw.DimGpSurgery
      to: dw.dbo.vw_DimGpSurgery
    - from: dw.DimGpSurgery
      to: dw.dbo.vw_DimWessexGpSurgery
  # Relationship to show them on same chart
    - from: dw.dbo.vw_DimGpSurgery
      to: dw.DimGpSurgery
    - from: dw.dbo.vw_DimWessexGpSurgery
      to: dw.DimGpSurgery

  - name: dw.dbo.FactPersonSocialHistory
    edges:
  # Load to DW
    - from: ods.ref.MetricMeasurementCodeMapping
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonSocialHistoryData
    - from: ods.clinical.ReadCodeHierarchy
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonSocialHistoryData
    - from: ods.clinical.ReadCode
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonSocialHistoryData
    - from: ods.ref.MetricClusterIdMapping
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonSocialHistoryData
    - from: ods.clinical.ClusterReadCode
      via: mov.DwLoad
      to: ods.dw.usp_GetFactPersonSocialHistoryData
    - from: ods.dw.usp_GetFactPersonSocialHistoryData
      to: dw.staging.FactPersonSocialHistory
    - from: dw.staging.FactPersonSocialHistory
      to: dw.staging.usp_LoadFactPersonSocialHistory
    - from: dw.dbo.DimSocialMeasurement
      to: dw.dbo.usp_LoadFactPersonSocialHistory
    - from: dw.staging.usp_LoadFactPersonSocialHistory
      to: dw.dbo.FactPersonSocialHistory
  # Foreign key relationships
    - from: dw.dbo.DimSocialMeasurement
      to: dw.dbo.FactPersonSocialHistory

  - name: dw.dbo.FactIaptLongTermCondition
    edges:
  # Load to ods
    - from: blob.dhc/iaptus/Timestamp/long_term_conditions.csv
      via: mov.Iaptus
      to: staging.acute.DhcIaptusLongTermCondition
    - from: staging.acute.DhcIaptusLongTermCondition
      to: acute.usp_LoadDhcIaptLongTermConditionToOds
    - from: ods.acute.usp_LoadDhcIaptLongTermConditionToOds
      to: ods.clinical.IaptLongTermCondition
  # Load to DW
    - from: ods.clinical.IaptLongTermCondition
      to: ods.dw.usp_GetFactIaptLongTermConditionData
    - from: ods.clinical.IaptLongTermCondition
      to: ods.dw.usp_GetDimLongTermConditionData
    - from: ods.dw.usp_GetFactIaptLongTermConditionData
      to: dw.staging.FactIaptLongTermCondition
    - from: ods.dw.usp_GetDimLongTermConditionData
      to: dw.staging.DimLongTermCondition
    - from: dw.staging.DimLongTermCondition
      to: dw.staging.usp_LoadDimLongTermCondition
    - from: dw.staging.usp_LoadDimLongTermCondition
      to: dw.dbo.DimLongTermCondition
    - from: dw.staging.FactIaptLongTermCondition
      to: dw.staging.usp_LoadFactIaptLongTermCondition
    - from: dw.staging.DimLongTermCondition
      to: dw.staging.usp_LoadFactIaptLongTermCondition
    - from: dw.staging.usp_LoadFactIaptLongTermCondition
      to: dw.dbo.FactIaptLongTermCondition
  # Foreign key relationships
    - from: dw.dbo.DimLongTermCondition
      to: dw.dbo.FactIaptLongTermCondition

  - name: IaptLoad
    edges:
    # Load to ods
    - from: blob.dhc/iaptus/Timestamp/long_term_conditions.csv
      via: mov.Iaptus
      to: staging.acute.DhcIaptusDisability
    - from: staging.acute.DhcIaptusDisability
      to: staging.acute.usp_LoadDhcIaptDisabilityToOds
    - from: staging.acute.usp_LoadDhcIaptDisabilityToOds
      to: ods.clinical.IaptDisability
    - from: blob.dhc/iaptus/Timestamp/sessions.csv
      via: mov.Iaptus
      to: staging.acute.DhcIaptusSession
    - from: staging.acute.DhcIaptusSession
      to: staging.acute.usp_LoadDhcIaptSessionToOds
    - from: staging.acute.usp_LoadDhcIaptSessionToOds
      to: ods.clinical.IaptSession

  - name: dw.dbo.FactIaptDisability
    edges:
  # Load to DW
    - from: ods.clinical.IaptDisability
      to: ods.dw.usp_GetFactIaptDisabilityData
    - from: ods.clinical.IaptDisability
      to: ods.dw.usp_GetDimDisabilityData
    - from: ods.dw.usp_GetFactIaptDisabilityData
      to: dw.staging.FactIaptDisability
    - from: ods.dw.usp_GetDimDisabilityData
      to: dw.staging.DimDisability
    - from: dw.staging.DimDisability
      to: dw.staging.usp_LoadDimDisability
    - from: dw.staging.usp_LoadDimDisability
      to: dw.dbo.DimDisability
    - from: dw.staging.FactIaptDisability
      to: dw.staging.usp_LoadFactIaptDisability
    - from: dw.staging.DimDisability
      to: dw.staging.usp_LoadFactIaptDisability
    - from: dw.staging.usp_LoadFactIaptDisability
      to: dw.dbo.FactIaptDisability
  # Foreign key relationships
    - from: dw.dbo.DimDisability
      to: dw.dbo.FactIaptDisability

  - name: dw.dbo.FactRiskStratification
    edges:
      # Load Risk Stratification data from Sollis
      - from: Blob.sollis/RiskStrat/RiskStrat.csv
        via: mov.SollisRiskStratification
        to: staging.sollis.RiskStratFeed
      - from: staging.sollis.RiskStratFeed
        to: ods.sollis.usp_LoadRiskStratificationToOds
      - from: ods.sollis.usp_LoadRiskStratificationToOds
        to: ods.sollis.RiskStratification
      # Load to DW
      - from: ods.sollis.RiskStratification
        via: mov.DwLoad
        to: ods.dw.usp_GetFactRiskStratificationData
      - from: ods.dw.DimPerson
        via: mov.DwLoad
        to: ods.dw.usp_GetFactRiskStratificationData
      - from: ods.sollis.RiskStratification
        via: mov.DwLoad
        to: ods.dw.usp_GetDimAdaptiveCodeGenerationData
      - from: ods.sollis.RiskStratification
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPatientNeedGroupData
      - from: ods.sollis.RiskStratification
        via: mov.DwLoad
        to: ods.dw.usp_GetDimMatrixSegmentationData
      - from: ods.sollis.RiskStratification
        via: mov.DwLoad
        to: ods.dw.usp_GetDimCoordinationRiskData
      - from: ods.dw.usp_GetFactRiskStratificationData
        to: dw.staging.FactRiskStratification
      - from: ods.dw.usp_GetDimAdaptiveCodeGenerationData
        to: dw.staging.DimAdaptiveCodeGeneration
      - from: ods.dw.usp_GetDimPatientNeedGroupData
        to: dw.staging.DimPatientNeedGroup
      - from: ods.dw.usp_GetDimMatrixSegmentationData
        to: dw.staging.DimMatrixSegmentation
      - from: ods.dw.usp_GetDimCoordinationRiskData
        to: dw.staging.DimCoordinationRisk
      - from: dw.staging.FactRiskStratification
        to: dw.staging.usp_LoadFactRiskStratification
      - from: dw.staging.DimAdaptiveCodeGeneration
        to: dw.staging.usp_LoadDimAdaptiveCodeGeneration
      - from: dw.staging.DimPatientNeedGroup
        to: dw.staging.usp_LoadDimPatientNeedGroup
      - from: dw.staging.DimMatrixSegmentation
        to: dw.staging.usp_LoadDimMatrixSegmentation
      - from: dw.staging.DimCoordinationRisk
        to: dw.staging.usp_LoadDimCoordinationRisk
      - from: dw.staging.usp_LoadFactRiskStratification
        to: dw.dbo.FactRiskStratification
      - from: dw.staging.usp_LoadDimAdaptiveCodeGeneration
        to: dw.dbo.DimAdaptiveCodeGeneration
      - from: dw.staging.usp_LoadDimPatientNeedGroup
        to: dw.dbo.DimPatientNeedGroup
      - from: dw.staging.usp_LoadDimMatrixSegmentation
        to: dw.dbo.DimMatrixSegmentation
      - from: dw.staging.usp_LoadDimCoordinationRisk
        to: dw.dbo.DimCoordinationRisk
    # Foreign key relationships
      - from: dw.dbo.DimAdaptiveCodeGeneration
        to: dw.dbo.FactRiskStratification
      - from: dw.dbo.DimPatientNeedGroup
        to: dw.dbo.FactRiskStratification
      - from: dw.dbo.DimMatrixSegmentation
        to: dw.dbo.FactRiskStratification
      - from: dw.dbo.DimCoordinationRisk
        to: dw.dbo.FactRiskStratification

  - name: dw.dbo.FactSomersetCancerRegisterTreatment 
    edges:
      # DCH source
      - from: blob.dch/cancer/treatments.csv
        via: mov.SomersetCancerRegisterDch
        to: staging.acute.DchScrTreatment
      - from: staging.acute.DchScrTreatment
        to: ods.acute.usp_LoadDchScrTreatmentToOds
      - from: ods.acute.usp_LoadDchScrTreatmentToOds
        to: ods.clinical.SomersetCancerRegisterTreatment
      # SFT source
      - from: blob.sft/Cancer/treatments.csv
        via: mov.SomersetCancerRegisterSft
        to: staging.acute.SftScrTreatment
      - from: staging.acute.SftScrTreatment
        to: ods.acute.usp_LoadSftScrTreatmentToOds
      - from: ods.acute.usp_LoadSftScrTreatmentToOds
        to: ods.clinical.SomersetCancerRegisterTreatment
      # UHD source
      - from: blob.ccg/scr/OpenPseudonymised_UHD Treatments.csv
        via: mov.SomersetCancerRegisterUhd
        to: staging.acute.UhdScrTreatment
      - from: staging.acute.UhdScrTreatment
        to: ods.acute.usp_LoadUhdScrTreatmentToOds
      - from: ods.acute.usp_LoadUhdScrTreatmentToOds
        to: ods.clinical.SomersetCancerRegisterTreatment
      # HHFT source
      - from: blob.hhft/cancer/HHFT_SCR_Treatments_.csv
        via: mov.SomersetCancerRegisterHhft
        to: staging.acute.HhftScrTreatment
      - from: staging.acute.HhftScrTreatment
        to: ods.acute.usp_LoadHhftScrTreatmentToOds
      - from: ods.acute.usp_LoadHhftScrTreatmentToOds
        to: ods.clinical.SomersetCancerRegisterTreatment
      # IOW source
      - from: blob.iow/cancer/OpenPseudonymised_IOW - SCR Extract - Treatments.csv
        via: mov.SomersetCancerRegisterIow
        to: staging.acute.IowScrTreatment
      - from: staging.acute.IowScrTreatment
        to: ods.acute.usp_LoadIowScrTreatmentToOds
      - from: ods.acute.usp_LoadIowScrTreatmentToOds
        to: ods.clinical.SomersetCancerRegisterTreatment
      # UHS source
      - from: blob.uhs/cancer/OpenPseudonymised_UHS_Extract_Treatment.csv
        via: mov.SomersetCancerRegisterUhs
        to: staging.acute.UhsScrTreatment
      - from: staging.acute.UhsScrTreatment
        to: ods.acute.usp_LoadUhsScrTreatmentToOds
      - from: ods.acute.usp_LoadUhsScrTreatmentToOds
        to: ods.clinical.SomersetCancerRegisterTreatment
      # PHU source
      - from: blob.phu/cancer/treatment.csv
        via: mov.SomersetCancerRegisterPhu
        to: staging.acute.PhuScrTreatment
      - from: staging.acute.PhuScrTreatment
        to: ods.acute.usp_LoadPhuScrTreatmentToOds
      - from: ods.acute.usp_LoadPhuScrTreatmentToOds
        to: ods.clinical.SomersetCancerRegisterTreatment
      # Load to DW
      - from: ods.clinical.SomersetCancerRegisterTreatment
        via: mov.DwLoad
        to: ods.dw.usp_GetFactSomersetCancerRegisterTreatmentData
      - from: ods.dw.usp_GetFactSomersetCancerRegisterTreatmentData

        to: dw.staging.FactSomersetCancerRegisterTreatment
      - from: dw.staging.FactSomersetCancerRegisterTreatment
        to: dw.staging.usp_LoadFactSomersetCancerRegisterTreatment
      - from: dw.staging.usp_LoadFactSomersetCancerRegisterTreatment
        to: dw.dbo.FactSomersetCancerRegisterTreatment
      - from: ods.clinical.SomersetCancerRegisterTreatment
        via: mov.DwLoad
        to: ods.dw.usp_GetDimConditionLocationData
      - from: ods.dw.usp_GetDimConditionLocationData
        to: dw.staging.DimConditionLocation
      - from: dw.staging.DimConditionLocation
        to: dw.staging.usp_LoadDimConditionLocation
      - from: dw.staging.usp_LoadDimConditionLocation
        to: dw.dbo.DimConditionLocation
      - from: ods.clinical.SomersetCancerRegisterTreatment
        via: mov.DwLoad
        to: ods.dw.usp_GetDimLocationTypeData
      - from: ods.dw.usp_GetDimLocationTypeData
        to: dw.staging.DimLocationType
      - from: dw.staging.DimLocationType
        to: dw.staging.usp_LoadDimLocationType
      - from: dw.staging.usp_LoadDimLocationType
        to: dw.dbo.DimLocationType
      - from: ods.clinical.SomersetCancerRegisterTreatment
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPriorityTypeData
      - from: ods.dw.usp_GetDimPriorityTypeData
        to: dw.staging.DimPriorityType
      - from: dw.staging.DimPriorityType
        to: dw.staging.usp_LoadDimPriorityType
      - from: dw.staging.usp_LoadDimPriorityType
        to: dw.dbo.DimPriorityType
      - from: ods.clinical.SomersetCancerRegisterTreatment
        via: mov.DwLoad
        to: ods.dw.usp_GetDimReferralTypeData
      - from: ods.dw.usp_GetDimReferralTypeData
        to: dw.staging.DimReferralType
      - from: dw.staging.DimReferralType
        to: dw.staging.usp_LoadDimReferralType
      - from: dw.staging.usp_LoadDimReferralType
        to: dw.dbo.DimReferralType
      - from: ods.clinical.SomersetCancerRegisterTreatment
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPathwayStatusData
      - from: ods.dw.usp_GetDimPathwayStatusData
        to: dw.staging.DimPathwayStatus
      - from: dw.staging.DimPathwayStatus
        to: dw.staging.usp_LoadDimPathwayStatus
      - from: dw.staging.usp_LoadDimPathwayStatus
        to: dw.dbo.DimPathwayStatus
      - from: ods.clinical.SomersetCancerRegisterTreatment
        via: mov.DwLoad
        to: ods.dw.usp_GetDimAppointmentTypeData
      - from: ods.dw.usp_GetDimAppointmentTypeData
        to: dw.staging.DimAppointmentType
      - from: dw.staging.DimAppointmentType
        to: dw.staging.usp_LoadDimAppointmentType
      - from: dw.staging.usp_LoadDimAppointmentType
        to: dw.dbo.DimAppointmentType
      - from: ods.clinical.SomersetCancerRegisterTreatment
        via: mov.DwLoad
        to: ods.dw.usp_GetDimDiagnosisTypeData
      - from: ods.dw.usp_GetDimDiagnosisTypeData
        to: dw.staging.DimDiagnosisType
      - from: dw.staging.DimDiagnosisType
        to: dw.staging.usp_LoadDimDiagnosisType
      - from: dw.staging.usp_LoadDimDiagnosisType
        to: dw.dbo.DimDiagnosisType
      - from: ods.clinical.SomersetCancerRegisterTreatment
        via: mov.DwLoad
        to: ods.dw.usp_GetDimTumourStatusData
      - from: ods.dw.usp_GetDimTumourStatusData
        to: dw.staging.DimTumourStatus
      - from: dw.staging.DimTumourStatus
        to: dw.staging.usp_LoadDimTumourStatus
      - from: dw.staging.usp_LoadDimTumourStatus
        to: dw.dbo.DimTumourStatus
      - from: ods.clinical.SomersetCancerRegisterTreatment
        via: mov.DwLoad
        to: ods.dw.usp_GetDimTreatmentStageData
      - from: ods.dw.usp_GetDimTreatmentStageData
        to: dw.staging.DimTreatmentStage
      - from: dw.staging.DimTreatmentStage
        to: dw.staging.usp_LoadDimTreatmentStage
      - from: dw.staging.usp_LoadDimTreatmentStage
        to: dw.dbo.DimTreatmentStage
      - from: ods.clinical.SomersetCancerRegisterTreatment
        via: mov.DwLoad
        to: ods.dw.usp_GetDimReferralSubtypeData
      - from: ods.dw.usp_GetDimReferralSubtypeData
        to: dw.staging.DimReferralSubtype
      - from: dw.staging.DimReferralSubtype
        to: dw.staging.usp_LoadDimReferralSubtype
      - from: dw.staging.usp_LoadDimReferralSubtype
        to: dw.dbo.DimReferralSubtype
    # Foreign key relationships
      - from: dw.dbo.DimConditionLocation
        to: dw.dbo.FactSomersetCancerRegister
      - from: dw.dbo.DimLocationType
        to: dw.dbo.FactSomersetCancerRegister
      - from: dw.dbo.DimPriorityType
        to: dw.dbo.FactSomersetCancerRegister
      - from: dw.dbo.DimReferralType
        to: dw.dbo.FactSomersetCancerRegister
      - from: dw.dbo.DimPathwayStatus
        to: dw.dbo.FactSomersetCancerRegister
      - from: dw.dbo.DimAppointmentType
        to: dw.dbo.FactSomersetCancerRegister
      - from: dw.dbo.DimDiagnosisType
        to: dw.dbo.FactSomersetCancerRegister
      - from: dw.dbo.DimTumourStatus
        to: dw.dbo.FactSomersetCancerRegister
      - from: dw.dbo.DimTreatmentStage
        to: dw.dbo.FactSomersetCancerRegister
      - from: dw.dbo.DimReferralSubtype
        to: dw.dbo.FactSomersetCancerRegister

  - name: dw.dbo.FactChildrensSocialCare
    edges:
    # BCP source
      - from: Blob.bcp/ChildrenAndYoungPeople/BCP_CSC_DIIS.csv
        via: mov.ChildrensSocialCareBcp
        to: staging.social.BcpChildrensSocialCare
      - from: staging.social.BcpChildrensSocialCare
        to: ods.social.usp_LoadBcpChildrensSocialCarePersonLinkToMpi
      - from: staging.social.BcpChildrensSocialCare
        to: ods.social.usp_LoadBcpChildrensSocialCareToOds
      - from: ods.social.usp_LoadBcpChildrensSocialCareToOds
        to: ods.social.ChildrensSocialCare
    # DC source
      - from: Blob.dorsetcouncil/ChildrenAndYoungPeople/DC_CINData.csv
        via: mov.ChildrensSocialCareDc
        to: staging.social.DcChildrensSocialCare
      - from: staging.social.DcChildrensSocialCare
        to: ods.social.usp_LoadDcChildrensSocialCarePersonLinkToMpi
      - from: staging.social.DcChildrensSocialCare
        to: ods.social.usp_LoadDcChildrensSocialCareToOds
      - from: ods.social.usp_LoadDcChildrensSocialCareToOds
        to: ods.social.ChildrensSocialCare
    # Load to DW
      - from: ods.social.ChildrensSocialCare
        to: ods.dw.usp_GetDimCareLeaverInTouchData
      - from: ods.dw.usp_GetDimCareLeaverInTouchData
        to: dw.staging.DimCareLeaverInTouch
      - from: dw.staging.DimCareLeaverInTouch
        to: dw.staging.usp_LoadDimCareLeaverInTouch
      - from: dw.staging.usp_LoadDimCareLeaverInTouch
        to: dw.dbo.DimCareLeaverInTouch
      - from: ods.social.ChildrensSocialCare
        to: ods.dw.usp_GetFactChildrensSocialCareData
      - from: ods.dw.usp_GetFactChildrensSocialCareData
        to: dw.staging.FactChildrensSocialCare
      - from: dw.staging.FactChildrensSocialCare
        to: dw.staging.usp_LoadFactChildrensSocialCare
      - from: dw.staging.usp_LoadFactChildrensSocialCare
        to: dw.dbo.FactChildrensSocialCare
    # Foreign key relationships
      - from: dw.dbo.DimCareLeaverInTouch
        to: dw.dbo.FactChildrensSocialCare
  
  - name: dw.dbo.FactPersonCommunityShielding
    edges:
      # Source: AchieveForms
      - from: Blob.dorsetcouncil/AchieveForms/OpenPseudonymised_DiiS_.csv
        via: mov.CommunityShielding
        to: staging.dc.CommunityShielding
      - from: staging.dc.CommunityShielding
        to: ods.dc.usp_LoadCommunityShieldingToOds
      - from: ods.dc.usp_LoadCommunityShieldingToOds
        to: ods.social.CommunityShielding
      # Load to DW
      - from: ods.social.CommunityShielding
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPersonCommunityShieldingData
      - from: ods.dw.usp_GetFactPersonCommunityShieldingData
        to: dw.staging.FactPersonCommunityShielding
      - from: dw.staging.FactPersonCommunityShielding
        to: dw.staging.usp_LoadFactPersonCommunityShielding
      - from: dw.staging.usp_LoadFactPersonCommunityShielding
        to: dw.dbo.FactPersonCommunityShielding
      - from: ods.social.CommunityShielding
        via: mov.DwLoad
        to: ods.dw.usp_GetDimCallTypeData
      - from: ods.dw.usp_GetDimCallTypeData
        to: dw.staging.DimCallType
      - from: dw.staging.DimCallType
        to: dw.staging.usp_LoadDimCallType
      - from: dw.staging.usp_LoadDimCallType
        to: dw.dbo.DimCallType
      - from: ods.social.CommunityShielding
        via: mov.DwLoad
        to: ods.dw.usp_GetDimSupportRequiredData
      - from: ods.dw.usp_GetDimSupportRequiredData
        to: dw.staging.DimSupportRequired
      - from: dw.staging.DimSupportRequired
        to: dw.staging.usp_LoadDimSupportRequired
      - from: dw.staging.usp_LoadDimSupportRequired
        to: dw.dbo.DimSupportRequired
    # Foreign key relationships
      - from: dw.dbo.DimCallType
        to: dw.dbo.FactPersonCommunityShielding
      - from: dw.dbo.DimSupportRequired
        to: dw.dbo.FactPersonCommunityShielding

  - name: dw.dbo.FactPersonClinicalCount
    edges:
      - from: dw.FactPersonMedicationHistory
        via: mov.DwLoad
        to: dw.usp_LoadFactPersonClinicalCount
      - from: dw.DimMedication
        via: mov.DwLoad
        to: dw.usp_LoadFactPersonClinicalCount
      - from: dw.FactTheograph
        via: mov.DwLoad
        to: dw.usp_LoadFactPersonClinicalCount
      - from: dw.DimTheographActivity
        via: mov.DwLoad
        to: dw.usp_LoadFactPersonClinicalCount
      - from: dw.DimPointOfDelivery
        via: mov.DwLoad
        to: dw.usp_LoadFactPersonClinicalCount
      - from: dw.FactPersonClinicalHistory
        via: mov.DwLoad
        to: dw.usp_LoadFactPersonClinicalCount
      - from: dw.DimClinicalMeasurement
        via: mov.DwLoad
        to: dw.usp_LoadFactPersonClinicalCount
      - from: dw.usp_LoadFactPersonClinicalCount
        to: dw.dbo.FactPersonClinicalCount

  - name: dw.dbo.FactEmergencyCare
    edges:
    # Load Accident and Emergency data from S251
      - from: source-live-sqlserver.S251.dbo.Em
        via: mov.PhmSusAe
        to: staging.phmsus.Em
      - from: source-live-sqlserver.S251.dbo.Em_Supplementary62
        via: mov.PhmSusAe
        to: staging.phmsus.EmSupplementary62
      - from: staging.phmsus.Em
        to: staging.phmsus.usp_LoadAccidentAndEmergencyToOds
      - from: staging.phmsus.EmSupplementary62
        to: staging.phmsus.usp_LoadAccidentAndEmergencyToOds
      - from: phmsus.usp_LoadAccidentAndEmergencyToOds
        to: ods.phmsus.AccidentAndEmergency
    # Load to reporting
      - from: ods.phmsus.EmergencyCare
        to: reporting.usp_GetEmergencyCareData
      - from: reporting.usp_GetEmergencyCareData
        to: reporting.staging.EmergencyCare
      - from: reporting.staging.EmergencyCare
        to: reporting.staging.usp_LoadEmergencyCare
      - from: reporting.staging.usp_LoadEmergencyCare
        to: reporting.dbo.EmergencyCare
    # Load to DW
      - from: ods.phmsus.EmergencyCare
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.OverseasVisitors
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.GeneralMedicalPractitioner
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.HourlyTimeBand
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.Age
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.Sex
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.Day
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.LocalProviderSite
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.AeDepartment
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.AeLocationType
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.AePatientGroup
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.AeReferralSource
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.AeAttendanceCategory
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.AeAttendanceDisposal
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.AeArrivalMethod
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.AeTreatment
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.AeInvestigation
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.Icd10Diagnoses
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.AeHealthcareResourceGroup
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.PracticeCluster
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.ref.OnsLaWardMapping
        via: mov.DwLoad
        to: ods.dw.usp_GetFactEmergencyCareData
      - from: ods.phmsus.EmergencyCare
        via: mov.DwLoad
        to: ods.dw.usp_GetDimEmergencyDepartmentTypeData
      - from: ods.dw.usp_GetDimEmergencyDepartmentTypeData
        to: dw.staging.DimEmergencyDepartmentType
      - from: dw.staging.DimEmergencyDepartmentType
        to: dw.staging.usp_LoadDimEmergencyDepartmentType
      - from: dw.staging.usp_LoadDimEmergencyDepartmentType
        to: dw.dbo.DimEmergencyDepartmentType
      - from: ods.AgeBanding
        via: mov.DwLoad
        to: ods.dw.usp_GetDimAgeData
      - from: ods.dw.usp_GetDimAgeData
        to: dw.staging.DimAge
      - from: dw.staging.DimAge
        to: dw.staging.usp_LoadDimAge
      - from: dw.staging.usp_LoadDimAge
        to: dw.dbo.DimAge
      - from: ods.dw.usp_GetFactEmergencyCareData
        to: dw.staging.FactEmergencyCare
      - from: dw.staging.FactEmergencyCare
        to: dw.staging.usp_LoadFactEmergencyCare
      - from: dw.staging.usp_LoadFactEmergencyCare
        to: dw.dbo.FactEmergencyCare
  # Foreign key relationships
      - from: dw.dbo.DimEmergencyDepartmentType
        to: dw.dbo.FactEmergencyCare
      - from: dw.dbo.DimAge
        to: dw.dbo.FactEmergencyCare
      - from: dw.DimGpSurgery
        to: dw.dbo.FactEmergencyCare
      - from: dw.dbo.DimProviderSite
        to: dw.dbo.FactEmergencyCare
      - from: dw.dbo.DimLowerLayerSuperOutputArea
        to: dw.dbo.FactEmergencyCare
      - from: dw.dbo.DimPostcodeDistrict
        to: dw.dbo.FactEmergencyCare
      - from: dw.dbo.DimSecondaryCareArrivalMode
        to: dw.dbo.FactEmergencyCare
      - from: dw.dbo.DimAttendanceSource
        to: dw.dbo.FactEmergencyCare
      - from: dw.dbo.DimSecondaryCareDischargeStatus
        to: dw.dbo.FactEmergencyCare
      - from: dw.dbo.DimSecondaryCareDischargeDestination
        to: dw.dbo.FactEmergencyCare
      - from: dw.dbo.DimSecondaryCareChiefComplaint
        to: dw.dbo.FactEmergencyCare
      - from: dw.dbo.DimSecondaryCareAcuity
        to: dw.dbo.FactEmergencyCare
      - from: dw.dbo.DimAccommodationStatus
        to: dw.dbo.FactEmergencyCare

  - name: dw.dbo.FactGpRegistrationHistory
    edges:
    # Load to DW
      - from: ods.Partner
        via: mov.DwLoad
        to: dw.usp_LoadFactGpRegistrationHistory
      - from: dw.Organisation
        via: mov.DwLoad
        to: dw.usp_LoadFactGpRegistrationHistory
      - from: ods.clinical.PersonOrganisationRegistration
        via: mov.DwLoad
        to: dw.usp_LoadFactGpRegistrationHistory
      - from: dw.usp_LoadFactGpRegistrationHistory
        to: dw.staging.FactGpRegistrationHistory
      - from: dw.staging.FactGpRegistrationHistory
        to: dw.staging.usp_LoadFactGpRegistrationHistory
      - from: dw.staging.usp_LoadFactGpRegistrationHistory
        to: dw.dbo.FactGpRegistrationHistory

  - name: dw.dbo.FactFaecalImmunochemicalTesting
    edges:
      # UHD source
      - from: Blob_uhd/fit/OpenPseudonymised_FIT Report.csv
        via: mov.FaecalImmunochemicalTestingUhd
        to: staging.acute.UhdFit
      - from: staging.acute.UhdFit
        to: ods.acute.usp_LoadUhdFitToOds
      - from: ods.acute.usp_LoadUhdFitToOds
        to: ods.clinical.FaecalImmunochemicalTesting
      # HHFT source
      - from: Blob_hhft/fit/HHFT_FIT_DATA.csv
        via: mov.FaecalImmunochemicalTestingHhft
        to: staging.acute.HhftFit
      - from: staging.acute.HhftFit
        to: ods.acute.usp_LoadHhftFitToOds
      - from: ods.acute.usp_LoadHhftFitToOds
        to: ods.clinical.FaecalImmunochemicalTesting
      # HHFT GP Practice Lookup
      - from: Blob_ref/Lookup/HHFT_FIT_DATA_PRACTICE_LOOKUP.csv
        via: mov.HhftFitGpPracticeLookup
        to: staging.ref.HhftFitGpPracticeLookup
      - from: staging.ref.HhftFitGpPracticeLookup
        to: ods.ref.usp_LoadHhftFitGpPracticeLookupToOds
      - from: ods.ref.usp_LoadHhftFitGpPracticeLookupToOds
        to: ods.ref.HhftFitGpPracticeLookup
      # IOW source
      - from: Blob_iow/fit/OpenPseudonymised_IOW.csv
        via: mov.FaecalImmunochemicalTestingIow
        to: staging.acute.IowFit
      - from: staging.acute.IowFit
        to: ods.acute.usp_LoadIowFitToOds
      - from: ods.acute.usp_LoadIowFitToOds
        to: ods.clinical.FaecalImmunochemicalTesting
      # DCH source
      - from: Blob_dch/pathology/fit/fit.csv
        via: mov.FaecalImmunochemicalTestingDch
        to: staging.acute.DchFit
      - from: staging.acute.DchFit
        to: ods.acute.usp_LoadDchFitPersonLinkToMpi
      - from: staging.acute.DchFit
        to: ods.acute.usp_LoadDchFitToOds
      - from: ods.acute.usp_LoadDchFitToOds
        to: ods.clinical.FaecalImmunochemicalTesting
      # UHS source
      - from: Blob_uhs/fit/FIT.csv
        via: mov.FaecalImmunochemicalTestingUhs
        to: staging.acute.UhsFit
      - from: staging.acute.UhsFit
        to: ods.acute.usp_LoadUhsFitPersonLinkToMpi
      - from: staging.acute.UhsFit
        to: ods.acute.usp_LoadUhsFitToOds
      - from: ods.acute.usp_LoadUhsFitToOds
        to: ods.clinical.FaecalImmunochemicalTesting
      # PHU source
      - from: Blob_phu/fit/fit.csv
        via: mov.FaecalImmunochemicalTestingPhu
        to: staging.acute.PhuFit
      - from: staging.acute.PhuFit
        to: ods.acute.usp_LoadPhuFitPersonLinkToMpi
      - from: staging.acute.PhuFit
        to: ods.acute.usp_LoadPhuFitToOds
      - from: ods.acute.usp_LoadPhuFitToOds
        to: ods.clinical.FaecalImmunochemicalTesting
      # Load to DW
      - from: ods.clinical.FaecalImmunochemicalTesting
        via: mov.DwLoad
        to: ods.dw.usp_GetFactFaecalImmunochemicalTestingData
      - from: ods.dw.DimPerson
        via: mov.DwLoad
        to: ods.dw.usp_GetFactFaecalImmunochemicalTestingData
      - from: ods.ref.HhftFitGpPracticeLookup
        via: mov.DwLoad
        to: ods.dw.usp_GetFactFaecalImmunochemicalTestingData
      - from: ods.Organisation
        via: mov.DwLoad
        to: ods.dw.usp_GetFactFaecalImmunochemicalTestingData
      - from: ods.clinical.FaecalImmunochemicalTesting
        via: mov.DwLoad
        to: ods.dw.usp_GetFactFaecalImmunochemicalTestingData
      - from: ods.dw.usp_GetFactFaecalImmunochemicalTestingData
        to: dw.staging.FactFaecalImmunochemicalTesting
      - from: dw.staging.FactFaecalImmunochemicalTesting
        to: dw.staging.usp_LoadFactFaecalImmunochemicalTesting
      - from: dw.staging.usp_LoadFactFaecalImmunochemicalTesting
        to: dw.dbo.FactFaecalImmunochemicalTesting
      - from: ods.clinical.FaecalImmunochemicalTesting
        via: mov.DwLoad
        to: ods.dw.usp_GetDimFitReferralSourceDescriptionData
      - from: ods.dw.usp_GetDimFitReferralSourceDescriptionData
        to: dw.staging.DimFitReferralSourceDescription
      - from: dw.staging.DimFitReferralSourceDescription
        to: dw.staging.usp_LoadDimFitReferralSourceDescription
      - from: dw.staging.usp_LoadDimFitReferralSourceDescription
        to: dw.dbo.DimFitReferralSourceDescription
      - from: ods.clinical.FaecalImmunochemicalTesting
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPriorityTypeData
      - from: ods.dw.usp_GetDimPriorityTypeData
        to: dw.staging.DimPriorityType
      - from: dw.staging.DimPriorityType
        to: dw.staging.usp_LoadDimPriorityType
      - from: dw.staging.usp_LoadDimPriorityType
        to: dw.dbo.DimPriorityType
      - from: ods.clinical.FaecalImmunochemicalTesting
        via: mov.DwLoad
        to: ods.dw.usp_GetDimFitResultData
      - from: ods.dw.usp_GetDimFitResultData
        to: dw.staging.DimFitResult
      - from: dw.staging.DimFitResult
        to: dw.staging.usp_LoadDimFitResult
      - from: dw.staging.usp_LoadDimFitResult
        to: dw.dbo.DimFitResult
    # Foreign key relationships
      - from: dw.dbo.DimDrug
        to: dw.dbo.FactFaecalImmunochemicalTesting
      - from: dw.dbo.DimProgram
        to: dw.dbo.FactFaecalImmunochemicalTesting
      - from: dw.dbo.DimRisk
        to: dw.dbo.FactFaecalImmunochemicalTesting
      - from: dw.dbo.DimTeam
        to: dw.dbo.FactFaecalImmunochemicalTesting

  - name: Inhealthcare Load to ods
    edges:
      - from: Blob_rpa/Inhealthcare/Oncology/Alerts.csv
        via: mov.InhealthcareOncology
        to: staging.inhealthcare.Alerts
      - from: staging.inhealthcare.Alerts
        to: ods.inhealthcare.usp_LoadAlertsToOds
      - from: ods.inhealthcare.usp_LoadAlertsToOds
        to: ods.inhealthcare.Alerts
      - from: Blob_rpa/Inhealthcare/Oncology/VitalsandToxicity.csv
        via: mov.InhealthcareOncology
        to: staging.inhealthcare.VitalsAndToxicity
      - from: staging.inhealthcare.VitalsAndToxicity
        to: ods.inhealthcare.usp_LoadVitalsandToxicityToOds
      - from: ods.inhealthcare.usp_LoadVitalsandToxicityToOds
        to: ods.inhealthcare.VitalsAndToxicity
      - from: Blob_rpa/Inhealthcare/Oncology/PatientDetail.csv
        via: mov.InhealthcareOncology
        to: staging.inhealthcare.PatientDetail
      - from: staging.inhealthcare.PatientDetail
        to: ods.inhealthcare.usp_LoadPatientDetailToOds
      - from: ods.inhealthcare.usp_LoadPatientDetailToOds
        to: ods.inhealthcare.PatientDetail

  - name: Inhealthcare Dimensions to DW
    edges:
      - from: ods.inhealthcare.Alerts
        to: ods.dw.usp_GetDimAlertTypeData
      - from: ods.dw.usp_GetDimAlertTypeData
        to: dw.staging.DimAlertType
      - from: dw.staging.DimAlertType
        to: dw.staging.usp_LoadDimAlertType
      - from: dw.staging.usp_LoadDimAlertType
        to: dw.dbo.DimAlertType
      - from: ods.inhealthcare.Alerts
        to: ods.dw.usp_GetDimInhealthcareServiceData
      - from: ods.inhealthcare.VitalsAndToxicity
        to: ods.dw.usp_GetDimInhealthcareServiceData
      - from: ods.dw.PatientDetail
        to: dw.dw.usp_GetDimInhealthcareServiceData
      - from: ods.dw.usp_GetDimInhealthcareServiceData
        to: dw.staging.DimInhealthcareService
      - from: dw.staging.DimInhealthcareService
        to: dw.staging.usp_LoadDimInhealthcareService
      - from: dw.staging.usp_LoadDimInhealthcareService
        to: dw.dbo.DimInhealthcareService
      - from: ods.inhealthcare.Alerts
        to: ods.dw.usp_GetDimAlertOutcomeClinicalDecisionData
      - from: ods.dw.usp_GetDimAlertOutcomeClinicalDecisionData
        to: dw.staging.DimAlertOutcomeClinicalDecision
      - from: dw.staging.DimAlertOutcomeClinicalDecision
        to: dw.staging.usp_LoadDimAlertOutcomeClinicalDecision
      - from: dw.staging.usp_LoadDimAlertOutcomeClinicalDecision
        to: dw.dbo.DimAlertOutcomeClinicalDecision
      - from: ods.inhealthcare.Alerts
        to: ods.dw.usp_GetDimRedAlertOutcomeRationaleData
      - from: ods.dw.usp_GetDimRedAlertOutcomeRationaleData
        to: dw.staging.DimRedAlertOutcomeRationale
      - from: dw.staging.DimRedAlertOutcomeRationale
        to: dw.staging.usp_LoadDimRedAlertOutcomeRationale
      - from: dw.staging.usp_LoadDimRedAlertOutcomeRationale
        to: dw.dbo.DimRedAlertOutcomeRationale
      - from: ods.inhealthcare.PatientDetail
        to: ods.dw.usp_GetDimDischargeReasonData
      - from: ods.dw.usp_GetDimDischargeReasonData
        to: dw.staging.DimDischargeReason
      - from: dw.staging.DimDischargeReason
        to: dw.staging.usp_LoadDimDischargeReason
      - from: dw.staging.usp_LoadDimDischargeReason
        to: dw.dbo.DimDischargeReason
      - from: ods.inhealthcare.PatientDetail
        to: ods.dw.usp_GetDimCommunicationTypeData
      - from: ods.dw.usp_GetDimCommunicationTypeData
        to: dw.staging.DimCommunicationType
      - from: dw.staging.DimCommunicationType
        to: dw.staging.usp_LoadDimCommunicationType
      - from: dw.staging.usp_LoadDimCommunicationType
        to: dw.dbo.DimCommunicationType
      - from: ods.inhealthcare.PatientDetail
        to: ods.dw.usp_GetDimDiseaseSiteData
      - from: ods.dw.usp_GetDimDiseaseSiteData
        to: dw.staging.DimDiseaseSite
      - from: dw.staging.DimDiseaseSite
        to: dw.staging.usp_LoadDimDiseaseSite
      - from: dw.staging.usp_LoadDimDiseaseSite
        to: dw.dbo.DimDiseaseSite
      - from: ods.inhealthcare.PatientDetail
        to: ods.dw.usp_GetDimQuestionnaireData
      - from: ods.inhealthcare.VitalsAndToxicity
        to: ods.dw.usp_GetDimQuestionnaireData
      - from: ods.dw.usp_GetDimQuestionnaireData
        to: dw.staging.DimQuestionnaire
      - from: dw.staging.DimQuestionnaire
        to: dw.staging.usp_LoadDimQuestionnaire
      - from: dw.staging.usp_LoadDimQuestionnaire
        to: dw.dbo.DimQuestionnaire

  - name: dw.dbo.FactAlerts
    edges:
      - from: ods.inhealthcare.Alerts
        to: ods.dw.usp_GetFactAlertsData
      - from: ods.dw.usp_GetFactAlertsData
        to: dw.staging.FactAlerts
      - from: dw.staging.FactAlerts
        to: dw.staging.usp_LoadFactAlerts
      - from: dw.staging.usp_LoadFactAlerts
        to: dw.dbo.FactAlerts
    # Foreign key relationships
      - from: dw.dbo.DimAlertType
        to: dw.dbo.FactAlerts
      - from: dw.dbo.DimInhealthcareService
        to: dw.dbo.FactAlerts
      - from: dw.dbo.DimAlertOutcomeClinicalDecision
        to: dw.dbo.FactAlerts
      - from: dw.dbo.DimRedAlertOutcomeRationale
        to: dw.dbo.FactAlerts

  - name: dw.dbo.FactVitalsAndToxicity
    edges:
      - from: ods.inhealthcare.VitalsAndToxicity
        to: ods.dw.usp_GetFactVitalsAndToxicityData
      - from: ods.dw.usp_GetFactVitalsAndToxicityData
        to: dw.staging.FactVitalsAndToxicity
      - from: dw.staging.FactVitalsAndToxicity
        to: dw.staging.usp_LoadFactVitalsAndToxicity
      - from: dw.staging.usp_LoadFactVitalsAndToxicity
        to: dw.dbo.FactVitalsAndToxicity
    # Foreign key relationships
      - from: dw.dbo.DimInhealthcareService
        to: dw.dbo.FactVitalsAndToxicity
      - from: dw.dbo.DimQuestionnaire
        to: dw.dbo.FactVitalsAndToxicity

  - name: dw.dbo.FactPatientDetail
    edges:
      - from: ods.inhealthcare.PatientDetail
        to: ods.dw.usp_GetFactPatientDetailData
      - from: ods.dw.usp_GetFactPatientDetailData
        to: dw.staging.FactPatientDetail
      - from: dw.staging.FactPatientDetail
        to: dw.staging.usp_LoadFactPatientDetail
      - from: dw.staging.usp_LoadFactPatientDetail
        to: dw.dbo.FactPatientDetail
    # Foreign key relationships
      - from: dw.dbo.DimInhealthcareService
        to: dw.dbo.FactPatientDetail
      - from: dw.dbo.DimDischargeReason
        to: dw.dbo.FactPatientDetail
      - from: dw.dbo.DimCommunicationType
        to: dw.dbo.FactPatientDetail
      - from: dw.dbo.DimDiseaseSite
        to: dw.dbo.FactPatientDetail
      - from: dw.dbo.DimQuestionnaire
        to: dw.dbo.FactPatientDetail

  - name: dw.dbo.FactImmunisationHistory
    edges:
      - from: Default Data
        via: ods
        to: ods.ref.VaccinationPartLookup
      - from: ods.ref.VaccinationPartLookup
        via: mov.DwLoad
        to: ods.dw.usp_GetFactImmunisationHistoryData
      - from: Default Data
        via: ods
        to: ods.ref.VaccinationNameLookup
      - from: ods.ref.VaccinationNameLookup
        via: mov.DwLoad
        to: ods.dw.usp_GetFactImmunisationHistoryData
      - from: ods.clinical.Immunisation
        via: mov.DwLoad
        to: ods.dw.usp_GetFactImmunisationHistoryData
      - from: ods.clinical.ImmunisationContent
        via: mov.DwLoad
        to: ods.dw.usp_GetFactImmunisationHistoryData
      - from: ods.ref.VaccinationPartLookup
        via: mov.DwLoad
        to: ods.dw.usp_GetFactImmunisationHistoryData
      - from: ods.dw.DimPerson
        via: mov.DwLoad
        to: ods.dw.usp_GetFactImmunisationHistoryData
      - from: ods.dw.usp_GetFactImmunisationHistoryData
        to: dw.staging.FactImmunisationHistory
      - from: dw.staging.FactImmunisationHistory
        to: dw.staging.usp_LoadFactImmunisationHistory
      - from: dw.staging.usp_LoadFactImmunisationHistory
        to: dw.dbo.FactImmunisationHistory
      - from: ods.clinical.ImmunisationContent
        via: mov.DwLoad
        to: ods.dw.usp_GetDimImmunisationNameData
      - from: ods.ref.VaccinationNameLookup
        via: mov.DwLoad
        to: ods.dw.usp_GetDimImmunisationNameData
      - from: ods.dw.usp_GetDimImmunisationNameData
        to: dw.staging.DimImmunisationName
      - from: dw.staging.DimImmunisationName
        to: dw.staging.usp_LoadDimImmunisationName
      - from: dw.staging.usp_LoadDimImmunisationName
        to: dw.dbo.DimImmunisationName
      - from: ods.ref.VaccinationPartLookup
        via: mov.DwLoad
        to: ods.dw.usp_GetDimImmunisationPartData
      - from: ods.dw.usp_GetDimImmunisationPartData
        to: dw.staging.DimImmunisationPart
      - from: dw.staging.DimImmunisationPart
        to: dw.staging.usp_LoadDimImmunisationPart
      - from: dw.staging.usp_LoadDimImmunisationPart
        to: dw.dbo.DimImmunisationPart
  # Foreign key relationships
      - from: dw.dbo.DimImmunisationName
        to: dw.dbo.FactImmunisationHistory
      - from: dw.dbo.DimImmunisationPart
        to: dw.dbo.FactImmunisationHistory

  - name: dw.dbo.FactPracticePopulation
    edges:
      - from: bond.Person
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPracticePopulationData
      - from: ods.clinical.PersonOrganisationRegistration
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPracticePopulationData
      - from: ods.Partner
        via: mov.DwLoad
        to: ods.dw.usp_GetFactPracticePopulationData
      - from: ods.dw.usp_GetFactPracticePopulationData
        to: dw.staging.FactPracticePopulation
      - from: dw.staging.FactPracticePopulation
        to: dw.staging.usp_LoadFactPracticePopulation
      - from: dw.staging.usp_LoadFactPracticePopulation
        to: dw.dbo.FactPracticePopulation

  - name: dw.ref.MedicationMapping
    edges:
      - from: ods.clinical.MedicationMultiLexProduct
        via: mov.DwLoad
        to: ods.dw.usp_GetMedicationMappingData
      - from: ods.ref.PrescriptionMappingAcbScore
        via: mov.DwLoad
        to: ods.dw.usp_GetMedicationMappingData
      - from: ods.clinical.ReadCode
        via: mov.DwLoad
        to: ods.dw.usp_GetMedicationMappingData
      - from: ods.ref.MetricMeasurementCodeMapping
        via: mov.DwLoad
        to: ods.dw.usp_GetMedicationMappingData
      - from: ods.ref.PrescriptionMappingAcbScore
        via: mov.DwLoad
        to: ods.dw.usp_GetMedicationMappingData
      - from: ods.dw.usp_GetMedicationMappingData
        to: dw.staging.MedicationMapping
      - from: dw.staging.MedicationMapping
        to: dw.staging.usp_LoadMedicationMapping
      - from: dw.staging.usp_LoadMedicationMapping
    # Added dbo here to complete the path
        to: dw.ref.dbo.MedicationMapping

  - name: dw.dbo.FactSpecialEducationalNeedAndDisability
    edges:
    # Load Special Educational Need And Disability data from DC and BCP sources
      - from: Blob_dorsetcouncil/ChildrenAndYoungPeople/DC_SENData.csv
        via: mov.DcSpecialEducationalNeedAndDisability
        to: staging.social.DcSpecialEducationalNeedAndDisability
      - from: Blob_bcp/ChildrenAndYoungPeople/SEN.csv
        via: mov.BcpSpecialEducationalNeedAndDisability
        to: staging.social.BcpSpecialEducationalNeedAndDisability
    # Load to Ods
      - from: staging.social.DcSpecialEducationalNeedAndDisability
        to: ods.social.usp_LoadDcSpecialEducationalNeedAndDisabilityToOds
      - from: staging.social.BcpSpecialEducationalNeedAndDisability
        to: ods.social.usp_LoadBcpSpecialEducationalNeedAndDisabilityToOds
      - from: ods.social.usp_LoadDcSpecialEducationalNeedAndDisabilityToOds
        to: ods.social.SpecialEducationalNeedAndDisability
      - from: ods.social.usp_LoadBcpSpecialEducationalNeedAndDisabilityToOds
        to: ods.social.SpecialEducationalNeedAndDisability
    # Load to Dw
      - from: ods.social.SpecialEducationalNeedAndDisability
        via: mov.SpecialEducationalNeedAndDisability
        to: ods.dw.usp_GetFactSpecialEducationalNeedAndDisabilityData
      - from: ods.social.SpecialEducationalNeedAndDisability
        via: mov.SpecialEducationalNeedAndDisability
        to: ods.dw.usp_GetDimCouncilData
      - from: ods.social.SpecialEducationalNeedAndDisability
        via: mov.SpecialEducationalNeedAndDisability
        to: ods.dw.usp_GetDimSenPrimaryNeedData
      - from: ods.dw.usp_GetFactSpecialEducationalNeedAndDisabilityData
        to: dw.staging.FactSpecialEducationalNeedAndDisability
      - from: ods.dw.usp_GetDimCouncilData
        to: dw.staging.DimCouncil
      - from: ods.dw.usp_GetDimSenPrimaryNeedData
        to: dw.staging.DimSenPrimaryNeed
      - from: dw.staging.FactSpecialEducationalNeedAndDisability
        to: dw.staging.usp_LoadFactSpecialEducationalNeedAndDisability
      - from: dw.staging.DimCouncil
        to: dw.staging.usp_LoadDimCouncil
      - from: dw.staging.DimSenPrimaryNeed
        to: dw.staging.usp_LoadDimSenPrimaryNeed
      - from: dw.staging.usp_LoadFactSpecialEducationalNeedAndDisability
        to: dw.dbo.FactSpecialEducationalNeedAndDisability
      - from: dw.staging.usp_LoadDimCouncil
        to: dw.dbo.DimCouncil
      - from: dw.staging.usp_LoadDimSenPrimaryNeed
        to: dw.dbo.DimSenPrimaryNeed
    # Foreign key relationships
      - from: dw.dbo.DimCouncil
        to: dw.dbo.FactSpecialEducationalNeedAndDisability
      - from: dw.dbo.DimSenPrimaryNeed
        to: dw.dbo.FactSpecialEducationalNeedAndDisability

  - name: commissioning.dbo.Inpatients
    edges:
      - from: source-live-sqlserver.PbRMart.dbo.APC_Episodes
        via: mov.CxSusInpatient
        to: staging.cxsus.ApcEpisodes
      - from: source-live-sqlserver.PbRMart.dbo.APC_Episodes_Supplementary62
        via: mov.CxSusInpatient
        to: staging.cxsus.ApcEpisodesSupplementary62
      - from: source-live-sqlserver.PbRMart.dbo.APC_Spells
        via: mov.CxSusInpatient
        to: staging.cxsus.ApcSpells
      - from: staging.cxsus.ApcEpisodes
        to: ods.cxsus.usp_LoadInpatientToOds
      - from: staging.cxsus.ApcEpisodesSupplementary62
        to: ods.cxsus.usp_LoadInpatientToOds
      - from: staging.cxsus.ApcSpells
        to: ods.cxsus.usp_LoadInpatientToOds
      - from: ods.cxsus.usp_LoadInpatientToOds
        to: ods.cx.usp_GetInpatientData
      - from: ods.cx.usp_GetInpatientData
        to: commissioning.staging.Inpatient
      - from: commissioning.staging.Inpatient
        to: commissioning.staging.usp_LoadInpatient
      - from: commissioning.staging.usp_LoadInpatient
        to: commissioning.dbo.Inpatient
      # Weekly Loads
      - from: source-live-sqlserver.PbRMart.Weekly.APC_Episodes
        via: mov.CxSusWeeklyInpatient
        to: staging.cxsus.WeeklyApcEpisodes
      - from: source-live-sqlserver.PbRMart.Weekly.APC_Episodes_Supplementary62
        via: mov.CxSusWeeklyInpatient
        to: staging.cxsus.WeeklyApcEpisodesSupplementary62
      - from: source-live-sqlserver.PbRMart.Weekly.APC_Spells
        via: mov.CxSusWeeklyInpatient
        to: staging.cxsus.WeeklyApcSpells
      - from: staging.cxsus.WeeklyApcEpisodes
        to: ods.cxsus.usp_LoadWeeklyInpatientToOds
      - from: staging.cxsus.WeeklyApcEpisodesSupplementary62
        to: ods.cxsus.usp_LoadWeeklyInpatientToOds
      - from: staging.cxsus.WeeklyApcSpells
        to: ods.cxsus.usp_LoadWeeklyInpatientToOds
      - from: ods.cxsus.usp_LoadWeeklyInpatientToOds
        to: ods.cx.usp_GetInpatientWeeklyData
      - from: ods.cx.usp_GetInpatientWeeklyData
        to: commissioning.staging.InpatientWeekly
      - from: commissioning.staging.InpatientWeekly
        to: commissioning.staging.usp_LoadInpatientWeekly
      - from: commissioning.staging.usp_LoadInpatientWeekly
        to: commissioning.dbo.Inpatient

  - name: commissioning.dbo.WardStay
    edges:
      - from: Blob_dch/uec-newton/uec-newton-ward-stays.csv
        via: mov.LocalSusDchWardStay
        to: staging.localsus.DchWardStay
      - from: Blob_dch/uec-newton/uec-newton-ward-reference.csv
        via: mov.LocalSusDchWardStay
        to: staging.localsus.DchWardReferenceLookup
      - from: Blob_uhd/uec/Ward_Episodes.csv
        via: mov.LocalSusUhdWardStay
        to: staging.localsus.UhdWardStay
      - from: Blob_uhd/uec/Ward_Code_Lookup.csv
        via: mov.LocalSusUhdWardStay
        to: staging.localsus.UhdWardReferenceLookup
      - from: staging.localsus.DchWardReferenceLookup
        to: staging.localsus.usp_LoadDchWardReferenceLookupToOds
      - from: staging.localsus.usp_LoadDchWardReferenceLookupToOds
        to: ods.localsus.DchWardReferenceLookup
      - from: staging.localsus.DchWardStay
        to: staging.localsus.usp_LoadDchWardStayToOds
      - from: ods.localsus.DchWardReferenceLookup
        to: staging.localsus.usp_LoadDchWardStayToOds
      - from: staging.localsus.usp_LoadDchWardStayToOds
        to: ods.localsus.WardStay
      - from: staging.localsus.UhdWardReferenceLookup
        to: staging.localsus.usp_LoadUhdWardReferenceLookupToOds
      - from: staging.localsus.usp_LoadUhdWardReferenceLookupToOds
        to: ods.localsus.UhdWardReferenceLookup
      - from: staging.localsus.UhdSameDayEmergencyCare
        to: ods.localsus.usp_LoadUhdSameDayEmergencyCareToOds
      - from: staging.localsus.UhdWardStay
        to: staging.localsus.usp_LoadUhdWardStayToOds
      - from: ods.localsus.UhdWardReferenceLookup
        to: staging.localsus.usp_LoadUhdWardStayToOds
      - from: staging.localsus.usp_LoadUhdWardStayToOds
        to: ods.localsus.WardStay
      - from: ods.localsus.WardStay
        via: mov.CxSusWardStayCommissioning
        to: ods.cx.usp_GetWardStayData
      - from: ods.cx.usp_GetWardStayData
        to: commissioning.staging.WardStay
      - from: commissioning.staging.WardStay
        to: commissioning.staging.usp_LoadWardStay
      - from: commissioning.staging.usp_LoadWardStay
        to: commissioning.dbo.WardStay

  - name: commissioning.comdatamart.WardStayMaterializedView
    edges:
      # For WardStay Materialized View
      - from: commissioning.staging.usp_LoadInpatient
        to: commissioning.Inpatient
      - from: commissioning.staging.usp_LoadInpatientWeekly
        to: commissioning.Inpatient
      - from: commissioning.staging.usp_LoadWardStay
        to: commissioning.WardStay
      - from: commissioning.staging.usp_LoadInpatientDischargePathway
        to: commissioning.InpatientDischargePathway
      - from: commissioning.staging.usp_LoadSameDayEmergencyCare
        to: commissioning.SameDayEmergencyCare
      - from: commissioning.staging.usp_LoadEmergencyCareNew
        to: commissioning.EmergencyCareNew
      # Load to Materialized View
      - from: commissioning.WardStay
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.Inpatient
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.InpatientDischargePathway
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.SameDayEmergencyCare
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.EmergencyCareNew
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.comdatamart.usp_LoadWardStayMaterializedView
        to: commissioning.comdatamart.dbo.WardStayMaterializedView

  - name: commissioning.dbo.EmergencyCareNew
    edges:
      - from: live-sqlserver.UrgentCare.dbo.ECDS
        via: mov.CxSusEcdsNew
        to: staging.cxsus.Ecds
      - from: staging.cxsus.Ecds
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.AeDepartment
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.ProviderOrganisation
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.PrimaryCareOrganisation
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.EthnicCategory
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.AeAttendanceCategory
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.AeInvestigation
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.AeTreatment
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.ref.OnsLaWardMapping
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.cxsus.usp_LoadEcdsToOdsNew
        to: ods.cx.usp_GetEmergencyCareDataNew
      - from: ods.cx.usp_GetEmergencyCareDataNew
        to: commissioning.staging.EmergencyCareNew
      - from: commissioning.staging.EmergencyCareNew
        to: commissioning.staging.usp_LoadEmergencyCareNew
      - from: commissioning.staging.usp_LoadEmergencyCareNew
        to: commissioning.dbo.EmergencyCareNew

  - name: commissioning.dbo.SameDayEmergencyCare
    edges:
      - from: blob_uhd/uec/SDEC_Activity.csv
        via: mov.LocalSusUhdWardStay
        to: staging.localsus.UhdSameDayEmergencyCare
      - from: blob.dch/uec-newton/uec-newton-discharges.csv
        via: mov.LocalSusDchWardStay
        to: staging.localsus.DchInpatientDischargePathway
    # Load to ods
      - from: staging.localsus.UhdSameDayEmergencyCare
        to: staging.localsus.usp_LoadUhdSameDayEmergencyCareToOds
      - from: staging.localsus.usp_LoadUhdSameDayEmergencyCareToOds
        to: ods.localsus.SameDayEmergencyCare
    # Load to commissioning
      - from: ods.localsus.SameDayEmergencyCare
        via: mov.CxDischargePathwayLoad
        to: ods.cx.usp_GetSameDayEmergencyCareData
      - from: ods.localsus.InpatientDischargePathway
        via: mov.CxDischargePathwayLoad
        to: ods.cx.usp_GetSameDayEmergencyCareData
      - from: ods.cx.usp_GetSameDayEmergencyCareData
        to: commissioning.staging.SameDayEmergencyCare
      - from: commissioning.staging.SameDayEmergencyCare
        to: commissioning.staging.usp_LoadSameDayEmergencyCare
      - from: commissioning.staging.usp_LoadSameDayEmergencyCare
        to: commissioning.dbo.SameDayEmergencyCare

  - name: dw.dbo.ActiveDorsetWeightAndMeasureForm
    edges:
    # Load to staging
      - from: blob_dch/active-dorset/Timestamp/WeightsAndMeasures.csv
        via: mov.ActiveDorsetWeightsMeasures
        to: staging.adwm.WeightsAndMeasures
      - from: blob.dch/active-dorset/Timestamp/WeightsAndMeasures_BriefInterventions.csv
        via: mov.ActiveDorsetWeightsMeasures
        to: staging.adwm.WeightsAndMeasuresBriefInterventions
    # Load to ods
      - from: staging.adwm.WeightsAndMeasures
        to: staging.adwm.usp_LoadWeightsAndMeasuresToOds
      - from: staging.adwm.WeightsAndMeasuresBriefInterventions
        to: staging.adwm.usp_LoadWeightsAndMeasuresBriefInterventionsToOds  
      - from: staging.adwm.usp_LoadWeightsAndMeasuresBriefInterventionsToOds
        to: ods.ad.WeightsAndMeasuresBriefInterventions
      - from: ods.ad.WeightsAndMeasuresBriefInterventions
        to: staging.adwm.usp_LoadWeightsAndMeasuresToOds
      - from: staging.adwm.usp_LoadWeightsAndMeasuresToOds
        to: ods.ad.WeightsAndMeasures
    # Load to dw
      - from: ods.ad.WeightsAndMeasures
        to: ods.dw.usp_GetWeightsAndMeasuresData
      - from: ods.dw.usp_GetWeightsAndMeasuresData
        to: dw.staging.ActiveDorsetWeightAndMeasureForm
      - from: dw.staging.ActiveDorsetWeightAndMeasureForm
        to: dw.staging.usp_LoadActiveDorsetWeightAndMeasureForm
      - from: dw.staging.usp_LoadActiveDorsetWeightAndMeasureForm
        to: dw.dbo.ActiveDorsetWeightAndMeasureForm

  - name: commissioning.comdatamart.WardStayMaterializedView
    edges:
      # For WardStay Materialized View
      - from: commissioning.staging.usp_LoadInpatient
        to: commissioning.Inpatient
      - from: commissioning.staging.usp_LoadInpatientWeekly
        to: commissioning.Inpatient
      - from: commissioning.staging.usp_LoadWardStay
        to: commissioning.WardStay
      - from: commissioning.staging.usp_LoadInpatientDischargePathway
        to: commissioning.InpatientDischargePathway
      - from: commissioning.staging.usp_LoadSameDayEmergencyCare
        to: commissioning.SameDayEmergencyCare
      - from: commissioning.staging.usp_LoadEmergencyCareNew
        to: commissioning.EmergencyCareNew
      # Load to Materialized View
      - from: commissioning.WardStay
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.Inpatient
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.InpatientDischargePathway
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.SameDayEmergencyCare
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.EmergencyCareNew
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.comdatamart.usp_LoadWardStayMaterializedView
        to: commissioning.comdatamart.dbo.WardStayMaterializedView

  - name: commissioning.dbo.EmergencyCareNew
    edges:
      - from: live-sqlserver.UrgentCare.dbo.ECDS
        via: mov.CxSusEcdsNew
        to: staging.cxsus.Ecds
      - from: staging.cxsus.Ecds
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.AeDepartment
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.ProviderOrganisation
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.PrimaryCareOrganisation
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.EthnicCategory
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.AeAttendanceCategory
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.AeInvestigation
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.AeTreatment
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.ref.OnsLaWardMapping
        to: ods.cxsus.usp_LoadEcdsToOdsNew
      - from: ods.cxsus.usp_LoadEcdsToOdsNew
        to: ods.cx.usp_GetEmergencyCareDataNew
      - from: ods.cx.usp_GetEmergencyCareDataNew
        to: commissioning.staging.EmergencyCareNew
      - from: commissioning.staging.EmergencyCareNew
        to: commissioning.staging.usp_LoadEmergencyCareNew
      - from: commissioning.staging.usp_LoadEmergencyCareNew
        to: commissioning.dbo.EmergencyCareNew

  - name: commissioning.dbo.SameDayEmergencyCare
    edges:
      - from: blob_uhd/uec/SDEC_Activity.csv
        via: mov.LocalSusUhdWardStay
        to: staging.localsus.UhdSameDayEmergencyCare
      - from: blob.dch/uec-newton/uec-newton-discharges.csv
        via: mov.LocalSusDchWardStay
        to: staging.localsus.DchInpatientDischargePathway
    # Load to ods
      - from: staging.localsus.UhdSameDayEmergencyCare
        to: staging.localsus.usp_LoadUhdSameDayEmergencyCareToOds
      - from: staging.localsus.usp_LoadUhdSameDayEmergencyCareToOds
        to: ods.localsus.SameDayEmergencyCare
    # Load to commissioning
      - from: ods.localsus.SameDayEmergencyCare
        via: mov.CxDischargePathwayLoad
        to: ods.cx.usp_GetSameDayEmergencyCareData
      - from: ods.localsus.InpatientDischargePathway
        via: mov.CxDischargePathwayLoad
        to: ods.cx.usp_GetSameDayEmergencyCareData
      - from: ods.cx.usp_GetSameDayEmergencyCareData
        to: commissioning.staging.SameDayEmergencyCare
      - from: commissioning.staging.SameDayEmergencyCare
        to: commissioning.staging.usp_LoadSameDayEmergencyCare
      - from: commissioning.staging.usp_LoadSameDayEmergencyCare
        to: commissioning.dbo.SameDayEmergencyCare

  - name: commissioning.comdatamart.WardStayMaterializedView
    edges:
      # For WardStay Materialized View
      - from: commissioning.staging.usp_LoadInpatient
        to: commissioning.Inpatient
      - from: commissioning.staging.usp_LoadInpatientWeekly
        to: commissioning.Inpatient
      - from: commissioning.staging.usp_LoadWardStay
        to: commissioning.WardStay
      - from: commissioning.staging.usp_LoadInpatientDischargePathway
        to: commissioning.InpatientDischargePathway
      - from: commissioning.staging.usp_LoadSameDayEmergencyCare
        to: commissioning.SameDayEmergencyCare
      - from: commissioning.staging.usp_LoadEmergencyCareNew
        to: commissioning.EmergencyCareNew
      # Load to Materialized View
      - from: commissioning.WardStay
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.Inpatient
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.InpatientDischargePathway
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.SameDayEmergencyCare
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.EmergencyCareNew
        via: mov.WardStayToMaterializedView
        to: commissioning.comdatamart.usp_LoadWardStayMaterializedView
      - from: commissioning.comdatamart.usp_LoadWardStayMaterializedView
        to: commissioning.comdatamart.dbo.WardStayMaterializedView

  - name: dw.dbo.FactSwasftWeeklyActivity
    edges:
      - from: Dscro.dbo.SCW_ALL00_SWASFT00_2021_V2
        via: mov.SwasftWeeklyActivity
        to: staging.swa.SwasftWeeklyActivity
      - from: staging.swa.SwasftWeeklyActivity
        to: staging.swa.usp_LoadSwasftWeeklyActivityToOds
      - from: staging.swa.usp_LoadSwasftWeeklyActivityToOds
        to: ods.swa.SwasftWeeklyActivity
      - from: ods.swa.SwasftWeeklyActivity
        via: mov.DwLoad
        to: ods.dw.usp_GetFactSwasftWeeklyActivityData
      - from: ods.swa.SwasftWeeklyActivity
        via: mov.DwLoad
        to: ods.dw.usp_GetDimCommissionerData
      - from: ods.PrimaryCareOrganisation
        via: mov.DwLoad
        to: ods.dw.usp_GetDimCommissionerData
      - from: ods.swa.SwasftWeeklyActivity
        via: mov.DwLoad
        to: ods.dw.usp_GetDimPresentingReasonData
      - from: ods.swa.SwasftWeeklyActivity
        via: mov.DwLoad
        to: ods.dw.usp_GetDimManagedIncidentData
      - from: ods.swa.SwasftWeeklyActivity
        via: mov.DwLoad
        to: ods.dw.usp_GetDimIncidentColourData
      - from: ods.swa.SwasftWeeklyActivity
        via: mov.DwLoad
        to: ods.dw.usp_GetDimOutcomeData
      - from: ods.swa.SwasftWeeklyActivity
        via: mov.DwLoad
        to: ods.dw.usp_GetDimLocationTypeData
      - from: ods.swa.SwasftWeeklyActivity
        via: mov.DwLoad
        to: ods.dw.usp_GetDimHospitalWardData
      - from: ods.swa.SwasftWeeklyActivity
        via: mov.DwLoad
        to: ods.dw.usp_GetDimLocalAuthorityData
      - from: ods.dw.usp_GetFactSwasftWeeklyActivityData
        to: dw.staging.FactSwasftWeeklyActivity
      - from: dw.staging.FactSwasftWeeklyActivity
        to: dw.staging.usp_LoadFactSwasftWeeklyActivity
      - from: dw.staging.usp_LoadFactSwasftWeeklyActivity
        to: dw.dbo.FactSwasftWeeklyActivity
      - from: ods.dw.usp_GetDimCommissionerData
        to: dw.staging.DimCommissioner
      - from: ods.dw.usp_GetDimPresentingReasonData
        to: dw.staging.DimPresentingReason
      - from: ods.dw.usp_GetDimManagedIncidentData
        to: dw.staging.DimManagedIncident
      - from: ods.dw.usp_GetDimIncidentColourData
        to: dw.staging.DimIncidentColour
      - from: ods.dw.usp_GetDimOutcomeData
        to: dw.staging.DimOutcome
      - from: ods.dw.usp_GetDimLocationTypeData
        to: dw.staging.DimLocationType
      - from: ods.dw.usp_GetDimHospitalWardData
        to: dw.staging.DimHospitalWard
      - from: ods.dw.usp_GetDimLocalAuthorityData
        to: dw.staging.DimLocalAuthority
      - from: dw.staging.DimCommissioner
        to: dw.staging.usp_LoadDimCommissioner
      - from: dw.staging.usp_LoadDimCommissioner
        to: dw.dbo.DimCommissioner
      - from: dw.staging.DimPresentingReason
        to: dw.staging.usp_LoadDimPresentingReason
      - from: dw.staging.usp_LoadDimPresentingReason
        to: dw.dbo.DimPresentingReason
      - from: dw.staging.DimManagedIncident
        to: dw.staging.usp_LoadDimManagedIncident
      - from: dw.staging.usp_LoadDimManagedIncident
        to: dw.dbo.DimManagedIncident
      - from: dw.staging.DimIncidentColour
        to: dw.staging.usp_LoadDimIncidentColour
      - from: dw.staging.usp_LoadDimIncidentColour
        to: dw.dbo.DimIncidentColour
      - from: dw.staging.DimOutcome
        to: dw.staging.usp_LoadDimOutcome
      - from: dw.staging.usp_LoadDimOutcome
        to: dw.dbo.DimOutcome
      - from: dw.staging.DimLocationType
        to: dw.staging.usp_LoadDimLocationType
      - from: dw.staging.usp_LoadDimLocationType
        to: dw.dbo.DimLocationType
      - from: dw.staging.DimHospitalWard
        to: dw.staging.usp_LoadDimHospitalWard
      - from: dw.staging.usp_LoadDimHospitalWard
        to: dw.dbo.DimHospitalWard
      - from: dw.staging.DimLocalAuthority
        to: dw.staging.usp_LoadDimLocalAuthority
      - from: dw.staging.usp_LoadDimLocalAuthority
        to: dw.dbo.DimLocalAuthority
    # Foreign key relationships
      - from: dw.dbo.DimCommissioner
        to: dw.dbo.FactSwasftWeeklyActivity
      - from: dw.dbo.DimPresentingReason
        to: dw.dbo.FactSwasftWeeklyActivity
      - from: dw.dbo.DimManagedIncident
        to: dw.dbo.FactSwasftWeeklyActivity
      - from: dw.dbo.DimIncidentColour
        to: dw.dbo.FactSwasftWeeklyActivity
      - from: dw.dbo.DimOutcome
        to: dw.dbo.FactSwasftWeeklyActivity
      - from: dw.dbo.DimLocationType
        to: dw.dbo.FactSwasftWeeklyActivity
      - from: dw.dbo.DimHospitalWard
        to: dw.dbo.FactSwasftWeeklyActivity
      - from: dw.dbo.DimLocalAuthority
        to: dw.dbo.FactSwasftWeeklyActivity

  - name: dw.dbo.FactLifeCourseSegmentation
    edges:
      - from: Default Data
        via: Dw
        to: dw.ref.LifeCourseSegmentationLookup
      - from: dw.ref.LifeCourseSegmentationLookup
        via: mov.DwLoad
        to: dw.usp_LoadDimLifeCourseSegment
      - from: dw.usp_LoadDimLifeCourseSegment
        to: dw.DimLifeCourseSegment
      - from: dw.DimPerson
        via: mov.DwLoad
        to: dw.usp_LoadFactLifeCourseSegmentation
      - from: dw.staging.usp_LoadFactSecondaryCareActivity
        to: dw.FactSecondaryCareActivity
      - from: dw.FactSecondaryCareActivity
        to: dw.usp_LoadFactLifeCourseSegmentation
      - from: dw.staging.usp_LoadDimPointOfDelivery
        to: dw.DimPointOfDelivery
      - from: dw.DimPointOfDelivery
        via: mov.DwLoad
        to: dw.usp_LoadFactLifeCourseSegmentation
      - from: dw.staging.usp_LoadBridgeLifeCourseSegmentation
        to: dw.BridgeLifeCourseSegmentation
      - from: dw.BridgeLifeCourseSegmentation
        via: mov.DwLoad
        to: dw.usp_LoadFactLifeCourseSegmentation
      - from: dw.ref.LifeCourseSegmentationLookup
        via: mov.DwLoad
        to: dw.usp_LoadDimLifeCourseSubGroup
      - from: dw.DimLifeCourseSegment
        via: mov.DwLoad
        to: dw.usp_LoadDimLifeCourseSubGroup
      - from: dw.usp_LoadDimLifeCourseSubGroup
        to: dw.DimLifeCourseSubGroup
      - from: dw.DimLifeCourseSubGroup
        to: dw.usp_LoadFactLifeCourseSegmentation
      - from: dw.DimLifeCourseSegment
        to: dw.usp_LoadFactLifeCourseSegmentation
      - from: dw.usp_LoadFactPersonConditionStatus
        to: dw.FactPersonConditionStatus
      - from: dw.FactPersonConditionStatus
        via: mov.DwLoad
        to: dw.usp_LoadFactLifeCourseSegmentation
      - from: dw.ref.LifeCourseSegmentationLookup
        via: mov.DwLoad
        to: dw.usp_LoadFactLifeCourseSegmentation
      - from: dw.staging.usp_LoadBridgeSecondaryCareActivity
        to: dw.BridgeSecondaryCareActivity
      - from: dw.BridgeSecondaryCareActivity
        via: mov.DwLoad
        to: dw.usp_LoadFactLifeCourseSegmentation
      - from: dw.DimSecondaryCareActivity
        to: dw.usp_LoadFactLifeCourseSegmentation
      - from: dw.usp_LoadFactLifeCourseSegmentation
        to: dw.dbo.FactLifeCourseSegmentation
    # Foreign key relationships
      - from: dw.dbo.DimPerson
        to: dw.dbo.FactLifeCourseSegmentation
      - from: dw.DimLifeCourseSegment
        to: dw.dbo.FactLifeCourseSegmentation

  - name: dw.dbo.BridgeLifeCourseSegmentation
    edges:
      - from: dw.DimPerson
        via: mov.DwLoad
        to: dw.usp_LoadBridgeLifeCourseSegmentation
      - from: dw.FactSecondaryCareActivity
        via: mov.DwLoad
        to: dw.usp_LoadBridgeLifeCourseSegmentation
      - from: dw.DimPointOfDelivery
        via: mov.DwLoad
        to: dw.usp_LoadBridgeLifeCourseSegmentation
      - from: dw.FactLifeCourseSegmentation
        via: mov.DwLoad
        to: dw.usp_LoadBridgeLifeCourseSegmentation
      - from: dw.DimLifeCourseSubGroup
        via: mov.DwLoad
        to: dw.usp_LoadBridgeLifeCourseSegmentation
      - from: dw.DimLifeCourseSegment
        via: mov.DwLoad
        to: dw.usp_LoadBridgeLifeCourseSegmentation
      - from: dw.FactPersonConditionStatus
        via: mov.DwLoad
        to: dw.usp_LoadBridgeLifeCourseSegmentation
      - from: dw.ref.LifeCourseSegmentationLookup
        via: mov.DwLoad
        to: dw.usp_LoadBridgeLifeCourseSegmentation
      - from: dw.BridgeSecondaryCareActivity
        via: mov.DwLoad
        to: dw.usp_LoadBridgeLifeCourseSegmentation
      - from: dw.DimSecondaryCareActivity
        via: mov.DwLoad
        to: dw.usp_LoadBridgeLifeCourseSegmentation
      - from: dw.usp_LoadBridgeLifeCourseSegmentation
        to: dw.dbo.BridgeLifeCourseSegmentation
    # Foreign key relationships
      - from: dw.DimLifeCourseSubGroup
        to: dw.dbo.BridgeLifeCourseSegmentation
      - from: dw.FactLifeCourseSegmentation
        to: dw.dbo.BridgeLifeCourseSegmentation

  - name: dw.dbo.BridgeSecondaryCareActivity
    edges:
      - from: ods.phmsus.Inpatient
        via: mov.DwLoad
        to: ods.dw.usp_GetBridgeSecondaryCareActivityData
      - from: ods.dw.usp_GetBridgeSecondaryCareActivityData
        to: dw.staging.BridgeSecondaryCareActivity
      - from: dw.staging.BridgeSecondaryCareActivity
        to: dw.staging.usp_LoadBridgeSecondaryCareActivity
      - from: dw.FactSecondaryCareActivity
        to: dw.staging.usp_LoadBridgeSecondaryCareActivity
      - from: ods.phmsus.Inpatient
        via: mov.DwLoad
        to: ods.dw.usp_GetDimSecondaryCareActivityData
      - from: ods.dw.usp_GetDimSecondaryCareActivityData
        to: dw.staging.DimSecondaryCareActivity
      - from: dw.staging.DimSecondaryCareActivity
        to: dw.staging.usp_LoadDimSecondaryCareActivity
      - from: dw.staging.usp_LoadDimSecondaryCareActivity
        to: dw.dbo.DimSecondaryCareActivity
      - from: dw.staging.usp_LoadDimSecondaryCareActivity
        to: dw.DimSecondaryCareActivity
      - from: dw.DimSecondaryCareActivity
        to: dw.staging.usp_LoadBridgeSecondaryCareActivity
      - from: dw.staging.usp_LoadBridgeSecondaryCareActivity
        to: dw.dbo.BridgeSecondaryCareActivity
    # Foreign key relationships
      - from: dw.dbo.DimSecondaryCareActivity
        to: dw.dbo.BridgeSecondaryCareActivity
      - from: dw.dbo.FactSecondaryCareActivity
        to: dw.dbo.BridgeSecondaryCareActivity

  - name: dw.ref.LookupUhdPrimaryCarePseudonym
    edges:
      - from: Blob_uhd/nhs-numbers/nhsnumbers.csv
        via: mov.UhdPrimaryCareExtract
        to: staging.ref.LookupUhdPrimaryCarePseudonym
      - from: staging.ref.LookupUhdPrimaryCarePseudonym
        to: staging.ref.usp_LoadLookupUhdPrimaryCarePseudonymToOds
      - from: staging.ref.usp_LoadLookupUhdPrimaryCarePseudonymToOds
        to: ods.ref.LookupUhdPrimaryCarePseudonym
      - from: ods.ref.LookupUhdPrimaryCarePseudonym
        to: dw.ref.usp_LoadLookupUhdPrimaryCarePseudonym
      - from: dw.ref.usp_LoadLookupUhdPrimaryCarePseudonym
        to: dw.staging.LookupUhdPrimaryCarePseudonym
      - from: dw.staging.LookupUhdPrimaryCarePseudonym
        to: dw.staging.usp_LoadLookupUhdPrimaryCarePseudonym
      - from: dw.staging.usp_LoadLookupUhdPrimaryCarePseudonym
        to: dw.ref.dbo.LookupUhdPrimaryCarePseudonym

  - name: dw.extracts.UhdPrimaryCareExtract
    edges:
      - from: dw.FactPrimaryCareAppointment
        via: mov.UhdPrimaryCareExtract
        to: dw.extracts.usp_GetUhdPrimaryCareData
      - from: dw.staging.usp_LoadFactChildrensSocialCare
        to: dw.FactChildrensSocialCare
      - from: dw.FactChildrensSocialCare
        via: mov.UhdPrimaryCareExtract
        to: dw.extracts.usp_GetUhdPrimaryCareData
      - from: dw.ref.LookupUhdPrimaryCarePseudonym
        via: mov.UhdPrimaryCareExtract
        to: dw.extracts.usp_GetUhdPrimaryCareData
      - from: dw.staging.usp_LoadFactPersonClinicalStatus
        to: dw.FactPersonClinicalStatus
      - from: dw.FactPersonClinicalStatus
        via: mov.UhdPrimaryCareExtract
        to: dw.extracts.usp_GetUhdPrimaryCareData
      - from: dw.staging.usp_LoadDimSmokingStatus
        to: dw.DimSmokingStatus
      - from: dw.DimSmokingStatus
        via: mov.UhdPrimaryCareExtract
        to: dw.extracts.usp_GetUhdPrimaryCareData
      - from: dw.staging.usp_LoadFactRiskStratification
        to: dw.FactRiskStratification
      - from: dw.FactRiskStratification
        via: mov.UhdPrimaryCareExtract
        to: dw.extracts.usp_GetUhdPrimaryCareData
      - from: dw.usp_LoadFactPersonConditionStatus
        to: dw.FactPersonConditionStatus
      - from: dw.FactPersonConditionStatus
        via: mov.UhdPrimaryCareExtract
        to: dw.extracts.usp_GetUhdPrimaryCareData
      - from: dw.staging.usp_LoadFactPersonCovidStatus
        to: dw.FactPersonCovidStatus
      - from: dw.FactPersonCovidStatus
        via: mov.UhdPrimaryCareExtract
        to: dw.extracts.usp_GetUhdPrimaryCareData
      - from: dw.staging.usp_LoadFactPersonSocialStatus
        to: dw.FactPersonSocialStatus
      - from: dw.FactPersonSocialStatus
        via: mov.UhdPrimaryCareExtract
        to: dw.extracts.usp_GetUhdPrimaryCareData
      - from: dw.extracts.usp_GetUhdPrimaryCareData
        to: dbo.blob.Uhd/extract/19000101/PrimaryCare.csv

  - name: dw.ref.LookupDchPrimaryCarePseudonym
    edges:
      - from: Blob_dch/nhs-numbers/nhsnumbers.csv
        via: mov.DchPrimaryCareExtract
        to: staging.ref.LookupDchPrimaryCarePseudonym
      - from: staging.ref.LookupDchPrimaryCarePseudonym
        to: staging.ref.usp_LoadLookupDchPrimaryCarePseudonymToOds
      - from: staging.ref.usp_LoadLookupDchPrimaryCarePseudonymToOds
        to: ods.ref.LookupDchPrimaryCarePseudonym
      - from: ods.ref.LookupDchPrimaryCarePseudonym
        to: dw.ref.usp_LoadLookupDchPrimaryCarePseudonym
      - from: dw.ref.usp_LoadLookupDchPrimaryCarePseudonym
        to: dw.staging.LookupDchPrimaryCarePseudonym
      - from: dw.staging.LookupDchPrimaryCarePseudonym
        to: dw.staging.usp_LoadLookupDchPrimaryCarePseudonym
      - from: dw.staging.usp_LoadLookupDchPrimaryCarePseudonym
        to: dw.ref.dbo.LookupDchPrimaryCarePseudonym

  - name: dw.extracts.DchPrimaryCareExtract
    edges:
      - from: dw.FactPrimaryCareAppointment
        via: mov.DchPrimaryCareExtract
        to: dw.extracts.usp_GetDchPrimaryCareData
      - from: dw.staging.usp_LoadFactChildrensSocialCare
        to: dw.FactChildrensSocialCare
      - from: dw.FactChildrensSocialCare
        via: mov.DchPrimaryCareExtract
        to: dw.extracts.usp_GetDchPrimaryCareData
      - from: dw.FactMedicationHistory
        via: mov.DchPrimaryCareExtract
        to: dw.extracts.usp_GetDchPrimaryCareData
      - from: dw.DimBnfMedication
        via: mov.DchPrimaryCareExtract
        to: dw.extracts.usp_GetDchPrimaryCareData
      - from: dw.DimGpSurgery
        via: mov.DchPrimaryCareExtract
        to: dw.extracts.usp_GetDchPrimaryCareData
      - from: dw.usp_LoadFactPersonConditionStatus
        to: dw.FactPersonConditionStatus
      - from: dw.FactPersonConditionStatus
        via: mov.DchPrimaryCareExtract
        to: dw.extracts.usp_GetDchPrimaryCareData
      - from: dw.staging.usp_LoadFactPersonClinicalStatus
        to: dw.FactPersonClinicalStatus
      - from: dw.FactPersonClinicalStatus
        via: mov.DchPrimaryCareExtract
        to: dw.extracts.usp_GetDchPrimaryCareData
      - from: dw.staging.usp_LoadFactRiskStratification
        to: dw.FactRiskStratification
      - from: dw.FactRiskStratification
        via: mov.DchPrimaryCareExtract
        to: dw.extracts.usp_GetDchPrimaryCareData
      - from: dw.staging.usp_LoadFactPersonCovidStatus
        to: dw.FactPersonCovidStatus
      - from: dw.FactPersonCovidStatus
        via: mov.DchPrimaryCareExtract
        to: dw.extracts.usp_GetDchPrimaryCareData
      - from: dw.staging.usp_LoadFactPersonSocialStatus
        to: dw.FactPersonSocialStatus
      - from: dw.FactPersonSocialStatus
        via: mov.DchPrimaryCareExtract
        to: dw.extracts.usp_GetDchPrimaryCareData
      - from: dw.extracts.usp_GetDchPrimaryCareData
        to: dbo.blob.Dch/extract/PrimaryCare.csv
